(window.webpackJsonp=window.webpackJsonp||[]).push([[358],{"../packages/components/dist/esm/screen-reader-text/index.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("../node_modules/react/index.js"),a=s.n(n);s("../packages/components/dist/esm/screen-reader-text/style.scss");function i(e){var t=e.children;return a.a.createElement("span",{className:"screen-reader-text"},t)}},"../packages/components/dist/esm/screen-reader-text/style.scss":function(e,t,s){},"./blocks/site/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),o=s.n(i),r=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(r),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),p=s("../node_modules/@babel/runtime/helpers/createSuper.js"),u=s.n(p),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),b=s("../node_modules/react/index.js"),v=s.n(b),_=s("../node_modules/prop-types/index.js"),f=s.n(_),j=s("../node_modules/react-redux/es/index.js"),k=s("../node_modules/classnames/index.js"),g=s.n(k),y=s("../node_modules/lodash-es/noop.js"),E=s("./components/gridicon/index.tsx"),x=s("../packages/i18n-calypso/dist/esm/index.js"),C=s("../node_modules/page/page.js"),I=s.n(C),w=s("./config/index.js"),S=s("./blocks/site-icon/index.jsx"),U=s("../node_modules/@babel/runtime/helpers/extends.js"),O=s.n(U),T=s("./components/animate/index.jsx"),N=s("../packages/components/dist/esm/button/index.js"),D=s("./components/external-link/index.jsx"),L=s("./state/analytics/actions/record.js"),M=s("./state/analytics/actions/compose-analytics.js"),q=s("./components/data/query-site-connection-status/index.jsx"),A=s("./state/sites/selectors/is-jetpack-site.js"),P=s("../node_modules/lodash-es/get.js"),F=s("./state/selectors/get-raw-site.js");function z(e,t){return Object(P.a)(Object(F.a)(e,t),"updates",null)}var G=s("./state/selectors/can-current-user.js"),J=s("./state/selectors/get-site-connection-status.js"),V=s("./state/selectors/is-site-automated-transfer.js"),H=(s("./my-sites/site-indicator/style.scss"),function(e){return v.a.createElement(D.a,O()({icon:!0,iconSize:12,target:"_blank"},e))}),K=function(e){d()(s,e);var t=u()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{expand:!1}),h()(c()(e),"toggleExpand",(function(){e.setState({expand:!e.state.expand});var t=e.state.expand?"Collapse":"Expand";e.props.recordGoogleEvent("Site-Indicator","Clicked to ".concat(t," the Site Indicator"))})),h()(c()(e),"handlePluginsUpdate",(function(){var t=e.props.siteUpdates;e.recordEvent("Clicked updates available link to plugins updates",t&&t.total)})),h()(c()(e),"handleThemesUpdate",(function(){var t=e.props.siteUpdates;e.recordEvent("Clicked updates available link to theme updates",t&&t.total)})),h()(c()(e),"handleCoreUpdate",(function(){e.recordEvent("Clicked updates available link to WordPress updates",1)})),h()(c()(e),"handleMultipleUpdate",(function(){var t=e.props.siteUpdates;e.recordEvent("Clicked updates available link for multiple updates",t&&t.total)})),h()(c()(e),"handleGenericUpdate",(function(){var t=e.props.siteUpdates;e.props.recordGoogleEvent("Site-Indicator","Clicked updates available link to wp-admin updates","Total Updates",t&&t.total)})),e}return o()(s,[{key:"hasUpdate",value:function(){var e=this.props.siteUpdates;return e&&!this.hasError()&&e.total>0}},{key:"hasError",value:function(){return!1===this.props.siteIsConnected}},{key:"showIndicator",value:function(){var e=this.props,t=e.siteIsAutomatedTransfer,s=e.siteIsJetpack;return e.userCanManage&&s&&!t&&(this.hasUpdate()||this.hasError())}},{key:"updatesAvailable",value:function(){var e=this.props,t=e.site,s=e.siteUpdates,n=e.translate,a="/activity-log/"+t.slug;return s.wordpress===s.total&&t.canUpdateFiles?v.a.createElement("span",null,n("A newer version of WordPress is available. {{link}}Update to %(version)s{{/link}}",{components:{link:v.a.createElement("a",{href:a,onClick:this.handleCoreUpdate})},args:{version:s.wp_update_version}})):s.plugins===s.total&&t.canUpdateFiles?v.a.createElement("span",null,v.a.createElement("a",{onClick:this.handlePluginsUpdate,href:a},n("There is a plugin update available.","There are plugin updates available.",{count:s.total}))):s.themes===s.total&&t.canUpdateFiles?v.a.createElement("span",null,v.a.createElement("a",{onClick:this.handleThemesUpdate,href:a},n("There is a theme update available.","There are theme updates available.",{count:s.total}))):s.themes+s.plugins+s.wordpress===s.total&&t.canUpdateFiles?v.a.createElement("span",null,v.a.createElement("a",{onClick:this.handleMultipleUpdate,href:a},n("There are updates available."))):v.a.createElement("span",null,v.a.createElement(H,{onClick:this.handleGenericUpdate,href:t.options.admin_url+"update-core.php"},n("There is an update available.","There are updates available.",{count:s.total})))}},{key:"recordEvent",value:function(e,t){window.scrollTo(0,0),this.setState({expand:!1}),this.props.recordGoogleEvent("Site-Indicator",e,"Total Updates",t)}},{key:"errorAccessing",value:function(){var e=this.props,t=e.site,s=e.translate;return t?v.a.createElement("span",null,s("This site cannot be accessed."),v.a.createElement(N.a,{borderless:!0,compact:!0,scary:!0,href:"/settings/disconnect-site/".concat(t.slug,"?type=down"),onClick:this.props.trackSiteDisconnect},s("Iâ€™d like to fix this now"))):v.a.createElement("span",null,s("This site cannot be accessed."))}},{key:"getText",value:function(){return this.hasUpdate()?this.updatesAvailable():this.hasError()?this.errorAccessing():null}},{key:"getIcon",value:function(){return this.hasUpdate()?"sync":this.hasError()?"notice":void 0}},{key:"renderIndicator",value:function(){var e=g()({"is-expanded":this.state.expand,"is-update":this.hasUpdate(),"is-error":this.hasError(),"is-action":!0,"site-indicator__main":!0});return v.a.createElement("div",{className:e},!this.state.expand&&v.a.createElement(T.a,{type:"appear"},v.a.createElement("button",{className:"site-indicator__button",onClick:this.toggleExpand},v.a.createElement(E.a,{icon:this.getIcon(),size:16}))),this.state.expand&&v.a.createElement("div",{className:"site-indicator__message"},v.a.createElement("div",{className:"site-indicator__action"},this.getText()),v.a.createElement("button",{className:"site-indicator__button",onClick:this.toggleExpand},v.a.createElement(T.a,{type:"appear"},v.a.createElement(E.a,{icon:"cross",size:18})))))}},{key:"render",value:function(){var e=this.props,t=e.site,s=e.siteIsJetpack;return v.a.createElement("div",{className:"site-indicator__wrapper"},s&&v.a.createElement(q.a,{siteId:t.ID}),this.showIndicator()&&this.renderIndicator())}}]),s}(b.Component);h()(K,"propTypes",{site:f.a.object,siteIsJetpack:f.a.bool,siteUpdates:f.a.object,siteIsConnected:f.a.bool,recordGoogleEvent:f.a.func,recordTracksEvent:f.a.func});var R=Object(j.c)((function(e,t){var s=t.site;return{siteIsConnected:s&&Object(J.a)(e,s.ID),siteIsJetpack:s&&Object(A.a)(e,s.ID),siteIsAutomatedTransfer:s&&Object(V.a)(e,s.ID),siteUpdates:s&&z(e,s.ID),userCanManage:s&&Object(G.b)(e,s.ID,"manage_options")}}),{recordGoogleEvent:L.c,recordTracksEvent:L.e,trackSiteDisconnect:function(){return Object(M.a)(Object(L.c)("Jetpack","Clicked in site indicator to start Jetpack Disconnect flow"),Object(L.e)("calypso_jetpack_site_indicator_disconnect_start"))}})(Object(x.c)(K)),W=s("./state/sites/selectors/get-site.js"),B=s("./state/sites/selectors/is-site-previewable.js"),Q=s("./state/sites/selectors/get-site-slug.js"),X=(s("./blocks/site/style.scss"),function(e){d()(s,e);var t=u()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"onSelect",(function(t){e.props.onSelect(t,e.props.site.ID)})),h()(c()(e),"onMouseEnter",(function(t){e.props.onMouseEnter(t,e.props.site.ID)})),h()(c()(e),"onMouseLeave",(function(t){e.props.onMouseLeave(t,e.props.site.ID)})),h()(c()(e),"onViewSiteClick",(function(t){var s=e.props,n=s.isPreviewable,a=s.siteSlug;return n?t.altKey||t.ctrlKey||t.metaKey||t.shiftKey?(e.props.recordTracksEvent("calypso_mysites_sidebar_view_site_modifier_clicked"),void e.props.recordGoogleEvent("Sidebar","Clicked View Site | Modifier Key")):(t.preventDefault(),e.props.recordTracksEvent("calypso_mysites_sidebar_view_site_clicked"),e.props.recordGoogleEvent("Sidebar","Clicked View Site | Calypso"),void I()("/view/"+a)):(e.props.recordTracksEvent("calypso_mysites_sidebar_view_site_unpreviewable_clicked"),void e.props.recordGoogleEvent("Sidebar","Clicked View Site | Unpreviewable"))})),e}return o()(s,[{key:"render",value:function(){var e=this.props,t=e.site,s=e.translate;if(!t)return null;var n=g()({site:!0,"is-jetpack":t.jetpack,"is-primary":t.primary,"is-private":t.is_private,"is-redirect":t.options&&t.options.is_redirect,"is-selected":this.props.isSelected,"is-highlighted":this.props.isHighlighted,"is-compact":this.props.compact});return v.a.createElement("div",{className:n},v.a.createElement("a",{className:"site__content",href:this.props.homeLink?t.URL:this.props.href,"data-tip-target":this.props.tipTarget,target:this.props.externalLink&&"_blank",title:this.props.homeLink?s("View %(domain)s",{args:{domain:t.domain}}):t.domain,onClick:this.props.homeLink?this.onViewSiteClick:this.onSelect,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,"aria-label":this.props.homeLink?s("View %(domain)s",{args:{domain:t.domain}}):t.domain},v.a.createElement(S.a,{site:t,size:this.props.compact?24:32}),v.a.createElement("div",{className:"site__info"},v.a.createElement("div",{className:"site__title"},t.title),v.a.createElement("div",{className:"site__domain"},this.props.homeLink?s("View %(domain)s",{args:{domain:t.domain}}):t.domain),this.props.site.is_private&&v.a.createElement("span",{className:"site__badge site__badge-private"},this.props.site.is_coming_soon?s("Coming Soon"):s("Private")),t.options&&t.options.is_redirect&&v.a.createElement("span",{className:"site__badge site__badge-redirect"},s("Redirect")),t.options&&t.options.is_domain_only&&v.a.createElement("span",{className:"site__badge site__badge-domain-only"},s("Domain"))),this.props.homeLink&&this.props.showHomeIcon&&v.a.createElement("span",{className:"site__home"},v.a.createElement(E.a,{icon:"house",size:18}))),this.props.indicator&&Object(w.c)("site-indicator")?v.a.createElement(R,{site:t}):null)}}]),s}(v.a.Component));h()(X,"defaultProps",{onSelect:y.a,onMouseEnter:y.a,onMouseLeave:y.a,href:null,indicator:!0,isSelected:!1,homeLink:!1,showHomeIcon:!0,compact:!1}),h()(X,"propTypes",{href:f.a.string,externalLink:f.a.bool,indicator:f.a.bool,onSelect:f.a.func,onMouseEnter:f.a.func,onMouseLeave:f.a.func,isSelected:f.a.bool,isHighlighted:f.a.bool,site:f.a.object,siteId:f.a.number,homeLink:f.a.bool,showHomeIcon:f.a.bool,compact:f.a.bool});t.a=Object(j.c)((function(e,t){var s=t.siteId||t.site.ID;return{siteId:s,site:s?Object(W.a)(e,s):t.site,isPreviewable:Object(B.a)(e,s),siteSlug:Object(Q.a)(e,s)}}),{recordGoogleEvent:L.c,recordTracksEvent:L.e})(Object(x.c)(X))},"./blocks/site/style.scss":function(e,t,s){},"./components/animate/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/react/index.js"),a=s.n(n),i=s("../node_modules/prop-types/index.js"),o=s.n(i),r=(s("./components/animate/style.scss"),function(e){var t=e.type,s=e.children;return a.a.createElement("div",{className:"animate__".concat(t)},s)});r.propTypes={type:o.a.oneOf(["appear","fade-in"])},t.a=r},"./components/animate/style.scss":function(e,t,s){},"./components/data/query-site-connection-status/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),o=s.n(i),r=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(r),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),p=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),u=s.n(p),m=s("../node_modules/prop-types/index.js"),h=s.n(m),b=s("../node_modules/react/index.js"),v=s("../node_modules/react-redux/es/index.js"),_=s("../node_modules/lodash-es/get.js");function f(e,t){return Object(_.a)(e.sites.connection.requesting,t,!1)}var j=s("./state/action-types.js"),k=s("./lib/wp/browser.js"),g=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return o()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.request(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.siteId!==e.siteId&&this.request(e)}},{key:"request",value:function(e){!e.requestingSiteConnectionStatus&&e.siteId&&e.requestConnectionStatus(e.siteId)}},{key:"render",value:function(){return null}}]),s}(b.Component);u()(g,"propTypes",{siteId:h.a.number,requestingSiteConnectionStatus:h.a.bool,requestConnectionStatus:h.a.func});t.a=Object(v.c)((function(e,t){return{requestingSiteConnectionStatus:f(e,t.siteId)}}),{requestConnectionStatus:function(e){return function(t){return t({type:j.Bq,siteId:e}),k.a.undocumented().testConnectionJetpack(e).then((function(s){t({type:j.Aq,siteId:e,status:s.connected}),t({type:j.Dq,siteId:e})})).catch((function(s){t({type:j.Cq,siteId:e,error:s})}))}}})(g)},"./components/external-link/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),o=s.n(i),r=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(r),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),p=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),u=s.n(p),m=s("../node_modules/react/index.js"),h=s.n(m),b=s("../node_modules/prop-types/index.js"),v=s.n(b),_=s("../node_modules/classnames/index.js"),f=s.n(_),j=s("../node_modules/lodash-es/assign.js"),k=s("../node_modules/lodash-es/omit.js"),g=s("./components/gridicon/index.tsx"),y=s("../packages/i18n-calypso/dist/esm/index.js"),E=s("../packages/components/dist/esm/screen-reader-text/index.js"),x=s("./lib/i18n-utils/browser.js"),C=(s("./components/external-link/style.scss"),function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return o()(s,[{key:"render",value:function(){var e=f()("external-link",this.props.className,{"icon-first":this.props.showIconFirst,"has-icon":this.props.icon}),t=Object(j.a)(Object(k.a)(this.props,"icon","iconSize","showIconFirst","iconClassName"),{className:e,rel:"external"});this.props.icon&&(t.target="_blank"),t.target&&(t.rel=t.rel.concat(" noopener noreferrer")),t.href&&(t.href=Object(x.m)(t.href));var s=h.a.createElement(g.a,{className:this.props.iconClassName,icon:"external",size:this.props.iconSize});return h.a.createElement("a",t,this.props.icon&&this.props.showIconFirst&&s,this.props.children,this.props.icon&&!this.props.showIconFirst&&s,this.props.icon&&h.a.createElement(E.a,null,Object(y.f)("(opens in a new tab)",{comment:"accessibility label for an external link"})))}}]),s}(m.Component));u()(C,"defaultProps",{iconSize:18,showIconFirst:!1}),u()(C,"propTypes",{className:v.a.string,href:v.a.string,onClick:v.a.func,icon:v.a.bool,iconSize:v.a.number,target:v.a.string,showIconFirst:v.a.bool,iconClassName:v.a.string}),t.a=C},"./components/external-link/style.scss":function(e,t,s){},"./my-sites/site-indicator/style.scss":function(e,t,s){},"./state/selectors/get-site-connection-status.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("../node_modules/lodash-es/get.js");function a(e,t){return Object(n.a)(e.sites.connection.items,t,null)}},"./state/selectors/get-sites.js":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=s.n(i),r=s("../node_modules/lodash-es/sortBy.js"),c=s("../node_modules/lodash-es/partition.js"),l=s("./lib/create-selector/index.js"),d=s("./state/sites/selectors/get-site.js"),p=s("./state/selectors/get-primary-site-id.js"),u=s("./state/selectors/get-sites-items.js");t.a=Object(l.a)((function(e){var t,s=Object(p.a)(e),n=Object(c.a)(Object(u.a)(e),{ID:s}),i=o()(n,2),l=i[0],m=i[1];return[].concat(a()(l),a()((t=m,Object(r.a)(t,["name","URL"])))).map((function(t){return Object(d.a)(e,t.ID)}))}),(function(e){return[Object(u.a)(e),e.currentUser.capabilities]}))}}]);