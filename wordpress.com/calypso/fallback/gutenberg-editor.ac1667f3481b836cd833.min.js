/*! For license information please see gutenberg-editor.ac1667f3481b836cd833.min.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[320,335,367,387,445],{"../packages/components/dist/esm/progress-bar/index.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return v}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s("../node_modules/classnames/index.js"),g=s.n(b),j=s("../packages/components/dist/esm/screen-reader-text/index.js"),v=(s("../packages/components/dist/esm/progress-bar/style.scss"),function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{allTimeMax:e.props.value}),e}return r()(s,[{key:"getCompletionPercentage",value:function(){var e=Math.ceil((this.props.canGoBackwards?this.props.value:this.state.allTimeMax)/this.props.total*100);return Math.min(e,100)}},{key:"renderBar",value:function(){var e=this.props,t=e.color,s=e.title,n=e.total,a=e.value,i={width:this.getCompletionPercentage()+"%"};return t&&(i.backgroundColor=t),f.createElement("div",{"aria-valuemax":n,"aria-valuemin":0,"aria-valuenow":a,className:"progress-bar__progress",role:"progressbar",style:i},s&&f.createElement(j.a,null,s))}},{key:"render",value:function(){var e=g()(this.props.className,"progress-bar",{"is-compact":this.props.compact,"is-pulsing":this.props.isPulsing});return f.createElement("div",{className:e},this.renderBar())}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{allTimeMax:Math.max(t.allTimeMax,e.value)}}}]),s}(f.PureComponent));h()(v,"defaultProps",{total:100,compact:!1,isPulsing:!1,canGoBackwards:!1})},"../packages/components/dist/esm/progress-bar/style.scss":function(e,t,s){},"../packages/components/dist/esm/root-child/index.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return v}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("../node_modules/react-dom/index.js"),j=s.n(g),v=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{containerEl:null}),e}return r()(s,[{key:"componentDidMount",value:function(){var e=document.createElement("div");document.body.appendChild(e),this.setState({containerEl:e})}},{key:"componentWillUnmount",value:function(){this.state.containerEl&&document.body.removeChild(this.state.containerEl)}},{key:"render",value:function(){return this.state.containerEl?j.a.createPortal(this.props.children,this.state.containerEl):null}}]),s}(b.a.Component)},"../packages/popup-monitor/dist/esm/index.js":function(e,t,s){"use strict";var n,a=s("../node_modules/lodash-es/assign.js"),i=s("../node_modules/events/events.js");function r(){var e=this;this.intervals={},this.monitorInterval=null,this.windowInstance=null,this.onMessage=function(t){t.source===e.windowInstance&&e.emit("message",t.data)}}n=r.prototype,Object(a.a)(n,i.EventEmitter.prototype),n.emitChange=function(){this.emit("change")},n.off=n.removeListener,r.prototype.open=function(e,t,s){return t=t||Date.now(),this.windowInstance=window.open(e,t,s),this.startMonitoring(t,this.windowInstance),window.addEventListener("message",this.onMessage,!1),this},r.prototype.getScreenCenterSpecs=function(e,t){var s=void 0!==window.screenTop?window.screenTop:window.screenY,n=void 0!==window.screenLeft?window.screenLeft:window.screenX;return["width="+e,"height="+t,"top="+(s+window.innerHeight/2-t/2),"left="+(n+window.innerWidth/2-e/2)].join()},r.prototype.isOpen=function(e){var t=!1;try{t=this.intervals[e]&&this.intervals[e].closed}catch(e){}return!t},r.prototype.checkStatus=function(){for(var e in this.intervals)this.intervals.hasOwnProperty(e)&&!this.isOpen(e)&&(this.emit("close",e),delete this.intervals[e]);0===Object.keys(this.intervals).length&&(clearInterval(this.monitorInterval),delete this.monitorInterval,window.removeEventListener("message",this.onMessage))},r.prototype.startMonitoring=function(e,t){this.monitorInterval||(this.monitorInterval=setInterval(this.checkStatus.bind(this),100)),this.intervals[e]=t};t.a=r},"../packages/request-external-access/dist/esm/index.js":function(e,t,s){"use strict";var n=s("../packages/popup-monitor/dist/esm/index.js");t.a=function(e,t){var s,a=new n.a;a.open(e,null,"toolbar=0,location=0,status=0,menubar=0,"+a.getScreenCenterSpecs(780,700)),a.once("close",(function(){var e={};s&&s.keyring_id&&(e.keyring_id=Number(s.keyring_id),e.id_token=s.id_token,e.user=s.user),t(e)})),a.on("message",(function(e){return s=e}))}},"./assets/images/illustrations/media.svg":function(e,t,s){"use strict";t.a="/calypso/images/media-a09cfd1c10ed7f43957e275822535aad.svg"},"./blocks/plan-storage/bar.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/prop-types/index.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("../packages/i18n-calypso/dist/esm/index.js"),j=s("../node_modules/classnames/index.js"),v=s.n(j),y=s("./node_modules/filesize/lib/filesize.min.js"),_=s.n(y),I=s("../packages/components/dist/esm/progress-bar/index.js"),O=s("./lib/plans/index.js"),x=s("./lib/plans/constants.js"),k=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.className,s=e.displayUpgradeLink,n=e.mediaStorage,a=e.sitePlanSlug,i=e.translate;if(Object(O.A)(a,x.Lc))return null;if(!n||-1===n.max_storage_bytes)return null;var r=Math.min(Math.round(n.storage_used_bytes/n.max_storage_bytes*1e3)/10,100),o=v()(t,"plan-storage__bar",{"is-alert":r>80,"is-warn":r>60&&r<=80}),c=_()(n.max_storage_bytes);return b.a.createElement("div",{className:o},b.a.createElement(I.a,{value:r,total:100,compact:!0}),b.a.createElement("span",{className:"plan-storage__storage-label"},i("%(percent)f%% of %(max)s used",{args:{percent:r,max:c}})),s&&b.a.createElement("span",{className:"plan-storage__storage-link"},i("Upgrade")),this.props.children)}}]),s}(f.Component);p()(k,"propTypes",{className:h.a.string,mediaStorage:h.a.object,displayUpgradeLink:h.a.bool,sitePlanSlug:h.a.string.isRequired}),t.a=Object(g.c)(k)},"./blocks/plan-storage/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/classnames/index.js"),h=s.n(m),f=s("../node_modules/prop-types/index.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/react-redux/es/index.js"),y=s("./components/data/query-media-storage/index.jsx"),_=s("./state/sites/media-storage/selectors.js"),I=s("./state/sites/selectors/is-jetpack-site.js"),O=s("./state/sites/selectors/get-site-plan-slug.js"),x=s("./state/sites/selectors/get-site-slug.js"),k=s("./state/selectors/is-site-automated-transfer.js"),E=s("./state/selectors/can-current-user.js"),w=s("./lib/plans/index.js"),S=s("./lib/plans/constants.js"),C=s("./blocks/plan-storage/bar.jsx"),P=(s("./blocks/plan-storage/style.scss"),function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.canUserUpgrade,s=e.canViewBar,n=e.className,a=e.jetpackSite,i=e.atomicSite,r=e.siteId,o=e.sitePlanSlug,c=e.siteSlug;if(a&&!i||!s||!o)return null;if(Object(w.A)(o,S.Lc))return null;var l=Object(w.p)(o)||Object(w.q)(o),d=t&&!l,u=j.a.createElement(j.a.Fragment,null,j.a.createElement(y.a,{siteId:r}),j.a.createElement(C.a,{sitePlanSlug:o,mediaStorage:this.props.mediaStorage,displayUpgradeLink:d},this.props.children));return d?j.a.createElement("a",{className:h()(n,"plan-storage"),href:"/plans/".concat(c)},u):j.a.createElement("div",{className:h()(n,"plan-storage")},u)}}]),s}(g.Component));p()(P,"propTypes",{className:b.a.string,mediaStorage:b.a.object,siteId:b.a.number,sitePlanSlug:b.a.string,siteSlug:b.a.string}),t.a=Object(v.c)((function(e,t){var s=t.siteId;return{mediaStorage:Object(_.a)(e,s),jetpackSite:Object(I.a)(e,s),atomicSite:Object(k.a)(e,s),sitePlanSlug:Object(O.a)(e,s),siteSlug:Object(x.a)(e,s),canUserUpgrade:Object(E.b)(e,s,"manage_options"),canViewBar:Object(E.b)(e,s,"publish_posts")}}))(P)},"./blocks/plan-storage/style.scss":function(e,t,s){},"./blocks/shortcode/index.js":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/react-redux/es/index.js"),r=s("../node_modules/classnames/index.js"),o=s.n(r),c=s("../node_modules/prop-types/index.js"),l=s.n(c),d=s("../node_modules/react/index.js"),u=s.n(d),p=s("../node_modules/lodash-es/omit.js"),m=s("../node_modules/lodash-es/identity.js"),h=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),f=s.n(h),b=s("../node_modules/@babel/runtime/helpers/createClass.js"),g=s.n(b),j=s("../node_modules/@babel/runtime/helpers/inherits.js"),v=s.n(j),y=s("../node_modules/@babel/runtime/helpers/createSuper.js"),_=s.n(y),I=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),O=s.n(I),x=s("../node_modules/lodash-es/get.js"),k=s("./state/redux-store.ts"),E=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),w=s.n(E),S=s("../node_modules/lodash-es/merge.js"),C=s("../node_modules/lodash-es/pickBy.js"),P=s("../node_modules/lodash-es/intersection.js"),T=s("./state/utils/without-persistence.js"),M=s("./state/utils/schema-utils.js"),D=s("./state/utils/reducer-utils.js"),N=s("./state/utils/with-storage-key.js"),R=s("./state/action-types.js"),L=s("./lib/redux-bridge/index.js"),A=s("./lib/shortcode/index.js");Object(L.d)("RECEIVE_MEDIA_ITEMS"),Object(L.d)("RECEIVE_MEDIA_ITEM");var U=function(e){return function(t,s){var n=s.siteId,a=s.shortcode;return Object(S.a)({},t,O()({},n,O()({},a,e)))}},V=Object(T.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R.zp:return U(!0)(e,t);case R.Ap:case R.Bp:return U(!1)(e,t)}return e}));function q(e,t){var s=t.siteId,n=t.data;if(!e.hasOwnProperty(s))return e;if(!n)return e;var a=(Array.isArray(n.media)?n.media:[n]).map((function(e){return String(e.ID)}));return w()(w()({},e),{},O()({},s,Object(C.a)(e[s],(function(e){var t=Object(A.b)(e.shortcode);if("gallery"!==t.tag||!t.attrs||!t.attrs.named||!t.attrs.named.ids)return!0;var s=t.attrs.named.ids.split(",");return!Object(P.a)(s,a).length}))))}var F=Object(M.a)({type:"object",patternProperties:{"^\\d+$":{type:"object",patternProperties:{"^.+$":{type:"object",properties:{result:{type:"string"},shortcode:{type:"string"},scripts:{type:"object"},styles:{type:"object"}}}}}}},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FLUX_RECEIVE_MEDIA_ITEM":case"FLUX_RECEIVE_MEDIA_ITEMS":return q(e,t);case R.yp:var s=t.siteId,n=t.shortcode,a=t.data;return Object(S.a)({},e,O()({},s,O()({},n,a)))}return e})),z=Object(D.a)({requesting:V,items:F}),B=Object(N.a)("shortcodes",z);Object(k.a)(["shortcodes"],B);var W=function(e,t,s){return Object(x.a)(e.shortcodes.requesting,[t,s],!1)},G=function(e,t,s){return Object(x.a)(e.shortcodes.items,[t,s])},H=s("./lib/wp/browser.js");var Y=function(e){v()(s,e);var t=_()(s);function s(){return f()(this,s),t.apply(this,arguments)}return g()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.request(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.siteId===e.siteId&&this.props.shortcode===e.shortcode||this.request(e)}},{key:"request",value:function(e){e.requestingShortcode||e.fetchShortcode(e.siteId,e.shortcode)}},{key:"render",value:function(){return null}}]),s}(d.Component);O()(Y,"propTypes",{siteId:l.a.number.isRequired,shortcode:l.a.string.isRequired,requestingShortcode:l.a.bool,fetchShortcode:l.a.func});var K=Object(i.c)((function(e,t){var s=t.siteId,n=t.shortcode;return{requestingShortcode:W(e,s,n)}}),{fetchShortcode:function(e,t){return function(s){return s({type:R.zp,siteId:e,shortcode:t}),H.a.undocumented().site(e).shortcodes({shortcode:t}).then((function(n){s({type:R.Bp,siteId:e,shortcode:t}),s({type:R.yp,siteId:e,shortcode:t,data:n})})).catch((function(n){s({type:R.Ap,siteId:e,shortcode:t,error:n})}))}}})(Y),Q=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),X=s.n(Q),$=s("../node_modules/lodash-es/isEqual.js"),J=s("./lib/embed-frame-markup/index.jsx"),Z=s("./components/resizable-iframe/index.jsx"),ee=function(e){v()(s,e);var t=_()(s);function s(){var e;f()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),O()(X()(e),"state",{html:""}),O()(X()(e),"updateHtmlState",(function(t){e.setState({html:Object(J.a)(t)})})),O()(X()(e),"onFrameLoad",(function(t){t.target.contentWindow.postMessage(JSON.stringify({content:e.state.html}),"*"),e.props.onLoad(t)})),e}return g()(s,[{key:"componentDidMount",value:function(){this.updateHtmlState(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){Object($.a)(this.props,e)||this.updateHtmlState(e)}},{key:"shouldComponentUpdate",value:function(e,t){return t.html!==this.state.html}},{key:"render",value:function(){var e=o()("shortcode-frame",this.props.className);if(!this.state.html)return null;var t=Math.random(),s=o()({"allow-scripts":!0,"allow-same-origin":this.props.allowSameOrigin});return u.a.createElement(Z.a,a()({key:t},Object(p.a)(this.props,"body","scripts","styles","allowSameOrigin"),{src:"https://wpcomwidgets.com/render/",onLoad:this.onFrameLoad,frameBorder:"0",sandbox:s,className:e}))}}]),s}(u.a.Component);O()(ee,"displayName","ShortcodeFrame"),O()(ee,"propTypes",{body:l.a.string,scripts:l.a.object,style:l.a.object,onLoad:l.a.func,className:l.a.string,allowSameOrigin:l.a.bool}),O()(ee,"defaultProps",{onLoad:function(){},allowSameOrigin:!1});var te=function(e){var t=e.siteId,s=e.className,n=e.children,i=e.filterRenderResult,r=e.shortcode,c=o()("shortcode",s),l={};return r&&(r.body=r.result,l=i(Object(p.a)(r,"shortcode"))),u.a.createElement(d.Fragment,null,u.a.createElement(K,{siteId:t,shortcode:n}),u.a.createElement(ee,a()({},Object(p.a)(e,"siteId","filterRenderResult","shortcode","dispatch"),l,{className:c})))};te.propTypes={siteId:l.a.number.isRequired,children:l.a.string.isRequired,filterRenderResult:l.a.func.isRequired,className:l.a.string,shortcode:l.a.object,allowSameOrigin:l.a.bool},te.defaultProps={filterRenderResult:m.a,allowSameOrigin:!1};t.a=Object(i.c)((function(e,t){var s=t.siteId,n=t.children;return{shortcode:G(e,s,n)}}),null)(te)},"./blocks/upsell-nudge/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/react/index.js"),a=s.n(n),i=s("../node_modules/classnames/index.js"),r=s.n(i),o=s("../node_modules/react-redux/es/index.js"),c=s("./config/index.js"),l=s("./lib/plans/index.js"),d=s("./components/banner/index.jsx"),u=s("./lib/plans/constants.js"),p=s("./lib/url/add-query-args.ts"),m=s("./state/sites/plans/selectors/has-feature.js"),h=s("./lib/products-values/is-free-plan.js"),f=s("./state/selectors/can-current-user.js"),b=s("./state/selectors/is-vip-site.js"),g=s("./state/ui/selectors/get-selected-site-id.js"),j=s("./state/ui/selectors/get-selected-site-slug.js"),v=s("./state/sites/selectors/get-site.js"),y=s("./state/sites/selectors/is-jetpack-site.js"),_=s("./state/selectors/is-site-wpforteams.js"),I=(s("./blocks/upsell-nudge/style.scss"),function(e){var t=e.callToAction,s=e.canManageSite,n=e.canUserUpgrade,i=e.className,o=e.compact,m=e.customerType,f=e.description,b=e.disableHref,g=e.dismissPreferenceName,j=e.event,v=e.feature,y=e.forceDisplay,_=e.forceHref,I=e.horizontal,O=e.href,x=e.isJetpackDevDocs,k=e.jetpack,E=e.isVip,w=e.siteIsWPForTeams,S=e.list,C=e.onClick,P=e.onDismissClick,T=e.plan,M=e.planHasFeature,D=e.price,N=e.primaryButton,R=e.showIcon,L=void 0!==R&&R,A=e.site,U=e.siteSlug,V=e.target,q=e.title,F=e.tracksClickName,z=e.tracksClickProperties,B=e.tracksDismissName,W=e.tracksDismissProperties,G=e.tracksImpressionName,H=e.tracksImpressionProperties;if((E||!s||!A||"object"!=typeof A||"boolean"!=typeof A.jetpack||v&&M||!v&&!Object(h.a)(A.plan)||v===u.Lb&&A.options.wordads||!k&&A.jetpack||k&&!A.jetpack)&&!y)return null;if(c.a.isEnabled("signup/wpforteams")&&w)return null;!O&&U&&n&&(O=Object(p.a)({feature:v,plan:T},"/plans/".concat(U)),m&&(O="/plans/".concat(U,"?customerType=").concat(m)));var Y=r()("upsell-nudge",i,{"is-upgrade-blogger":T&&Object(l.o)(T)},{"is-upgrade-personal":T&&Object(l.t)(T)},{"is-upgrade-premium":T&&Object(l.u)(T)},{"is-upgrade-business":T&&Object(l.p)(T)},{"is-upgrade-ecommerce":T&&Object(l.q)(T)},{"is-jetpack-plan":T&&Object(l.D)(T,{group:u.ad})},{"is-wpcom-plan":T&&Object(l.D)(T,{group:u.bd})});return a.a.createElement(d.a,{callToAction:t,className:Y,compact:o,description:f,disableHref:b,dismissPreferenceName:g,event:j,feature:v,forceHref:_,horizontal:I,href:O,icon:"star",jetpack:k||x,list:S,onClick:C,onDismissClick:P,plan:T,price:D,primaryButton:N,showIcon:L,target:V,title:q,tracksClickName:F,tracksClickProperties:z,tracksDismissName:B,tracksDismissProperties:W,tracksImpressionName:G,tracksImpressionProperties:H})});I.defaultProps={primaryButton:!0},t.a=Object(o.c)((function(e,t){var s=Object(g.a)(e);return{site:Object(v.a)(e,s),planHasFeature:Object(m.a)(e,s,t.feature),canManageSite:Object(f.b)(e,s,"manage_options"),jetpack:Object(y.a)(e,s),isVip:Object(b.a)(e,s),siteSlug:t.disableHref?null:Object(j.a)(e),canUserUpgrade:Object(f.b)(e,Object(g.a)(e),"manage_options"),siteIsWPForTeams:Object(_.a)(e,Object(g.a)(e))}}))(I)},"./blocks/upsell-nudge/style.scss":function(e,t,s){},"./blocks/video-editor/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/prop-types/index.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/react-redux/es/index.js"),y=s("../node_modules/lodash-es/get.js"),_=s("../node_modules/lodash-es/noop.js"),I=s("../packages/i18n-calypso/dist/esm/index.js"),O=s("../node_modules/classnames/index.js"),x=s.n(O),k=s("../packages/components/dist/esm/progress-bar/index.js"),E=s("./components/notice/index.jsx"),w=s("./post-editor/media-modal/detail/detail-preview-video.jsx"),S=s("../packages/components/dist/esm/button/index.js"),C=s("./components/file-picker/index.jsx"),P=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"uploadImage",(function(t){var s=t[0];s&&e.props.onUploadImage(s)})),e}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.children,s=e.isPosterUpdating,n=e.onClick;return j.a.createElement("form",{className:"video-editor__upload-form"},j.a.createElement(C.a,{accept:"image/*",onPick:this.uploadImage},j.a.createElement(S.a,{className:"video-editor__controls-button",disabled:s,onClick:n},t)))}}]),s}(g.Component);h()(P,"propTypes",{isPosterUpdating:b.a.bool,onClick:b.a.func,onUploadImage:b.a.func}),h()(P,"defaultProps",{isPosterUpdating:!1,onClick:_.a,onUploadImage:_.a});var T=P,M=function(e){var t=e.isPosterUpdating,s=e.isVideoLoading,n=e.onCancel,a=e.onSelectFrame,i=e.onUploadImage,r=e.onUploadImageClick,o=e.translate;return j.a.createElement("div",{className:"video-editor__controls"},n&&j.a.createElement(S.a,{className:"video-editor__controls-button",disabled:t,onClick:n},o("Cancel")),j.a.createElement(T,{isPosterUpdating:t,onClick:r,onUploadImage:i},o("Upload Image")),j.a.createElement(S.a,{className:"video-editor__controls-button",disabled:s||t,onClick:a,primary:!0},o("Select Frame")))};M.propTypes={isPosterUpdating:b.a.bool,isVideoLoading:b.a.bool,onCancel:b.a.func,onSelectFrame:b.a.func,onUploadImage:b.a.func,onUploadImageClick:b.a.func},M.defaultProps={isPosterUpdating:!1,isVideoLoading:!0,onSelectFrame:_.a,onUploadImage:_.a,onUploadImageClick:_.a};var D=Object(I.c)(M),N=s("./state/action-types.js"),R=s("./state/data-layer/wpcom-http/actions.js"),L=s("./state/data-layer/wpcom-http/utils.js"),A=s("./state/data-layer/handler-registry.js"),U=s("./state/ui/selectors/get-selected-site-id.js"),V=s("./state/selectors/get-media-item.js"),q=s("./state/media/utils/flux-adapter.js"),F=s("../node_modules/lodash-es/assign.js"),z=Object(L.a)({fetch:function(e){if("file"in e.params||"atTime"in e.params){var t=e.params,s=t.atTime,n=t.file,a=Object.assign({apiVersion:"1.1",method:"POST",path:"/videos/".concat(e.videoId,"/poster")},n&&{formData:[["poster",n]]},void 0!==s&&{body:{at_time:s}});return Object(R.a)(a,e)}},onSuccess:function(e,t){var s=t.poster;return function(t,n){t(B(s));var a=n(),i=Object(U.a)(a),r=Object(V.a)(a,i,e.meta.mediaId),o=(s||"").split("?")[0],c=Object(F.a)({},r,{thumbnails:{fmt_hd:o,fmt_dvd:o,fmt_std:o}});Object(q.l)(i,c)}},onError:function(){return W()},onProgress:function(e,t){var s="loaded"in t&&"total"in t?Math.min(Math.round(t.loaded/(Number.EPSILON+t.total)*100),100):0;return G(s)}});Object(A.b)("state/data-layer/wpcom/videos/poster/index.js",h()({},N.Ct,[z]));s("./state/editor/init.js");var B=function(e){return{type:N.zt,posterUrl:e}},W=function(){return{type:N.At}},G=function(e){return{type:N.Bt,percentage:e}};s("./state/posts/init.js");function H(e){return e.editor.videoEditor.uploadProgress}function Y(e){return e.editor.videoEditor.url}function K(e){return e.editor.videoEditor.showError}s("./blocks/video-editor/style.scss");var Q=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{error:!1,isLoading:!0,isSelectingFrame:!1,pauseVideo:!1}),h()(c()(e),"selectFrame",(function(){e.state.isLoading?e.setState({error:!0}):e.setState({error:!1,isSelectingFrame:!0,pauseVideo:!0})})),h()(c()(e),"updatePoster",(function(t){if(e.state.isSelectingFrame){var s=e.props.media,n=Object(y.a)(s,"videopress_guid",null);n&&e.props.updatePoster(n,{atTime:t},{mediaId:s.ID})}})),h()(c()(e),"setError",(function(){e.setState({error:!0})})),h()(c()(e),"setIsLoading",(function(){e.setState({isLoading:!1})})),h()(c()(e),"pauseVideo",(function(){e.setState({error:!1,isSelectingFrame:!1,pauseVideo:!0})})),h()(c()(e),"uploadImage",(function(t){if(t){var s=e.props.media,n=Object(y.a)(s,"videopress_guid",null);n&&e.props.updatePoster(n,{file:t},{mediaId:s.ID})}})),e}return r()(s,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){!e.shouldShowError||this.props.shouldShowError?this.props.posterUrl!==e.posterUrl&&this.props.onUpdatePoster(this.getVideoEditorProps(e.posterUrl)):this.setState({error:!0,pauseVideo:!1})}},{key:"getVideoEditorProps",value:function(e){var t=this.props.media,s={posterUrl:e};return t&&t.ID&&(s.ID=t.ID),s}},{key:"renderError",value:function(){var e=this.props,t=e.onCancel,s=e.translate;return j.a.createElement(E.a,{className:"video-editor__notice",status:"is-error",showDismiss:!0,text:s("We are unable to edit this video."),isCompact:!1,onDismissClick:t})}},{key:"render",value:function(){var e=this.props,t=e.className,s=e.media,n=e.onCancel,a=e.uploadProgress,i=e.translate,r=this.state,o=r.error,c=r.isLoading,l=r.isSelectingFrame,d=r.pauseVideo,u=x()("video-editor",t);return j.a.createElement("div",{className:u},j.a.createElement("figure",null,j.a.createElement("div",{className:"video-editor__content"},j.a.createElement("div",{className:"video-editor__preview-wrapper"},j.a.createElement(w.a,{className:"video-editor__preview",isPlaying:!d,item:s,onPause:this.updatePoster,onScriptLoadError:this.setError,onVideoLoaded:this.setIsLoading})),a&&!o&&!l&&j.a.createElement(k.a,{className:"video-editor__progress-bar",isPulsing:!0,total:100,value:a}),j.a.createElement("span",{className:"video-editor__text"},i("Select a frame to use as the thumbnail image or upload your own.")),j.a.createElement(D,{isPosterUpdating:a&&!o,isVideoLoading:c,onCancel:n,onSelectFrame:this.selectFrame,onUploadImage:this.uploadImage,onUploadImageClick:this.pauseVideo}))),o&&this.renderError())}}]),s}(g.Component);h()(Q,"propTypes",{className:b.a.string,media:b.a.object.isRequired,onCancel:b.a.func,onUpdatePoster:b.a.func,posterUrl:b.a.string,shouldShowError:b.a.bool,uploadProgress:b.a.number}),h()(Q,"defaultProps",{onCancel:_.a,onUpdatePoster:_.a});t.a=Object(v.c)((function(e){return{posterUrl:Y(e),shouldShowError:K(e),uploadProgress:H(e)}}),{updatePoster:function(e,t,s){return{type:N.Ct,videoId:e,params:t,meta:s}}})(Object(I.c)(Q))},"./blocks/video-editor/style.scss":function(e,t,s){},"./components/badge/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return v}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/react/index.js"),h=s.n(m),f=s("../node_modules/prop-types/index.js"),b=s.n(f),g=s("../node_modules/classnames/index.js"),j=s.n(g),v=(s("./components/badge/style.scss"),function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.className,s=e.type;return h.a.createElement("div",{className:j()("badge badge--".concat(s),t)},this.props.children)}}]),s}(h.a.Component));p()(v,"propTypes",{type:b.a.oneOf(["warning","success","info","info-blue","error"]).isRequired}),p()(v,"defaultProps",{type:"warning"})},"./components/badge/style.scss":function(e,t,s){},"./components/button-group/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/react/index.js"),h=s.n(m),f=s("../node_modules/classnames/index.js"),b=s.n(f),g=(s("./components/button-group/style.scss"),function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e=b()("button-group",this.props.className,{"is-busy":this.props.busy,"is-primary":this.props.primary});return h.a.createElement("span",{className:e},this.props.children)}}]),s}(m.PureComponent));p()(g,"propTypes",{children:function(e){var t=null;return h.a.Children.forEach(e.children,(function(e){!e||e.props&&"button"===e.props.type||(t=new Error("All children elements should be a Button."))})),t}}),t.a=g},"./components/button-group/style.scss":function(e,t,s){},"./components/clipboard-button-input/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),c=s.n(o),l=s("../node_modules/react/index.js"),d=s.n(l),u=s("../node_modules/prop-types/index.js"),p=s.n(u),m=s("../node_modules/classnames/index.js"),h=s.n(m),f=s("../packages/i18n-calypso/dist/esm/index.js"),b=s("../node_modules/react-redux/es/index.js"),g=s("./lib/url/http-utils.ts"),j=s("./components/forms/clipboard-button/index.jsx"),v=s("./components/forms/form-text-input/index.jsx"),y=s("./state/analytics/actions/record.js");s("./components/clipboard-button-input/style.scss");function _(e){var t=e.value,s=void 0===t?"":t,n=e.className,i=e.disabled,o=e.hideHttp,l=e.dispatch,u=c()(e,["value","className","disabled","hideHttp","dispatch"]),p=Object(f.h)(),m=d.a.useState(!1),b=r()(m,2),_=b[0],I=b[1];d.a.useEffect((function(){if(_){var e=setTimeout((function(){return I(!1)}),4e3);return function(){return clearTimeout(e)}}}),[_]);return d.a.createElement("span",{className:h()("clipboard-button-input",n)},d.a.createElement(v.a,a()({},u,{disabled:i,value:o?Object(g.c)(s):s,type:"text",selectOnFocus:!0,readOnly:!0})),d.a.createElement(j.a,{text:s,onCopy:function(){I(!0),l(Object(y.e)("calypso_editor_clipboard_url_button_click"))},disabled:i,compact:!0},_?p("Copied!"):p("Copy",{context:"verb"})))}_.propTypes={value:p.a.string,disabled:p.a.bool,className:p.a.string,hideHttp:p.a.bool},t.a=Object(b.c)()(_)},"./components/clipboard-button-input/style.scss":function(e,t,s){},"./components/data/query-jetpack-modules/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/prop-types/index.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s("../node_modules/react-redux/es/index.js"),g=s("./state/selectors/is-fetching-jetpack-modules.js"),j=s("./state/jetpack/modules/actions.js"),v=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.request(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.siteId!==e.siteId&&this.request(e)}},{key:"request",value:function(e){e.requestingModules||e.fetchModuleList(e.siteId)}},{key:"render",value:function(){return null}}]),s}(f.Component);p()(v,"propTypes",{siteId:h.a.number.isRequired,requestingModules:h.a.bool,fetchModuleList:h.a.func}),t.a=Object(b.c)((function(e,t){return{requestingModules:Object(g.a)(e,t.siteId)}}),{fetchModuleList:j.c})(v)},"./components/data/query-keyring-services/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/prop-types/index.js"),p=s.n(u),m=s("../node_modules/react/index.js"),h=s("../node_modules/react-redux/es/index.js"),f=s("./state/sharing/services/selectors.js"),b=s("./state/sharing/services/actions.js"),g=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.props.isRequesting||this.props.requestKeyringServices()}},{key:"render",value:function(){return null}}]),s}(m.Component);g.propTypes={isRequesting:p.a.bool,requestKeyringServices:p.a.func},t.a=Object(h.c)((function(e){return{isRequesting:Object(f.c)(e)}}),{requestKeyringServices:b.a})(g)},"./components/data/query-media-storage/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/prop-types/index.js"),p=s.n(u),m=s("../node_modules/react/index.js"),h=s("../node_modules/react-redux/es/index.js"),f=s("./state/sites/media-storage/selectors.js"),b=s("./state/sites/media-storage/actions.js"),g=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"componentDidMount",value:function(){this.props.requestMediaStorage(this.props.siteId)}},{key:"componentDidUpdate",value:function(e){!this.props.requestingMediaStorage&&this.props.siteId&&this.props.siteId!==e.siteId&&this.props.requestMediaStorage(this.props.siteId)}},{key:"render",value:function(){return null}}]),s}(m.Component);g.propTypes={siteId:p.a.number,requestingMediaStorage:p.a.bool,requestMediaStorage:p.a.func},g.defaultProps={requestMediaStorage:function(){}};t.a=Object(h.c)((function(e,t){return{requestingMediaStorage:Object(f.b)(e,t.siteId)}}),{requestMediaStorage:b.b})(g)},"./components/data/query-post-types/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/prop-types/index.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s("../node_modules/react-redux/es/index.js"),g=s("../node_modules/lodash-es/isEqual.js"),j=s("../node_modules/lodash-es/pick.js"),v=s("./state/sites/selectors/get-site-option.js"),y=s("./state/site-settings/selectors.js"),_=s("./state/post-types/actions.js"),I=["jetpack_portfolio","jetpack_testimonial"],O=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.request(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,s=t.siteSettings,n=t.siteId,a=t.themeSlug,i=e.siteSettings,r=e.siteId,o=e.themeSlug,c=a&&o&&a!==o,l=!Object(g.a)(Object(j.a)(s,I),Object(j.a)(i,I));(n!==r||c||l)&&this.request(e)}},{key:"request",value:function(e){e.requestPostTypes(e.siteId)}},{key:"render",value:function(){return null}}]),s}(f.Component);p()(O,"propTypes",{siteId:h.a.number.isRequired,requestingPostTypes:h.a.bool,themeSlug:h.a.string,postTypeSettings:h.a.object,requestPostTypes:h.a.func}),t.a=Object(b.c)((function(e,t){var s=t.siteId;return{siteSettings:Object(y.a)(e,s),themeSlug:Object(v.a)(e,s,"theme_slug")}}),{requestPostTypes:_.b})(O)},"./components/data/query-publicize-connections/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/prop-types/index.js"),p=s.n(u),m=s("../node_modules/react/index.js"),h=s("../node_modules/react-redux/es/index.js"),f=s("./state/sharing/publicize/selectors.js"),b=s("./state/sharing/publicize/actions.js"),g=s("./state/ui/selectors/get-selected-site-id.js"),j=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"componentDidMount",value:function(){!this.props.requestingConnections&&this.props.siteId&&this.props.requestConnections(this.props.siteId)}},{key:"componentDidUpdate",value:function(e){var t=e.siteId;this.props.siteId&&t!==this.props.siteId&&!this.props.requestingConnections&&this.props.requestConnections(this.props.siteId)}},{key:"render",value:function(){return null}}]),s}(m.Component);j.propTypes={requestConnections:p.a.func,requestingConnections:p.a.bool,selectedSite:p.a.bool,siteId:p.a.number},j.defaultProps={requestConnections:function(){},requestingConnections:!1,selectedSite:!1,siteId:0},t.a=Object(h.c)((function(e,t){var s=t.siteId,n=t.selectedSite;return s=s||n&&Object(g.a)(e),{requestingConnections:Object(f.f)(e,s),siteId:s}}),{requestConnections:b.f})(j)},"./components/ellipsis-menu/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/prop-types/index.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/classnames/index.js"),y=s.n(v),_=s("../packages/i18n-calypso/dist/esm/index.js"),I=s("../node_modules/lodash-es/noop.js"),O=s("./components/gridicon/index.tsx"),x=s("../packages/components/dist/esm/button/index.js"),k=s("./components/popover/menu.jsx"),E=(s("./components/ellipsis-menu/style.scss"),function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{isMenuVisible:!1}),h()(c()(e),"popoverContext",j.a.createRef()),h()(c()(e),"handleClick",(function(t){var s=e.props.onClick,n=e.state.isMenuVisible;s(t),n?e.hideMenu():e.showMenu()})),h()(c()(e),"hideMenu",(function(){return e.toggleMenu(!1)})),h()(c()(e),"showMenu",(function(){return e.toggleMenu(!0)})),e}return r()(s,[{key:"toggleMenu",value:function(e){this.props.disabled||(this.setState({isMenuVisible:e}),this.props.onToggle(e))}},{key:"render",value:function(){var e=this.props,t=e.toggleTitle,s=e.translate,n=e.position,a=e.children,i=e.disabled,r=e.className,o=e.popoverClassName,c=this.state.isMenuVisible,l=y()("ellipsis-menu",r,{"is-menu-visible":c,"is-disabled":i}),d=y()("ellipsis-menu__menu","popover",o);return j.a.createElement("span",{className:l},j.a.createElement(x.a,{ref:this.popoverContext,onClick:this.handleClick,title:t||s("Toggle menu"),borderless:!0,disabled:i,className:"ellipsis-menu__toggle"},j.a.createElement(O.a,{icon:"ellipsis",className:"ellipsis-menu__toggle-icon"})),c&&j.a.createElement(k.a,{isVisible:!0,onClose:this.hideMenu,position:n,context:this.popoverContext.current,className:d},a))}}]),s}(g.Component));h()(E,"propTypes",{translate:b.a.func,toggleTitle:b.a.string,position:b.a.string,disabled:b.a.bool,onClick:b.a.func,onToggle:b.a.func,popoverClassName:b.a.string}),h()(E,"defaultProps",{onClick:I.a,onToggle:I.a}),t.a=Object(_.c)(E)},"./components/ellipsis-menu/style.scss":function(e,t,s){},"./components/forms/clipboard-button/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=s.n(i),o=s("../node_modules/react/index.js"),c=s.n(o),l=s("../node_modules/prop-types/index.js"),d=s.n(l),u=s("../node_modules/react-dom/index.js"),p=s.n(u),m=s("../node_modules/clipboard/dist/clipboard.js"),h=s.n(m),f=s("../node_modules/lodash-es/noop.js"),b=s("../node_modules/classnames/index.js"),g=s.n(b),j=s("../packages/components/dist/esm/button/index.js");function v(e){var t=e.className,s=e.text,n=e.onCopy,i=void 0===n?f.a:n,o=r()(e,["className","text","onCopy"]),l=c.a.useRef(),d=c.a.useRef(),u=c.a.useRef();return c.a.useEffect((function(){d.current=function(){return s},u.current=i}),[s,i]),c.a.useEffect((function(){var e=p.a.findDOMNode(l.current),t=new h.a(e,{text:function(){return d.current()}});return t.on("success",(function(){return u.current()})),function(){return t.destroy()}}),[]),c.a.createElement(j.a,a()({},o,{ref:l,className:g()("clipboard-button",t)}))}v.propTypes={className:d.a.string,text:d.a.string,onCopy:d.a.func},t.a=v},"./components/forms/form-checkbox/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=s.n(i),o=s("../node_modules/react/index.js"),c=s.n(o),l=s("../node_modules/classnames/index.js"),d=s.n(l);t.a=function(e){var t=e.className,s=r()(e,["className"]);return c.a.createElement("input",a()({},s,{type:"checkbox",className:d()(t,"form-checkbox")}))}},"./components/forms/form-range/style.scss":function(e,t,s){},"./components/forms/form-text-input/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return x}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/createClass.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/prop-types/index.js"),y=s.n(v),_=s("../node_modules/classnames/index.js"),I=s.n(_),O=s("../node_modules/lodash-es/omit.js"),x=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{value:e.props.value||""}),b()(d()(e),"currentTextField",void 0),b()(d()(e),"textFieldRef",(function(t){e.currentTextField=t;var s=e.props.inputRef;s&&("function"==typeof s?s(t):s.current=t)})),b()(d()(e),"selectOnFocus",(function(t){e.props.selectOnFocus&&t.target.select()})),b()(d()(e),"onChange",(function(t){var s,n;e.setState({value:t.target.value}),null===(s=(n=e.props).onChange)||void 0===s||s.call(n,t)})),e}return c()(s,[{key:"componentDidUpdate",value:function(e){this.updateValueIfNeeded(e.value)}},{key:"updateValueIfNeeded",value:function(e){var t=this.props.value;e!==t&&t!==this.state.value&&this.setState({value:t})}},{key:"focus",value:function(){this.currentTextField&&this.currentTextField.focus()}},{key:"render",value:function(){var e=Object(O.a)(this.props,"isError","isValid","selectOnFocus","inputRef","onChange","value"),t=I()("form-text-input",this.props.className,{"is-error":this.props.isError,"is-valid":this.props.isValid});return j.a.createElement("input",a()({type:"text"},e,{value:this.state.value,ref:this.textFieldRef,className:t,onClick:this.selectOnFocus,onChange:this.onChange}))}}]),s}(g.PureComponent);b()(x,"propTypes",{isError:y.a.bool,isValid:y.a.bool,selectOnFocus:y.a.bool,className:y.a.string})},"./components/forms/range/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return w}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/createClass.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/prop-types/index.js"),y=s.n(v),_=s("../node_modules/lodash-es/uniqueId.js"),I=s("../node_modules/lodash-es/omit.js"),O=s("../node_modules/classnames/index.js"),x=s.n(O),k=s("../node_modules/lodash-es/noop.js"),E=(s("./components/forms/form-range/style.scss"),function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"rangeRef",j.a.createRef()),b()(d()(e),"shouldNormalizeChange",(function(){var e=window.navigator.userAgent;return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")})),b()(d()(e),"onChange",(function(t){e.props.onChange(t)})),e}return c()(s,[{key:"componentDidMount",value:function(){this.shouldNormalizeChange()&&this.rangeRef.current.addEventListener("change",this.onChange)}},{key:"componentWillUnmount",value:function(){this.rangeRef.current.removeEventListener("change",this.onChange)}},{key:"render",value:function(){var e=x()(this.props.className,"form-range");return j.a.createElement("input",a()({ref:this.rangeRef,type:"range",className:e},Object(I.a)(this.props,"className")))}}]),s}(j.a.Component));b()(E,"displayName","FormRange"),b()(E,"propTypes",{onChange:y.a.func}),b()(E,"defaultProps",{onChange:k.a});s("./components/forms/range/style.scss");var w=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{id:Object(_.a)("range")}),b()(d()(e),"getMinContentElement",(function(){if(e.props.minContent)return j.a.createElement("span",{className:"range__content is-min"},e.props.minContent)})),b()(d()(e),"getMaxContentElement",(function(){if(e.props.maxContent)return j.a.createElement("span",{className:"range__content is-max"},e.props.maxContent)})),b()(d()(e),"getValueLabelElement",(function(){var t,s;if(e.props.showValueLabel)return t=100*(e.props.value-e.props.min)/(e.props.max-e.props.min),s=Math.floor((50-t)/50*13),j.a.createElement("span",{className:"range__label",style:{left:(t||0)+"%",marginLeft:s}},j.a.createElement("output",{className:"range__label-inner",htmlFor:e.state.id,value:e.props.value},e.props.value))})),e}return c()(s,[{key:"render",value:function(){var e=x()(this.props.className,"range",{"has-min-content":!!this.props.minContent,"has-max-content":!!this.props.maxContent});return j.a.createElement("div",{className:e},this.getMinContentElement(),j.a.createElement(E,a()({id:this.state.id,className:"range__input"},Object(I.a)(this.props,"minContent","maxContent","showValueLabel","className"))),this.getMaxContentElement(),this.getValueLabelElement())}}]),s}(j.a.Component);b()(w,"displayName","Range"),b()(w,"propTypes",{minContent:y.a.oneOfType([y.a.element,y.a.string]),maxContent:y.a.oneOfType([y.a.element,y.a.string]),min:y.a.oneOfType([y.a.string,y.a.number]),max:y.a.oneOfType([y.a.string,y.a.number]),value:y.a.oneOfType([y.a.string,y.a.number]),showValueLabel:y.a.bool}),b()(w,"defaultProps",{min:0,max:10,value:0,showValueLabel:!1})},"./components/forms/range/style.scss":function(e,t,s){},"./components/forms/sortable-list/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/createClass.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/prop-types/index.js"),y=s.n(v),_=s("../packages/i18n-calypso/dist/esm/index.js"),I=s("../node_modules/lodash-es/findIndex.js"),O=s("../node_modules/lodash-es/fromPairs.js"),x=s("../node_modules/lodash-es/assign.js"),k=s("../node_modules/lodash-es/noop.js"),E=s("../node_modules/classnames/index.js"),w=s.n(E),S=s("../node_modules/debug/src/browser.js"),C=s.n(S),P=s("./components/gridicon/index.tsx"),T=s("../packages/components/dist/esm/screen-reader-text/index.js"),M=s("./lib/touch-detect/index.js"),D=(s("./components/forms/sortable-list/style.scss"),C()("calypso:forms:sortable-list")),N=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),b()(d()(e),"state",{activeIndex:null,activeOrder:null,position:null}),b()(d()(e),"listRef",j.a.createRef()),b()(d()(e),"itemsRefs",new Map),b()(d()(e),"itemShadowRefs",new Map),b()(d()(e),"getPositionForCursorElement",(function(e,t){return{top:t.clientY-e.clientHeight/2,left:t.clientX-e.clientWidth/2}})),b()(d()(e),"compareCursorVerticalToElement",(function(e,t){var s=e.getBoundingClientRect();return t.clientY<s.top?-1:t.clientY>s.bottom?1:0})),b()(d()(e),"isCursorBeyondElementThreshold",(function(e,t,s,n){var a=e.getBoundingClientRect();switch(t){case"top":return n.clientY<=a.top+a.height/2;case"right":return n.clientX>=a.left+a.width/2&&("top"===s||n.clientY>=a.top)&&("bottom"===s||n.clientY<=a.bottom);case"bottom":return n.clientY>=a.top+a.height/2;case"left":return n.clientX<=a.left+a.width/2&&("top"===s||n.clientY>=a.top)&&("bottom"===s||n.clientY<=a.bottom);default:return!1}})),b()(d()(e),"getAdjustedElementIndex",(function(t){return e.state.activeOrder?e.state.activeOrder[t]:t})),b()(d()(e),"getCursorElementIndex",(function(t){var s=e.compareCursorVerticalToElement(e.listRef.current,t),n=e.getAdjustedElementIndex(e.state.activeIndex),a=e.itemShadowRefs.get("wrap-shadow-"+e.state.activeIndex).current.getBoundingClientRect(),i=Object(I.a)(e.props.children,(function(i,r){var o,c;if(r===e.state.activeIndex)return!1;var l=e.getAdjustedElementIndex(r);return"horizontal"===e.props.direction&&(1===s&&e.itemsRefs.get("wrap-"+r).current.getBoundingClientRect().top>=a.top?c="bottom":-1===s&&e.itemsRefs.get("wrap-"+r).current.getBoundingClientRect().bottom<=a.bottom&&(c="top")),l<n?o=e.isCursorBeyondElementThreshold(e.itemsRefs.get("wrap-"+r).current,"horizontal"===e.props.direction?"left":"top",c,t):l>n&&(o=o||e.isCursorBeyondElementThreshold(e.itemsRefs.get("wrap-"+r).current,"horizontal"===e.props.direction?"right":"bottom",c,t)),o}));return e.getAdjustedElementIndex(i)})),b()(d()(e),"moveItem",(function(t){var s="previous"===t?-1:1,n=Object.keys(e.props.children).map(Number);n[e.state.activeIndex+s]=e.state.activeIndex,n[e.state.activeIndex]=e.state.activeIndex+s,e.props.onChange(n),e.setState({activeIndex:n[e.state.activeIndex]})})),b()(d()(e),"onMouseDown",(function(t,s){e.setState({activeIndex:t,position:e.getPositionForCursorElement(s.currentTarget.firstChild,s)})})),b()(d()(e),"onMouseMove",(function(t){var s;if(null!==e.state.activeIndex&&e.props.allowDrag&&!Object(M.a)()){s=e.state.activeOrder;var n=e.getCursorElementIndex(t);if(n>=0)if(e.state.activeIndex===n)s=null;else{for(var a=0,i=(s=Object.keys(e.props.children).map(Number)).length;a<i;a++)a>=n&&a<e.state.activeIndex?s[a]=a+1:a<=n&&a>e.state.activeIndex&&(s[a]=a-1);s[e.state.activeIndex]=n}e.setState({position:e.getPositionForCursorElement(e.itemsRefs.get("wrap-"+e.state.activeIndex).current.firstChild,t),activeOrder:s})}})),b()(d()(e),"onMouseUp",(function(){e.state.activeOrder&&e.props.onChange(e.state.activeOrder),e.setState({activeIndex:null,activeOrder:null,position:null})})),b()(d()(e),"onClick",(function(t){e.setState({activeIndex:t})})),b()(d()(e),"getOrderedListItemElements",(function(){return e.itemsRefs.clear(),e.itemShadowRefs.clear(),j.a.Children.map(e.props.children,(function(e,t){var s=this.state.activeIndex===t,n=this.props.allowDrag&&!Object(M.a)(),i=n?["onMouseDown","onMouseUp"]:["onClick"],r={order:this.getAdjustedElementIndex(t)},o=w()({"sortable-list__item":!0,"is-active":s,"is-draggable":n});i=Object(O.a)(i.map((function(e){return[e,this[e].bind(null,t)]}),this)),s&&Object(x.a)(r,this.state.position);var c=j.a.createRef();this.itemsRefs.set("wrap-"+t,c);var l=j.a.createElement("li",a()({ref:c,key:"wrap-"+t},i,{className:o,style:r}),e);if(s&&n){var d=j.a.createRef();return this.itemShadowRefs.set("wrap-shadow-"+t,d),[j.a.createElement("li",{ref:d,key:"wrap-shadow-"+t,className:"sortable-list__item is-shadow",style:r},e),l]}return l}),d()(e))})),b()(d()(e),"getNavigationElement",(function(){if(!e.props.allowDrag||Object(M.a)())return j.a.createElement("div",{className:"sortable-list__navigation"},j.a.createElement("button",{type:"button",onClick:e.moveItem.bind(null,"previous"),className:"sortable-list__navigation-button is-previous",disabled:null===e.state.activeIndex||0===e.state.activeIndex},j.a.createElement(T.a,null,e.props.translate("Move previous")),j.a.createElement(P.a,{icon:"chevron-down",size:24})),j.a.createElement("button",{type:"button",onClick:e.moveItem.bind(null,"next"),className:"sortable-list__navigation-button is-next",disabled:null===e.state.activeIndex||e.state.activeIndex===e.props.children.length-1},j.a.createElement(T.a,null,e.props.translate("Move next")),j.a.createElement(P.a,{icon:"chevron-up",size:24})))})),e}return c()(s,[{key:"UNSAFE_componentWillMount",value:function(){D("Mounting "+this.constructor.displayName+" React component.")}},{key:"componentDidMount",value:function(){Object(M.a)()||(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"render",value:function(){var e=w()({"sortable-list":!0,"is-horizontal":"horizontal"===this.props.direction,"is-vertical":"vertical"===this.props.direction});return j.a.createElement("div",{className:e},j.a.createElement("ol",{ref:this.listRef,className:"sortable-list__list"},this.getOrderedListItemElements()),this.getNavigationElement())}}]),s}(j.a.Component);b()(N,"propTypes",{direction:y.a.oneOf(["horizontal","vertical"]),allowDrag:y.a.bool,onChange:y.a.func}),b()(N,"defaultProps",{direction:"horizontal",allowDrag:!0,onChange:k.a}),t.a=Object(_.c)(N)},"./components/forms/sortable-list/style.scss":function(e,t,s){},"./components/gallery-shortcode/index.tsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return M}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createClass.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/inherits.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/createSuper.js"),b=s.n(f),g=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),j=s.n(g),v=s("../node_modules/react/index.js"),y=s.n(v),_=s("../node_modules/classnames/index.js"),I=s.n(_),O=s("../node_modules/debug/src/browser.js"),x=s.n(O),k=s("../node_modules/lodash-es/assign.js"),E=s("../node_modules/lodash-es/pick.js"),w=s("./blocks/shortcode/index.js"),S=s("./lib/shortcode/index.js"),C=s("./lib/media/utils/generate-gallery-shortcode.js"),P=s("./lib/media/constants.js"),T=x()("calypso:gallery-shortcode"),M=function(e){h()(s,e);var t=b()(s);function s(){var e;c()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),j()(p()(e),"filterRenderResult",(function(t){if(!t.body&&!t.scripts&&!t.styles)return t;var s=Object(k.a)({},t,{scripts:{"tiled-gallery":{src:"https://s0.wp.com/wp-content/mu-plugins/tiled-gallery/tiled-gallery.js"}},styles:{"tiled-gallery":{src:"https://s0.wp.com/wp-content/mu-plugins/tiled-gallery/tiled-gallery.css"},"gallery-styles":{src:"https://widgets.wp.com/gallery-preview/style.css"}}});return"slideshow"===e.getAttributes().type&&Object(k.a)(s,{scripts:{"jquery-cycle":{src:"https://s0.wp.com/wp-content/mu-plugins/shortcodes/js/jquery.cycle.min.js"},"jetpack-slideshow":{src:"https://s0.wp.com/wp-content/mu-plugins/shortcodes/js/slideshow-shortcode.js",extra:'var jetpackSlideshowSettings = { "spinner": "https://s0.wp.com/wp-content/mu-plugins/shortcodes/img/slideshow-loader.gif" };'}},styles:{"jetpack-slideshow":{src:"https://s0.wp.com/wp-content/mu-plugins/shortcodes/css/slideshow-shortcode.css"}}}),s})),j()(p()(e),"getAttributes",(function(){var t=Object(E.a)(e.props,"items","type","columns","orderBy","link","size");return e.props.children&&Object(k.a)(t,Object(S.b)(e.props.children).attrs.named),t})),j()(p()(e),"getShortcode",(function(){return e.props.children?e.props.children:Object(C.a)(e.getAttributes())})),e}return d()(s,[{key:"render",value:function(){var e=this.getShortcode();if(!e)return null;T(e);var t=this.props,s=t.siteId,n=(t.items,t.type,t.columns,t.orderBy,t.link,t.size,t.className),i=(t.children,r()(t,["siteId","items","type","columns","orderBy","link","size","className","children"])),o=I()("gallery-shortcode",n);return y.a.createElement(w.a,a()({},i,{siteId:s,filterRenderResult:this.filterRenderResult,className:o}),e)}}]),s}(v.Component);j()(M,"defaultProps",P.b)},"./components/header-cake/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return T}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/prop-types/index.js"),p=s.n(u),m=s("../node_modules/react/index.js"),h=s.n(m),f=s("../node_modules/classnames/index.js"),b=s.n(f),g=s("../packages/components/dist/esm/card/index.js"),j=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),v=s.n(j),y=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),_=s.n(y),I=s("../packages/viewport/dist/esm/index.js"),O=s("../packages/i18n-calypso/dist/esm/index.js"),x=s("./components/gridicon/index.tsx"),k=s("../node_modules/lodash-es/throttle.js"),E=s("../packages/components/dist/esm/button/index.js"),w=(s("./components/header-cake/style.scss"),480),S=8,C=function(e){c()(s,e);var t=d()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),_()(v()(e),"state",{windowWidth:Object(I.c)()}),_()(v()(e),"handleWindowResize",(function(){e.setState({windowWidth:Object(I.c)()})})),e}return r()(s,[{key:"componentDidMount",value:function(){this.resizeThrottled=Object(k.a)(this.handleWindowResize,100),window.addEventListener("resize",this.resizeThrottled)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resizeThrottled)}},{key:"hideText",value:function(e){return!this.props.alwaysShowActionText&&(this.state.windowWidth<=w&&e.length>=S||this.state.windowWidth<=300)}},{key:"render",value:function(){var e=this.props,t=e.href,s=e.icon,n=e.onClick,a=e.spacer,i=e.text,r=e.translate,o=void 0===i?r("Back"):i,c=b()({"header-cake__back":!0,"is-spacer":a,"is-action":!!s});return h.a.createElement(E.a,{compact:!0,borderless:!0,className:c,href:t,onClick:n,disabled:a},h.a.createElement(x.a,{icon:s||"arrow-left",size:18}),!this.hideText(o)&&o)}}]),s}(m.Component);_()(C,"propTypes",{onClick:p.a.func,href:p.a.string,text:p.a.string,spacer:p.a.bool,alwaysShowActionText:p.a.bool}),_()(C,"defaultProps",{spacer:!1,disabled:!1,alwaysShowActionText:!1});var P=Object(O.c)(C),T=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.backText,s=e.backHref,n=e.actionButton,a=e.actionText,i=e.actionIcon,r=e.actionHref,o=e.actionOnClick,c=e.alwaysShowActionText,l=b()("header-cake",this.props.className,{"is-compact":this.props.isCompact});return h.a.createElement(g.a,{className:l},h.a.createElement(P,{text:t,href:s,onClick:this.props.onClick}),h.a.createElement("div",{className:"header-cake__title",role:"presentation",onClick:this.props.onTitleClick},this.props.children),n||h.a.createElement(P,{text:a||t,href:r||s,onClick:o,icon:i,alwaysShowActionText:c,spacer:!o}))}}]),s}(m.Component);T.displayName="HeaderCake",T.propTypes={onClick:p.a.func,onTitleClick:p.a.func,backText:p.a.string,backHref:p.a.string,actionButton:p.a.element,actionText:p.a.string,actionHref:p.a.string,actionIcon:p.a.string,actionOnClick:p.a.func,alwaysShowActionText:p.a.bool},T.defaultProps={isCompact:!1,alwaysShowActionText:!1}},"./components/header-cake/style.scss":function(e,t,s){},"./components/localized-moment/index.js":function(e,t,s){"use strict";s.d(t,"b",(function(){return l})),s.d(t,"a",(function(){return d}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/react/index.js"),r=s.n(i),o=s("../node_modules/@wordpress/compose/build-module/utils/create-higher-order-component/index.js"),c=s("./components/localized-moment/context.js"),l=Object(o.a)((function(e){return function(t){return r.a.createElement(c.a.Consumer,null,(function(s){return r.a.createElement(e,a()({},t,s))}))}}),"WithLocalizedMoment"),d=function(){return r.a.useContext(c.a).moment}},"./components/notice/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/prop-types/index.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/classnames/index.js"),y=s.n(v),_=s("../node_modules/lodash-es/noop.js"),I=s("../packages/i18n-calypso/dist/esm/index.js"),O=s("./components/gridicon/index.tsx"),x=(s("./components/notice/style.scss"),["add","cross-circle","ellipsis-circle","help","info","notice","pause","play","spam"]),k=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"dismissTimeout",null),e}return r()(s,[{key:"componentDidMount",value:function(){this.props.duration>0&&(this.dismissTimeout=setTimeout(this.props.onDismissClick,this.props.duration))}},{key:"componentWillUnmount",value:function(){this.dismissTimeout&&clearTimeout(this.dismissTimeout)}},{key:"componentDidUpdate",value:function(){clearTimeout(this.dismissTimeout),this.props.duration>0&&(this.dismissTimeout=setTimeout(this.props.onDismissClick,this.props.duration))}},{key:"getIcon",value:function(){var e;switch(this.props.status){case"is-info":e="info";break;case"is-success":e="checkmark";break;case"is-error":case"is-warning":e="notice";break;default:e="info"}return e}},{key:"render",value:function(){var e=this.props,t=e.children,s=e.className,n=e.icon,a=e.isCompact,i=e.isLoading,r=e.onDismissClick,o=e.showDismiss,c=void 0===o?!a:o,l=e.status,d=e.text,u=e.translate,p=y()("notice",l,s,{"is-compact":a,"is-loading":i,"is-dismissable":c}),m=n||this.getIcon(),h=x.includes(m);return j.a.createElement("div",{className:p},j.a.createElement("span",{className:"notice__icon-wrapper"},h&&j.a.createElement("span",{className:"notice__icon-wrapper-drop"}),j.a.createElement(O.a,{className:"notice__icon",icon:m,size:24})),j.a.createElement("span",{className:"notice__content"},j.a.createElement("span",{className:"notice__text"},d||t)),d?t:null,c&&j.a.createElement("button",{className:"notice__dismiss",onClick:r,"aria-label":u("Dismiss")},j.a.createElement(O.a,{icon:"cross",size:24})))}}]),s}(g.Component);h()(k,"defaultProps",{className:"",duration:0,icon:null,isCompact:!1,isLoading:!1,onDismissClick:_.a,status:null,text:null}),h()(k,"propTypes",{className:b.a.string,duration:b.a.number,icon:b.a.string,isCompact:b.a.bool,isLoading:b.a.bool,onDismissClick:b.a.func,showDismiss:b.a.bool,status:b.a.oneOf(["is-error","is-info","is-success","is-warning","is-plain"]),text:b.a.oneOfType([b.a.arrayOf(b.a.oneOfType([b.a.string,b.a.node])),b.a.oneOfType([b.a.string,b.a.node])]),translate:b.a.func.isRequired}),t.a=Object(I.c)(k)},"./components/notice/notice-action.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return j}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/prop-types/index.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("./components/gridicon/index.tsx"),j=(s("./components/notice/style.scss"),function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e={"aria-label":this.props["aria-label"],className:"notice__action",href:this.props.href,onClick:this.props.onClick};return this.props.external&&(e.target="_blank",e.rel="noopener noreferrer"),b.a.createElement("a",e,b.a.createElement("span",null,this.props.children),this.props.icon&&b.a.createElement(g.a,{icon:this.props.icon,size:24}),this.props.external&&b.a.createElement(g.a,{icon:"external",size:24}))}}]),s}(b.a.Component));p()(j,"displayName","NoticeAction"),p()(j,"propTypes",{"aria-label":h.a.string,href:h.a.string,onClick:h.a.func,external:h.a.bool,icon:h.a.string}),p()(j,"defaultProps",{external:!1})},"./components/notice/style.scss":function(e,t,s){},"./components/popover/menu-item.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return w}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/createClass.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../node_modules/prop-types/index.js"),j=s.n(g),v=s("../node_modules/react/index.js"),y=s.n(v),_=s("../node_modules/classnames/index.js"),I=s.n(_),O=s("../node_modules/lodash-es/omit.js"),x=s("../node_modules/lodash-es/noop.js"),k=s("./components/gridicon/index.tsx"),E=s("./components/external-link/index.jsx"),w=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"handleMouseOver",(function(t){e.props.focusOnHover&&t.target.focus(),e.props.onMouseOver()})),e}return c()(s,[{key:"render",value:function(){var e=this.props,t=e.children,s=e.className,n=e.href,i=e.icon,r=e.isSelected,o=e.isExternalLink,c=Object(O.a)(this.props,"icon","focusOnHover","isSelected","isExternalLink","className","itemComponent"),l=I()("popover__menu-item",s,{"is-selected":r}),d=this.props.itemComponent;return o&&n?(d=E.a,c.icon=!0):n&&(d="a"),y.a.createElement(d,a()({role:"menuitem",onMouseOver:this.handleMouseOver,tabIndex:"-1",className:l},c),i&&y.a.createElement(k.a,{icon:i,size:18}),t)}}]),s}(v.Component);b()(w,"propTypes",{href:j.a.string,className:j.a.string,isSelected:j.a.bool,icon:j.a.string,focusOnHover:j.a.bool,onMouseOver:j.a.func,isExternalLink:j.a.bool,itemComponent:j.a.oneOfType([j.a.func,j.a.string])}),b()(w,"defaultProps",{isSelected:!1,focusOnHover:!0,onMouseOver:x.a,itemComponent:"button"})},"./components/resizable-iframe/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return S}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/createClass.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../node_modules/react-dom/index.js"),j=s.n(g),v=s("../node_modules/prop-types/index.js"),y=s.n(v),_=s("../node_modules/react/index.js"),I=s.n(_),O=s("../node_modules/debug/src/browser.js"),x=s.n(O),k=s("../node_modules/lodash-es/omit.js"),E=x()("calypso:resizable-iframe"),w=function(){},S=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{width:0,height:0}),b()(d()(e),"getFrameBody",(function(){return j.a.findDOMNode(e.refs.iframe).contentDocument.body})),b()(d()(e),"maybeConnect",(function(){if(e.isFrameAccessible()){var t=e.getFrameBody();if(null===t.getAttribute("data-resizable-iframe-connected")){var s=document.createElement("script");s.innerHTML="\n\t\t\t( function() {\n\t\t\t\tvar observer;\n\n\t\t\t\tif ( ! window.MutationObserver || ! document.body || ! window.top ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfunction sendResize() {\n\t\t\t\t\twindow.top.postMessage( {\n\t\t\t\t\t\taction: 'resize',\n\t\t\t\t\t\twidth: document.body.offsetWidth,\n\t\t\t\t\t\theight: document.body.offsetHeight\n\t\t\t\t\t}, '*' );\n\t\t\t\t}\n\n\t\t\t\tobserver = new MutationObserver( sendResize );\n\t\t\t\tobserver.observe( document.body, {\n\t\t\t\t\tattributes: true,\n\t\t\t\t\tattributeOldValue: false,\n\t\t\t\t\tcharacterData: true,\n\t\t\t\t\tcharacterDataOldValue: false,\n\t\t\t\t\tchildList: true,\n\t\t\t\t\tsubtree: true\n\t\t\t\t} );\n\n\t\t\t\twindow.addEventListener( 'load', sendResize, true );\n\n\t\t\t\t// Hack: Remove viewport unit styles, as these are relative\n\t\t\t\t// the iframe root and interfere with our mechanism for\n\t\t\t\t// determining the unconstrained page bounds.\n\t\t\t\tfunction removeViewportStyles( ruleOrNode ) {\n\t\t\t\t\t[ 'width', 'height', 'minHeight', 'maxHeight' ].forEach( function( style ) {\n\t\t\t\t\t\tif ( /^\\d+(vmin|vmax|vh|vw)$/.test( ruleOrNode.style[ style ] ) ) {\n\t\t\t\t\t\t\truleOrNode.style[ style ] = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tArray.prototype.forEach.call( document.querySelectorAll( '[style]' ), removeViewportStyles );\n\t\t\t\tArray.prototype.forEach.call( document.styleSheets, function( stylesheet ) {\n\t\t\t\t\tArray.prototype.forEach.call( stylesheet.cssRules || stylesheet.rules, removeViewportStyles );\n\t\t\t\t} );\n\n\t\t\t\tdocument.body.style.position = 'absolute';\n\t\t\t\tdocument.body.setAttribute( 'data-resizable-iframe-connected', '' );\n\n\t\t\t\tsendResize();\n\t\t\t} )();\n\t\t",t.appendChild(s)}}})),b()(d()(e),"isFrameAccessible",(function(){try{return!!e.getFrameBody()}catch(e){return!1}})),b()(d()(e),"checkMessageForResize",(function(t){var s=j.a.findDOMNode(e.refs.iframe),n=t.data||{};if("string"==typeof n)try{n=JSON.parse(n)}catch(e){}if(s&&s.contentWindow===t.source){E("Received message: %o",n);var a=n,i=a.action,r=a.width,o=a.height,c=e.state,l=c.width,d=c.height;"resize"!==i||l===r&&d===o||(e.setState({width:r,height:o}),e.props.onResize())}})),b()(d()(e),"onLoad",(function(t){e.maybeConnect(),e.props.onLoad(t)})),e}return c()(s,[{key:"UNSAFE_componentWillMount",value:function(){E("Mounting "+this.constructor.displayName+" React component.")}},{key:"componentDidMount",value:function(){window.addEventListener("message",this.checkMessageForResize,!1),this.maybeConnect()}},{key:"componentDidUpdate",value:function(){this.maybeConnect()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this.checkMessageForResize)}},{key:"render",value:function(){return I.a.createElement("iframe",a()({ref:"iframe"},Object(k.a)(this.props,["onResize"]),{onLoad:this.onLoad,width:this.props.width||this.state.width,height:this.props.height||this.state.height}))}}]),s}(I.a.Component);b()(S,"displayName","ResizableIframe"),b()(S,"propTypes",{src:y.a.string,width:y.a.oneOfType([y.a.string,y.a.number]),height:y.a.oneOfType([y.a.string,y.a.number]),onLoad:y.a.func,onResize:y.a.func}),b()(S,"defaultProps",{onLoad:w,onResize:w})},"./components/segmented-control/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return O}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/prop-types/index.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("../node_modules/classnames/index.js"),j=s.n(g),v=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=s.n(v),_=function(e){c()(s,e);var t=d()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),p()(y()(e),"handleKeyEvent",(function(e){switch(e.keyCode){case 13:case 32:e.preventDefault(),document.activeElement.click()}})),e}return r()(s,[{key:"render",value:function(){var e=j()({"segmented-control__item":!0,"is-selected":this.props.selected}),t=j()("segmented-control__link",p()({},"item-index-".concat(this.props.index),null!=this.props.index));return b.a.createElement("li",{className:e},b.a.createElement("a",{href:this.props.path,className:t,onClick:this.props.onClick,title:this.props.title,"data-e2e-value":this.props.value,role:"radio",tabIndex:0,"aria-checked":this.props.selected,onKeyDown:this.handleKeyEvent},b.a.createElement("span",{className:"segmented-control__text"},this.props.children)))}}]),s}(b.a.Component);p()(_,"propTypes",{children:h.a.node.isRequired,path:h.a.string,selected:h.a.bool,title:h.a.string,value:h.a.string,onClick:h.a.func,index:h.a.number}),p()(_,"defaultProps",{selected:!1});var I=_,O=(s("./components/segmented-control/style.scss"),function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e={"is-compact":this.props.compact,"is-primary":this.props.primary};return b.a.createElement("ul",{className:j()("segmented-control",e,this.props.className),style:this.props.style,role:"radiogroup"},this.props.children)}}]),s}(b.a.Component));p()(O,"Item",I),p()(O,"propTypes",{className:h.a.string,compact:h.a.bool,primary:h.a.bool,style:h.a.object,children:h.a.node.isRequired})},"./components/segmented-control/style.scss":function(e,t,s){},"./components/sorted-grid/style.scss":function(e,t,s){},"./components/sticky-panel/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/createClass.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../packages/viewport/dist/esm/index.js"),j=s("../node_modules/lodash-es/throttle.js"),v=s("../node_modules/lodash-es/defer.js"),y=s("../node_modules/prop-types/index.js"),_=s.n(y),I=s("../node_modules/react-dom/index.js"),O=s.n(I),x=s("../node_modules/react/index.js"),k=s.n(x),E=s("../node_modules/classnames/index.js"),w=s.n(E),S=s("./lib/after-layout-flush/index.ts"),C=(s("./components/sticky-panel/style.scss"),"undefined"!=typeof window&&"IntersectionObserver"in window),P={minLimit:_.a.oneOfType([_.a.bool,_.a.number])},T={minLimit:!1};function M(){return document.getElementById("header").getBoundingClientRect().height}function D(e){if(e.isSticky)return{top:M(),width:e.blockWidth}}function N(e,t){return{spacerHeight:t?O.a.findDOMNode(e).clientHeight:0,blockWidth:t?O.a.findDOMNode(e).clientWidth:0}}function R(e,t){var s=N(e,t.isSticky);return t.spacerHeight!==s.spacerHeight||t.blockWidth!==s.blockWidth?s:null}function L(e,t){var s=w()("sticky-panel",e.className,{"is-sticky":t.isSticky});return k.a.createElement("div",{className:s},k.a.createElement("div",{className:"sticky-panel__content",style:D(t)},e.children),k.a.createElement("div",{className:"sticky-panel__spacer",style:{height:t.spacerHeight}}))}function A(e){return!1!==e&&e>=window.innerWidth||Object(g.e)()}var U=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{isSticky:!1,spacerHeight:0,blockWidth:0}),b()(d()(e),"onIntersection",Object(S.a)((function(t){if(t&&t[0]){var s=t[0],n=s.intersectionRatio,a=s.rootBounds,i=s.boundingClientRect,r=n<1&&a.bottom>i.bottom;e.updateStickyState(r)}}))),b()(d()(e),"throttleOnResize",Object(j.a)((function(){return e.setState((function(t){return N(d()(e),t.isSticky)}))}),200)),e}return c()(s,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.throttleOnResize),this.deferredMount=Object(v.a)((function(){e.observer=new IntersectionObserver(e.onIntersection,{threshold:[0,1],rootMargin:"-".concat(M(),"px 0px 0px 0px")}),e.observer.observe(O.a.findDOMNode(e))}))}},{key:"componentWillUnmount",value:function(){this.observer&&this.observer.disconnect(),this.onIntersection.cancel(),clearTimeout(this.deferredMount),window.removeEventListener("resize",this.throttleOnResize)}},{key:"updateStickyState",value:function(e){if(A(this.props.minLimit))return this.setState({isSticky:!1});e!==this.state.isSticky&&this.setState(a()({isSticky:e},N(this,e)))}},{key:"render",value:function(){return L(this.props,this.state)}}]),s}(k.a.Component);b()(U,"displayName","StickyPanel"),b()(U,"propTypes",P),b()(U,"defaultProps",T);var V=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{isSticky:!1,spacerHeight:0,blockWidth:0}),b()(d()(e),"onWindowScroll",Object(S.a)((function(){var t=O.a.findDOMNode(d()(e)).getBoundingClientRect().top<M();e.updateStickyState(t)}))),b()(d()(e),"throttleOnResize",Object(j.a)((function(){return e.setState((function(t){return R(d()(e),t)}))}),200)),e}return c()(s,[{key:"componentDidMount",value:function(){this.onWindowScroll(),window.addEventListener("scroll",this.onWindowScroll),window.addEventListener("resize",this.throttleOnResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.onWindowScroll),window.removeEventListener("resize",this.throttleOnResize),this.onWindowScroll.cancel()}},{key:"updateStickyState",value:function(e){if(A(this.props.minLimit))return this.setState({isSticky:!1});e!==this.state.isSticky&&this.setState(a()({isSticky:e},N(this,e)))}},{key:"render",value:function(){return L(this.props,this.state)}}]),s}(k.a.Component);b()(V,"displayName","StickyPanel"),b()(V,"propTypes",P),b()(V,"defaultProps",T),t.a=C?U:V},"./components/sticky-panel/style.scss":function(e,t,s){},"./components/text-diff/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/react/index.js"),a=s.n(n),i=s("../node_modules/prop-types/index.js"),r=s.n(i),o=s("../node_modules/classnames/index.js"),c=s.n(o),l=s("../node_modules/lodash-es/isArray.js"),d=s("../node_modules/lodash-es/isEmpty.js"),u=s("../node_modules/lodash-es/partialRight.js"),p=s("../node_modules/lodash-es/map.js"),m=(s("./components/text-diff/style.scss"),function(e,t,s){var n,i=e.orig,r=e.final,o=e.value,u=e.op,p=i||r||o,m=c()({"text-diff__additions":"add"===u,"text-diff__context":"copy"===u,"text-diff__deletions":"del"===u});return a.a.createElement("span",{className:m,key:t},s?(n=p,!Object(l.a)(n)||Object(d.a)(n)?n:n.join("\n\n")):p)}),h=Object(u.a)(m,!0),f=function(e){var t=e.operations,s=e.splitLines;return Object(p.a)(t,s?h:m)};f.propTypes={operations:r.a.arrayOf(r.a.shape({op:r.a.oneOf(["add","copy","del"]),value:r.a.string.isRequired})),splitLines:r.a.bool},t.a=f},"./components/text-diff/style.scss":function(e,t,s){},"./components/time-since/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return I}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("../node_modules/moment/moment.js"),j=s.n(g),v=s("./lib/human-date/index.js"),y=s("./lib/interval/index.ts"),_=s("./lib/react-smart-set-state/index.js"),I=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"smartSetState",_.a),h()(c()(e),"update",(function(t){var s=e.props.dateFormat;t=t||e.props.date,e.smartSetState({humanDate:Object(v.a)(t,s),fullDate:j()(t).format("llll")})})),e}return r()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.update()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.update(e.date)}},{key:"render",value:function(){return b.a.createElement("time",{className:this.props.className,dateTime:this.props.date,title:this.state.fullDate},b.a.createElement(y.e,{period:y.d,onTick:this.update}),this.state.humanDate)}}]),s}(f.PureComponent)},"./components/tinymce/plugins/wpcom-track-paste/sources.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return a}));var n="google_docs",a="unknown"},"./components/track-input-changes/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return _}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("../node_modules/prop-types/index.js"),j=s.n(g),v=s("../node_modules/lodash-es/assign.js"),y=s("../node_modules/lodash-es/noop.js"),_=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"onInputChange",(function(){e.inputEdited=!0})),h()(c()(e),"onInputBlur",(function(t){e.inputEdited&&(e.props.onNewValue(t),e.inputEdited=!1)})),e}return r()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.inputEdited=!1}},{key:"render",value:function(){var e=this,t=b.a.Children.only(this.props.children),s=Object(v.a)({},t.props,{onChange:function(s){"function"==typeof t.props.onChange&&t.props.onChange.call(t,s),e.onInputChange(s)},onBlur:function(s){"function"==typeof t.props.onBlur&&t.props.onBlur.call(t,s),e.onInputBlur(s)}});return b.a.cloneElement(t,s)}}]),s}(f.Component);h()(_,"displayName","TrackInputChanges"),h()(_,"propTypes",{onNewValue:j.a.func}),h()(_,"defaultProps",{onNewValue:y.a})},"./gutenberg/editor/index.js":function(e,t,s){"use strict";s.r(t);var n=s("../node_modules/page/page.js"),a=s.n(n),i=s("./my-sites/controller.js"),r=s("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),o=s.n(r),c=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),l=s.n(c),d=s("../node_modules/react/index.js"),u=s.n(d),p=s("../node_modules/lodash-es/noop.js"),m=s("../node_modules/lodash-es/get.js"),h=s("../node_modules/lodash-es/isInteger.js"),f=s("../node_modules/lodash-es/has.js"),b=s("./state/selectors/should-load-gutenberg.js"),g=s("./state/selectors/should-redirect-gutenberg.js"),j=s("./state/action-types.js"),v=s("./state/ui/selectors/get-selected-site-id.js"),y=s("./state/ui/selectors/get-selected-site-slug.js"),_=s("../node_modules/@babel/runtime/helpers/slicedToArray.js"),I=s.n(_),O=s("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),x=s.n(O),k=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),E=s.n(k),w=s("../node_modules/@babel/runtime/helpers/createClass.js"),S=s.n(w),C=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),P=s.n(C),T=s("../node_modules/@babel/runtime/helpers/inherits.js"),M=s.n(T),D=s("../node_modules/@babel/runtime/helpers/createSuper.js"),N=s.n(D),R=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),L=s.n(R),A=s("../node_modules/react-redux/es/index.js"),U=s("../node_modules/lodash-es/endsWith.js"),V=s("../node_modules/lodash-es/isArray.js"),q=s("../node_modules/lodash-es/map.js"),F=s("../node_modules/lodash-es/startsWith.js"),z=s("../node_modules/lodash-es/pickBy.js"),B=s("../node_modules/lodash-es/partial.js"),W=s("../node_modules/lodash-es/flowRight.js"),G=s("../node_modules/url/url.js"),H=s.n(G),Y=s("../packages/i18n-calypso/dist/esm/index.js"),K=s("./lib/media/store.js"),Q=s("./post-editor/editor-media-modal/index.jsx"),X=s("./state/sites/selectors/is-jetpack-site.js"),$=s("./state/sites/selectors/get-site-option.js"),J=s("./state/sites/selectors/get-site-admin-url.js"),Z=s("./state/sites/selectors/is-requesting-sites.js"),ee=s("./state/sites/selectors/is-requesting-site.js"),te=s("./state/sites/selectors/get-customizer-url.js"),se=s("./state/sites/selectors/get-site.js"),ne=s("./lib/url/add-query-args.ts"),ae=s("../node_modules/lodash-es/reduce.js"),ie=s("../node_modules/lodash-es/head.js"),re=s("../node_modules/lodash-es/split.js"),oe=s("../node_modules/lodash-es/includes.js"),ce=s("../node_modules/@wordpress/blocks/build-module/index.js"),le=function(e){return{id:Object(m.a)(e,"ID"),url:Object(m.a)(e,"URL"),alt:Object(m.a)(e,"alt"),caption:e.caption?Object(ce.z)(e.caption,{source:"children"}):"",description:Object(m.a)(e,"description"),filename:Object(m.a)(e,"file"),height:Object(m.a)(e,"height"),icon:Object(m.a)(e,"icon"),mime:Object(m.a)(e,"mime_type"),sizes:l()({full:{url:Object(m.a)(e,"URL")}},Object(ae.a)(e.thumbnails,(function(e,t,s){return e[s]={url:t},e}),{})),title:Object(m.a)(e,"title"),type:Object(ie.a)(Object(re.a)(Object(m.a)(e,"mime_type",""),"/")),width:Object(m.a)(e,"width")}},de=function(e){return!e||Object(V.a)(e)&&!e.length||Object(oe.a)(e,"image")?[]:["google_photos","pexels"]},ue={image:"images",audio:"audio",video:"videos"},pe=function(e){return Object(V.a)(e)&&e.length?e.map((function(e){return ue[e]})):void 0},me=s("./state/ui/actions/history.js"),he=s("./state/ui/actions/navigate.js"),fe=s("./state/route/actions.js"),be=s("./state/sites/actions.js"),ge=s("./state/selectors/get-current-route.js"),je=s("./state/sites/selectors/get-site-slug.js"),ve=s("./state/sites/selectors/is-single-user-site.js"),ye=function(e,t){var s=Object(v.a)(e),n=Object(je.a)(e,s),a=Object(X.a)(e,s),i=Object(ve.a)(e,s),r=Object(m.a)({page:"pages",post:"posts"},t,"types/".concat(t));return"post"!==t||a||i?"/".concat(r,"/trashed/").concat(n):"/".concat(r,"/my/trashed/").concat(n)},_e=s("./state/selectors/get-gutenberg-editor-url.js"),Ie=s("./state/selectors/get-selected-editor.js"),Oe=function(e,t){var s=Object(v.a)(e),n=Object(je.a)(e,s),a=Object(X.a)(e,s),i=Object(ve.a)(e,s),r=Object(m.a)({page:"pages",post:"posts"},t,"types/".concat(t));return"post"!==t||a||i?"/".concat(r,"/").concat(n):"/".concat(r,"/my/").concat(n)},xe=function(e){var t;return(null==e||null===(t=e.route)||void 0===t?void 0:t.lastNonEditorRoute)||""};var ke,Ee,we=s("./lib/wp/browser.js"),Se=s("./post-editor/editor-revisions/dialog.jsx"),Ce=s("./state/posts/revisions/actions.js"),Pe=s("./state/editor/actions.js"),Te=s("./state/desktop/actions.js"),Me=(s("./gutenberg/editor/style.scss"),function(){return u.a.createElement("div",{className:"editor__placeholder"},u.a.createElement("div",{className:"edit-post-layout"},u.a.createElement("div",{className:"edit-post-header"},u.a.createElement("div",{className:"edit-post-header-toolbar"},u.a.createElement("div",{className:"placeholder placeholder-site"},"Placeholder")),u.a.createElement("div",{className:"edit-post-header__settings"},u.a.createElement("div",{className:"placeholder placeholder-button"},"Placeholder"),u.a.createElement("div",{className:"placeholder placeholder-button"},"Placeholder"),u.a.createElement("div",{className:"placeholder placeholder-button"},"Placeholder"))),u.a.createElement("div",{className:"edit-post-layout__content"},u.a.createElement("div",{className:"edit-post-visual-editor editor-styles-wrapper"},u.a.createElement("div",{className:"editor-writing-flow"},u.a.createElement("div",{className:"editor-post-title"},u.a.createElement("div",{className:"placeholder placeholder-title wp-block editor-post-title__block"},"Placeholder")))))))}),De=s("./components/web-preview/index.jsx"),Ne=s("./state/posts/actions/edit-post.js"),Re=s("./state/posts/actions/trash-post.js"),Le=s("./state/editor/selectors.js"),Ae=s("./lib/protect-form/index.tsx"),Ue=s("./lib/analytics/page-view-tracker/index.jsx"),Ve=s("./config/index.js"),qe=s("./post-editor/editor-document-head/index.jsx"),Fe=s("./state/selectors/is-unlaunched-site.js"),ze=s("./lib/performance-tracking/index.ts"),Be=s("./state/desktop/window-events.js"),We=s("./state/editor-deprecation-group/selectors/in-editor-deprecation-group.js"),Ge=s("./state/media/actions.js"),He=s("./state/media/thunks/index.js");!function(e){e.Loaded="loaded",e.ClassicBlockOpenMediaModel="classicBlockOpenMediaModal"}(ke||(ke={})),function(e){e.GoToAllPosts="goToAllPosts",e.CloseEditor="closeEditor",e.OpenMediaModal="openMediaModal",e.OpenRevisions="openRevisions",e.PostStatusChange="postStatusChange",e.PreviewPost="previewPost",e.ViewPost="viewPost",e.SetDraftId="draftIdSet",e.TrashPost="trashPost",e.OpenCustomizer="openCustomizer",e.GetTemplateEditorUrl="getTemplateEditorUrl",e.OpenTemplatePart="openTemplatePart",e.GetCloseButtonUrl="getCloseButtonUrl",e.LogError="logError",e.GetGutenboardingStatus="getGutenboardingStatus",e.GetNavSidebarLabels="getNavSidebarLabels",e.GetCalypsoUrlInfo="getCalypsoUrlInfo",e.TrackPerformance="trackPerformance"}(Ee||(Ee={}));var Ye=function(e){M()(s,e);var t=N()(s);function s(){var e;E()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),L()(P()(e),"state",{isMediaModalVisible:!1,isIframeLoaded:!1,isPreviewVisible:!1,previewUrl:"about:blank",currentIFrameUrl:""}),L()(P()(e),"iframeRef",u.a.createRef()),L()(P()(e),"iframePort",null),L()(P()(e),"mediaSelectPort",null),L()(P()(e),"mediaCancelPort",null),L()(P()(e),"revisionsPort",null),L()(P()(e),"successfulIframeLoad",!1),L()(P()(e),"waitForIframeToInit",void 0),L()(P()(e),"waitForIframeToLoad",void 0),L()(P()(e),"onMessage",(function(t){var s=t.data,n=t.origin;if(s&&"gutenbergIframeMessage"===s.type&&(e.props.siteAdminUrl&&0===e.props.siteAdminUrl.indexOf(n))){var a=s.action;if(ke.Loaded===a&&e.iframeRef.current&&e.iframeRef.current.contentWindow){e.successfulIframeLoad=!0;var i=new window.MessageChannel,r=i.port1,o=i.port2;return e.iframePort=r,e.iframePort.addEventListener("message",e.onIframePortMessage,!1),e.iframePort.start(),e.iframeRef.current.contentWindow.postMessage({action:"initPort"},"*",[o]),e.pressThis(),void e.props.setEditorIframeLoaded()}if(ke.ClassicBlockOpenMediaModel===a){if(s.imageId){var c=e.props.siteId;e.props.setMediaLibrarySelectedItems(c,[{ID:s.imageId}])}e.setState({classicBlockEditorId:s.editorId,isMediaModalVisible:!0,multiple:!0})}}})),L()(P()(e),"onIframePortMessage",(function(t){var s=t.data,n=t.ports,a=s.action,i=s.payload;if(Ee.OpenMediaModal===a&&n&&n[0]){var r=e.props.siteId,o=i.allowedTypes,c=i.gallery,d=i.multiple,u=i.value;if(e.mediaSelectPort=n[0],e.mediaCancelPort=n[1],u){var p=(Array.isArray(u)?u.map((function(e){return parseInt(e,10)})):[parseInt(u,10)]).map((function(t){var s=e.props.getMediaItem(r,t);return s||e.props.fetchMediaItem(r,t),l()({ID:t},s)}));e.props.setMediaLibrarySelectedItems(r,p)}else e.props.setMediaLibrarySelectedItems(r,[]);e.setState({isMediaModalVisible:!0,allowedTypes:o,gallery:c,multiple:d})}if(Ee.SetDraftId===a&&!e.props.postId){var m=i.postId,h=e.props,f=h.siteId,b=h.currentRoute,g=h.postType;Object(U.a)(b,"/".concat(m))||(e.props.replaceHistory("".concat(b,"/").concat(m),!0),e.props.setRoute("".concat(b,"/").concat(m)),e.props.startEditingPost(f,m),e.props.editPost(f,m,{type:g}))}if(Ee.TrashPost===a){var j=e.props,v=j.siteId,y=j.editedPostId,_=j.postTypeTrashUrl;e.props.trashPost(v,y),e.props.navigate(_)}if(Ee.CloseEditor===a||Ee.GoToAllPosts===a){var I=i.unsavedChanges,O=void 0!==I&&I;e.props.setEditorIframeLoaded(!1),e.navigate(e.props.closeUrl,O)}if(Ee.OpenRevisions===a&&(n&&n[0]&&(e.revisionsPort=n[0]),e.props.openPostRevisionsDialog()),Ee.PreviewPost===a){var k=i.postUrl;e.openPreviewModal(k,n[0])}if(Ee.ViewPost===a){var E=i.postUrl;window.open(E,"_top")}if(Ee.OpenCustomizer===a){var w=i.autofocus,S=void 0===w?null:w,C=i.unsavedChanges,P=void 0!==C&&C;e.openCustomizer(S,P)}if(Ee.OpenTemplatePart===a){var T=i.templatePartId,M=i.unsavedChanges,D=e.getTemplateEditorUrl(T);e.navigate(D,M)}if(Ee.GetCloseButtonUrl===a){var N=e.props,R=N.closeUrl,L=N.closeLabel;n[0].postMessage({closeUrl:"".concat(window.location.origin).concat(R),label:L})}if(Ee.GetGutenboardingStatus===a){var A="gutenboarding"===e.props.siteCreationFlow&&e.props.isSiteUnlaunched,q="".concat(window.location.origin,"/start/new-launch?siteSlug=").concat(e.props.siteSlug,"&source=editor"),F=Ve.a.isEnabled("gutenboarding/new-launch");n[0].postMessage({isGutenboarding:A,frankenflowUrl:q,isNewLaunch:F})}if(Ee.GetNavSidebarLabels===a){var z=e.props.translate;n[0].postMessage({allPostsLabels:{page:z("View all pages"),post:z("View all posts")},createPostLabels:{page:z("Add new page"),post:z("Add new post")},listHeadings:{page:z("Recent Pages"),post:z("Recent Posts")}})}if(Ee.GetCalypsoUrlInfo===a&&n[0].postMessage({origin:window.location.origin,siteSlug:e.props.siteSlug}),Ee.LogError===a){var B=i.error;if(Object(V.a)(B)&&B.length>4&&window.onerror){var W,G=B[4];B[4]=G&&JSON.parse(G),(W=window).onerror.apply(W,x()(B))}}if(Ee.PostStatusChange===a){var H=i.status;e.handlePostStatusChange(H)}Ee.TrackPerformance===a&&"editor.ready"===i.mark&&e.props.stopPerformanceTracking({isNew:i.isNew,blockCount:i.blockCount})})),L()(P()(e),"handlePostStatusChange",(function(t){e.props.creatingNewHomepage&&"publish"===t&&e.setFrontPage()})),L()(P()(e),"setFrontPage",(function(){var t=e.props,s=t.editedPostId,n=t.siteId;e.props.updateSiteFrontPage(n,{show_on_front:"page",page_on_front:s})})),L()(P()(e),"loadRevision",(function(t){var s=t.post_title,n=t.post_excerpt,a=t.post_content;e.iframePort&&(e.revisionsPort?(e.revisionsPort.postMessage({title:s,excerpt:n,content:a}),e.revisionsPort.close(),e.revisionsPort=null):e.iframePort.postMessage({action:"loadRevision",payload:{title:s,excerpt:n,content:a}}))})),L()(P()(e),"closeMediaModal",(function(t){if(!e.state.classicBlockEditorId&&t&&e.mediaSelectPort){var s=e.state.multiple,n=Object(q.a)(t.items,(function(e){return le(e)})),a=s?n:n[0];e.mediaSelectPort.postMessage(a),e.mediaSelectPort.close(),e.mediaSelectPort=null}e.state.classicBlockEditorId||t||!e.mediaCancelPort||(e.mediaCancelPort.postMessage(!0),e.mediaCancelPort.close(),e.mediaCancelPort=null),e.setState({classicBlockEditorId:null,isMediaModalVisible:!1})})),L()(P()(e),"insertClassicBlockMedia",(function(t){e.state.classicBlockEditorId&&e.iframePort&&e.iframePort.postMessage({action:"insertClassicBlockMedia",payload:{editorId:e.state.classicBlockEditorId,media:t}})})),L()(P()(e),"pressThis",(function(){var t=e.props.pressThis;t&&e.iframePort&&e.iframePort.postMessage({action:"pressThis",payload:t})})),L()(P()(e),"updateImageBlocks",(function(t){if(e.iframePort&&t&&Object(F.a)(t.data.mime_type,"image/")&&!Object(F.a)(t.data.URL,"blob:")){var s={id:Object(m.a)(t,"data.ID"),height:Object(m.a)(t,"data.height"),status:"REMOVE_MEDIA_ITEM"===t.type?"deleted":"updated",transientId:Object(m.a)(t,"id"),url:Object(m.a)(t,"data.URL"),width:Object(m.a)(t,"data.width")};e.iframePort.postMessage({action:"updateImageBlocks",payload:s})}})),L()(P()(e),"openPreviewModal",(function(t,s){e.setState({isPreviewVisible:!0,previewUrl:"about:blank",postUrl:t}),s.onmessage=function(t){s.close();var n=e.props,a=n.frameNonce,i=n.unmappedSiteUrl,r=t.data,o=r.previewUrl,c=r.editedPost,l=H.a.parse(o,!0);a&&(l.query["frame-nonce"]=a),l.query.iframe="true",delete l.search;var d=H.a.parse(i).host;d&&(l.host=d,l.hostname=d),e.setState({previewUrl:H.a.format(l),editedPost:c})}})),L()(P()(e),"closePreviewModal",(function(){return e.setState({isPreviewVisible:!1})})),L()(P()(e),"openCustomizer",(function(t,s){var n=e.props.customizerUrl;if(t){var a=I()(Object.entries(t)[0],2),i=a[0],r=a[1];n=Object(ne.a)(L()({},"autofocus[".concat(i,"]"),r),n)}e.navigate(n,s)})),L()(P()(e),"getTemplateEditorUrl",(function(t){var s=e.props,n=s.getTemplateEditorUrl,a=s.editedPostId,i=n(t);return a&&(i=Object(ne.a)({fse_parent_post:a},i)),i})),L()(P()(e),"navigate",(function(t,s){var n=e.props,a=n.markChanged,i=n.markSaved;s?a():i(),e.props.navigate(t)})),L()(P()(e),"getStatsPath",(function(){return e.props.postId?"/block-editor/:post_type/:site/:post_id":"/block-editor/:post_type/:site"})),L()(P()(e),"getStatsProps",(function(){var t=e.props,s=t.postId,n=t.postType;return s?{post_type:n,post_id:s}:{post_type:n}})),L()(P()(e),"getStatsTitle",(function(){var t,s=e.props,n=s.postId;switch(s.postType){case"post":t="Post";break;case"page":t="Page";break;default:t="Custom Post Type"}return"Block Editor > ".concat(t,n?" > Edit":" > New")})),L()(P()(e),"onIframeLoaded",function(){var t=o()(regeneratorRuntime.mark((function t(s){var n,a,i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(clearTimeout(e.waitForIframeToLoad),e.successfulIframeLoad){t.next=11;break}return a=new Promise((function(t){n=setInterval((function(){return e.successfulIframeLoad&&t("iframe-loaded")}),200)})),i=new Promise((function(e){return setTimeout(e,5e3,"timeout")})),t.next=6,Promise.race([a,i]);case 6:if(r=t.sent,clearInterval(n),"timeout"!==r){t.next=11;break}return window.location.replace(s),t.abrupt("return");case 11:e.setState({isIframeLoaded:!0,currentIFrameUrl:s});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e}return S()(s,[{key:"componentDidMount",value:function(){var e=this;K.a.on("change",this.updateImageBlocks),window.addEventListener("message",this.onMessage,!1);var t=Ve.a.isEnabled("desktop");this.waitForIframeToInit=setInterval((function(){e.props.shouldLoadIframe&&(clearInterval(e.waitForIframeToInit),e.waitForIframeToLoad=setTimeout((function(){t?e.props.notifyDesktopCannotOpenEditor(e.props.site,Be.g,e.props.iframeUrl):window.location.replace(e.props.iframeUrl)}),25e3))}),1e3),window.sessionStorage.getItem("a8c-clearLastNonEditorRoute")&&(window.sessionStorage.removeItem("a8c-clearLastNonEditorRoute"),this.props.clearLastNonEditorRoute())}},{key:"componentWillUnmount",value:function(){K.a.off("change",this.updateImageBlocks),window.removeEventListener("message",this.onMessage,!1)}},{key:"render",value:function(){var e=this,t=this.props,s=t.iframeUrl,n=t.shouldLoadIframe,a=this.state,i=a.classicBlockEditorId,r=a.isMediaModalVisible,o=a.allowedTypes,c=a.multiple,l=a.isIframeLoaded,p=a.isPreviewVisible,m=a.previewUrl,h=a.postUrl,f=a.editedPost,b=a.currentIFrameUrl,g=!!i;return u.a.createElement(d.Fragment,null,u.a.createElement(Ue.a,{path:this.getStatsPath(),title:this.getStatsTitle(),properties:this.getStatsProps()}),u.a.createElement(qe.a,null),u.a.createElement("div",{className:"main main-column calypsoify is-iframe",role:"main"},!l&&u.a.createElement(Me,null),(n||l)&&u.a.createElement("iframe",{ref:this.iframeRef,src:l?b:s,onLoad:function(){e.onIframeLoaded(s)}})),u.a.createElement(Q.a,{disabledDataSources:de(o),enabledFilters:pe(o),galleryViewEnabled:g,isGutenberg:!g,onClose:this.closeMediaModal,onInsertMedia:this.insertClassicBlockMedia,single:!c,source:"",visible:r}),u.a.createElement(Se.a,{loadRevision:this.loadRevision}),u.a.createElement(De.a,{externalUrl:h,onClose:this.closePreviewModal,overridePost:f,previewUrl:m,showEditHeaderLink:!0,showPreview:p}))}}]),s}(d.Component),Ke={replaceHistory:me.a,setRoute:fe.b,navigate:he.a,openPostRevisionsDialog:Ce.b,setEditorIframeLoaded:Pe.l,startEditingPost:Pe.o,notifyDesktopViewPostClicked:Te.c,editPost:Ne.a,trashPost:Re.a,updateSiteFrontPage:be.h,notifyDesktopCannotOpenEditor:Te.a,setMediaLibrarySelectedItems:Ge.o,fetchMediaItem:He.f,getMediaItem:He.h,clearLastNonEditorRoute:fe.a},Qe=Object(W.a)(ze.d,Object(A.c)((function(e,t){var s=t.postId,n=t.postType,a=t.duplicatePostId,i=t.fseParentPageId,r=t.parentPostId,o=t.creatingNewHomepage,c=t.editorType,l=void 0===c?"post":c,d=Object(v.a)(e),u=Object(y.a)(e),p=Object(ge.a)(e),m=ye(e,n),h=Object(X.a)(e,d)?"jetpack_frame_nonce":"frame_nonce",f=Object(z.a)({post:s,action:s&&"edit",post_type:"post"!==n&&n,calypsoify:1,fse_parent_post:null!=i&&i,parent_post:null!=r&&r,"block-editor":1,"frame-nonce":Object($.a)(e,d,h)||"","jetpack-copy":a,origin:window.location.origin,"environment-id":Object(Ve.a)("env_id"),"new-homepage":o});we.a.addSupportParams&&(f=we.a.addSupportParams(f)),Object(We.a)(e)&&"classic"===Object(Ie.b)(e,d)&&(f["in-editor-deprecation-group"]=1);var b="site"===l?Object(J.a)(e,d,"admin.php?page=gutenberg-edit-site"):Object(J.a)(e,d,s?"post.php":"post-new.php"),g=Object(ne.a)(f,b),j=!Object(Z.a)(e)&&!Object(ee.a)(e,d),_=function(e,t,s,n){if("wp_template_part"===s&&n)return{url:Object(_e.a)(e,t,n,"page")};var a=xe(e),i=function(e){return a.match(e)};if(i(/^\/themes\/?/))return{url:"/themes/".concat(Object(je.a)(e,t)),label:Object(Y.f)("Themes")};if(!a||!s||i(/^\/home\/?/))return{url:"/home/".concat(Object(je.a)(e,t)),label:Object(Y.f)("My Home")};var r=Object(Y.f)("Back");return"post"===s?r=Object(Y.f)("View Posts"):"page"===s&&(r=Object(Y.f)("View Pages")),{url:Oe(e,s),label:r}}(e,d,n,i);return{closeUrl:_.url,closeLabel:_.label,currentRoute:p,editedPostId:Object(Le.f)(e),frameNonce:Object($.a)(e,d,"frame_nonce")||"",iframeUrl:g,postTypeTrashUrl:m,shouldLoadIframe:j,siteAdminUrl:b,siteId:d,siteSlug:u,customizerUrl:Object(te.a)(e,d),getTemplateEditorUrl:Object(B.a)(_e.a,e,d,B.a.placeholder,"wp_template_part"),unmappedSiteUrl:Object($.a)(e,d,"unmapped_url"),siteCreationFlow:Object($.a)(e,d,"site_creation_flow"),isSiteUnlaunched:Object(Fe.a)(e,d),site:Object(se.a)(e,d),parentPostId:r}}),Ke),Y.c,Ae.c)(Ye),Xe=s("./state/selected-editor/actions.js"),$e=s("./state/selectors/get-raw-site.js");var Je=s("./state/sites/selectors/get-site-url.js"),Ze=s("./state/selectors/is-site-wpcom-atomic.js"),et=s("./controller/index.web.js"),tt=s("./state/selectors/is-site-using-core-site-editor.js"),st=s("./state/selectors/get-site-editor-url.js");function nt(e){return e.path.startsWith("/block-editor/post/")?"post":e.path.startsWith("/block-editor/page/")?"page":e.params.customPostType}function at(e){if(!e.params.post||"new"===e.params.post)return null;if("home"===e.params.post){var t=e.store.getState(),s=Object(v.a)(t);return parseInt(Object($.a)(t,s,"page_on_front"),10)}return parseInt(e.params.post,10)}function it(e){return new Promise((function(t){var s=e.store.subscribe((function(){var n=e.store.getState(),a=Object(v.a)(n);a&&(Object(Ie.b)(n,a)&&(s(),t()))}));e.store.dispatch(Object(Xe.a)(Object(v.a)(e.store.getState())))}))}var rt=function(e,t){var s=e.store.getState(),n=Object(v.a)(s),a=Object(Ve.c)("desktop"),i="gutenframe_".concat(n,"_is_authenticated"),r=globalThis.sessionStorage.getItem(i)||!Object(Ze.a)(s,n)||a||e.query.authWpAdmin;if(a&&Object(X.a)(s,n)&&!function(e,t){var s,n,a=Object($e.a)(e,t);return a?null==a||null===(s=a.options)||void 0===s||null===(n=s.active_modules)||void 0===n?void 0:n.includes("sso"):null}(s,n)&&(r=!1),r)return globalThis.sessionStorage.setItem(i,"true"),t();e.primary=u.a.createElement(Me,null),Object(et.c)(e,p.a),Object(et.f)(e);var o="".concat(window.location.protocol,"//").concat(window.location.hostname);window.location.port&&(o+=":".concat(window.location.port));var c=Object(ne.a)(l()(l()({},e.query),{},{authWpAdmin:!0}),"".concat(o).concat(e.path)),d=Object(Je.a)(s,n),m=Object(ne.a)({redirect_to:c},"".concat(d,"/wp-login.php"));a?e.store.dispatch(Object(Te.a)(Object(se.a)(s,n),Be.f,e.path,m)):window.location.replace(m)},ot=function(){var e=o()(regeneratorRuntime.mark((function e(t,s){var n,i,r,o,c,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.store.getState,i=n(),Object(Ie.b)(i,Object(v.a)(i))){e.next=6;break}return e.next=6,it(t);case 6:if(r=n(),o=Object(v.a)(r),!Object(g.a)(r,o)){e.next=13;break}return c=nt(t),l=at(t),d=c||!Object(tt.a)(r,o)?Object(_e.a)(r,o,l,c):Object(st.a)(r,o),e.abrupt("return",window.location.replace(Object(ne.a)(t.query,d)));case 13:if(!Object(b.a)(r,o)){e.next=15;break}return e.abrupt("return",s());case 15:return e.abrupt("return",a.a.redirect("/post/".concat(Object(y.a)(r))));case 16:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}();var ct=function(e,t){var s,n,a,i,r,o,c=at(e),l=nt(e),d=parseInt(Object(m.a)(e,"query.jetpack-copy",null)),p=Object(h.a)(d)?d:null,b=e.store.getState(),g=Object(v.a)(b),y=(s=e.query,n=s.text,a=s.url,i=s.title,r=s.image,o=s.embed,a?{text:n,url:a,title:i,image:r,embed:o}:null),_=parseInt(e.query.fse_parent_post,10)||null,I=parseInt(e.query.parent_post,10)||null;return e.store.dispatch({type:j.Td,siteId:g,postId:c}),e.store.dispatch({type:j.um,post:{type:l},siteId:g,postId:c}),e.primary=u.a.createElement(Qe,{key:c,postId:c,postType:l,duplicatePostId:p,pressThis:y,fseParentPageId:_,parentPostId:I,creatingNewHomepage:"page"===l&&Object(f.a)(e,"query.new-homepage")}),t()},lt=function(e,t){var s=e.store.getState(),n=Object(v.a)(s);return e.primary=u.a.createElement(Qe,{key:n,editorType:"site"}),t()};t.default=function(){a()("/block-editor","/block-editor/post"),a()("/site-editor/:site?",i.e,ot,rt,lt,et.c,et.f),a()("/block-editor/post",i.e,i.f,et.c,et.f),a()("/block-editor/post/:site/:post?",i.e,ot,rt,ct,et.c,et.f),a()("/block-editor/post/:site?",i.e,ot,et.c,et.f),a()("/block-editor/page",i.e,i.f,et.c,et.f),a()("/block-editor/page/:site/:post?",i.e,ot,rt,ct,et.c,et.f),a()("/block-editor/page/:site?",i.e,ot,et.c,et.f),Ve.a.isEnabled("manage/custom-post-types")&&(a()("/block-editor/edit/:customPostType",i.e,i.f,et.c,et.f),a()("/block-editor/edit/:customPostType/:site/:post?",i.e,ot,rt,ct,et.c,et.f),a()("/block-editor/edit/:customPostType/:site?",i.e,ot,et.c,et.f)),a()("/block-editor/*/*","/block-editor/post"),a()("/block-editor/:site",(function(e){return a.a.redirect("/block-editor/post/".concat(e.params.site))}))}},"./gutenberg/editor/style.scss":function(e,t,s){},"./layout/guided-tours/tours/checklist-site-title-tour/meta.js":function(e,t,s){"use strict";var n=s("./layout/guided-tours/utils.js");t.a={name:"checklistSiteTitle",version:"20171205",path:"/non-existent-route",when:n.b}},"./layout/guided-tours/tours/editor-basics-tour/meta.js":function(e,t,s){"use strict";var n=s("../packages/viewport/dist/esm/index.js"),a=s("./layout/guided-tours/utils.js"),i=s("./state/guided-tours/contexts/new-user.js"),r=s("./state/current-user/selectors.js");t.a={name:"editorBasicsTour",version:"20170503",path:["/post/","/page/"],when:Object(a.a)(n.d,i.b,r.n)}},"./layout/guided-tours/tours/gdocs-integration-tour/meta.js":function(e,t,s){"use strict";var n=s("./layout/guided-tours/utils.js"),a=s("./state/action-types.js"),i=s("./components/tinymce/plugins/wpcom-track-paste/sources.js"),r=s("./state/ui/action-log/selectors.js"),o=s("./state/current-user/selectors.js");t.a={name:"gdocsIntegrationTour",version:"20170227",path:"/post",when:Object(n.a)(o.n,(function(e){var t=Object(r.b)(e)||!1;return t&&t.type===a.Nd&&t.source===i.a}))}},"./layout/guided-tours/tours/jetpack-backups-rewind-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackBackupsRewind",version:"20190409"}},"./layout/guided-tours/tours/jetpack-checklist-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackChecklistTour",version:"20190527"}},"./layout/guided-tours/tours/jetpack-lazy-images-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackLazyImages",version:"20190607"}},"./layout/guided-tours/tours/jetpack-monitoring-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackMonitoring",version:"20180611"}},"./layout/guided-tours/tours/jetpack-plugin-updates-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackPluginUpdates",version:"20180611"}},"./layout/guided-tours/tours/jetpack-search-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackSearch",version:"20190609"}},"./layout/guided-tours/tours/jetpack-sign-in-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackSignIn",version:"20180704"}},"./layout/guided-tours/tours/jetpack-site-accelerator-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackSiteAccelerator",version:"20190609"}},"./layout/guided-tours/tours/jetpack-video-hosting-tour/meta.js":function(e,t,s){"use strict";t.a={name:"jetpackVideoHosting",version:"20190609"}},"./layout/guided-tours/tours/main-tour/meta.js":function(e,t,s){"use strict";var n=s("./layout/guided-tours/utils.js"),a=s("./state/guided-tours/contexts/new-user.js"),i=s("./state/guided-tours/contexts/is-enabled.js");t.a={name:"main",version:"20160601",path:"/",when:Object(n.a)(a.b,Object(i.a)("guided-tours/main"))}},"./layout/guided-tours/tours/marketing-connections-tour/meta.js":function(e,t,s){"use strict";t.a={name:"marketingConnectionsTour",version:"20200410"}},"./layout/guided-tours/tours/media-basics-tour/meta.js":function(e,t,s){"use strict";var n=s("../packages/viewport/dist/esm/index.js"),a=s("./layout/guided-tours/utils.js"),i=s("./state/guided-tours/contexts/new-user.js");t.a={name:"mediaBasicsTour",version:"20170321",path:"/media",when:Object(a.a)(n.d,i.b)}},"./layout/guided-tours/tours/simple-payments-email-tour/meta.js":function(e,t,s){"use strict";var n=s("./layout/guided-tours/utils.js");t.a={name:"simplePaymentsEmailTour",version:"20180501",path:"/",when:n.b}},"./layout/guided-tours/tours/simple-payments-tour/meta.js":function(e,t,s){"use strict";var n=s("../packages/viewport/dist/esm/index.js"),a=s("./layout/guided-tours/utils.js"),i=s("./state/guided-tours/contexts/new-user.js"),r=s("./state/current-user/selectors.js");t.a={name:"simplePaymentsTour",version:"20170816",path:"/post/",when:Object(a.a)(n.d,i.c,r.n)}},"./layout/guided-tours/tours/tutorial-site-preview-tour/meta.js":function(e,t,s){"use strict";var n=s("./layout/guided-tours/utils.js"),a=s("./state/guided-tours/contexts/is-enabled.js"),i=s("./state/guided-tours/contexts/is-selected-site-previewable.js"),r=s("./state/guided-tours/contexts/new-user.js");t.a={name:"tutorialSitePreview",version:"20170101",path:"/stats",when:Object(n.a)(Object(a.a)("guided-tours/tutorial-site-preview"),i.a,r.b)}},"./layout/guided-tours/utils.js":function(e,t,s){"use strict";var n=s("../node_modules/lodash-es/overEvery.js");s.d(t,"a",(function(){return n.a}));var a=s("../node_modules/lodash-es/negate.js");s.d(t,"c",(function(){return a.a}));var i=s("../node_modules/lodash-es/noop.js");s.d(t,"b",(function(){return i.a}))},"./lib/accept/dialog.scss":function(e,t,s){},"./lib/accept/index.js":function(e,t,s){"use strict";var n=s("../node_modules/react-dom/index.js"),a=s.n(n),i=s("../node_modules/react/index.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createClass.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/inherits.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/createSuper.js"),b=s.n(f),g=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),j=s.n(g),v=s("../node_modules/prop-types/index.js"),y=s.n(v),_=s("../packages/i18n-calypso/dist/esm/index.js"),I=s("../node_modules/classnames/index.js"),O=s.n(I),x=s("../packages/components/dist/esm/dialog/index.js"),k=(s("./lib/accept/dialog.scss"),function(e){h()(s,e);var t=b()(s);function s(){var e;c()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),j()(p()(e),"state",{isVisible:!0}),j()(p()(e),"onClose",(function(t){e.setState({isVisible:!1}),e.props.onClose("accept"===t)})),j()(p()(e),"getActionButtons",(function(){var t=e.props.options,s=t&&t.isScary,n=O()({"is-scary":s});return[{action:"cancel",label:e.props.cancelButtonText?e.props.cancelButtonText:e.props.translate("Cancel"),additionalClassNames:"is-cancel"},{action:"accept",label:e.props.confirmButtonText?e.props.confirmButtonText:e.props.translate("OK"),isPrimary:!0,additionalClassNames:n}]})),e}return d()(s,[{key:"render",value:function(){return this.state.isVisible?r.a.createElement(x.a,{buttons:this.getActionButtons(),onClose:this.onClose,className:"accept__dialog",isVisible:!0},this.props.message):null}}]),s}(i.Component));j()(k,"displayName","AcceptDialog"),j()(k,"propTypes",{translate:y.a.func,message:y.a.node,onClose:y.a.func.isRequired,confirmButtonText:y.a.node,cancelButtonText:y.a.node,options:y.a.object});var E=Object(_.c)(k);t.a=function(e,t,s,n,i){var o=document.createElement("div");document.body.appendChild(o),a.a.render(r.a.createElement(E,{message:e,onClose:function(e){o&&(a.a.unmountComponentAtNode(o),document.body.removeChild(o),o=null),t&&t(e)},confirmButtonText:s,cancelButtonText:n,options:i}),o)}},"./lib/analytics/page-view-tracker/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/debug/src/browser.js"),b=s.n(f),g=s("../node_modules/prop-types/index.js"),j=s.n(g),v=s("../node_modules/react/index.js"),y=s.n(v),_=s("../node_modules/lodash-es/noop.js"),I=s("../node_modules/lodash-es/get.js"),O=s("../node_modules/lodash-es/isNumber.js"),x=s("../node_modules/react-redux/es/index.js"),k=s("./lib/route/path.ts"),E=s("./state/analytics/actions/record-with-client-id.js"),w=s("./state/analytics/actions/enhance-with-site-type.js"),S=s("./state/utils/with-enhancers.js"),C=s("./state/ui/selectors/get-selected-site-id.js"),P=s("./state/sites/selectors/get-site-slug.js"),T=b()("calypso:analytics:PageViewTracker"),M=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{timer:null}),h()(c()(e),"queuePageView",(function(){var t=e.props,s=t.delay,n=void 0===s?0:s,a=t.path,i=t.recorder,r=void 0===i?_.a:i,o=t.hasSelectedSiteLoaded,c=t.title,l=t.properties;if(T('Queuing Page View: "'.concat(c,'" at "').concat(a,'" with ').concat(n,"ms delay")),o&&!e.state.timer)return n?void e.setState({timer:setTimeout((function(){return r(a,c)}),n)}):r(a,c,"default",l)})),e}return r()(s,[{key:"componentDidMount",value:function(){T("Component has mounted."),this.queuePageView()}},{key:"componentWillUnmount",value:function(){T("Component has unmounted."),clearTimeout(this.state.timer)}},{key:"componentDidUpdate",value:function(e){e.path===this.props.path&&e.selectedSiteId===this.props.selectedSiteId||this.queuePageView()}},{key:"render",value:function(){return null}}]),s}(y.a.Component);h()(M,"displayName","PageViewTracker"),h()(M,"propTypes",{delay:j.a.number,path:j.a.string.isRequired,recorder:j.a.func,hasSelectedSiteLoaded:j.a.bool,selectedSiteId:j.a.number,title:j.a.string.isRequired,properties:j.a.object});var D={recorder:Object(S.a)(E.a,[w.a])};t.a=Object(x.c)((function(e){var t=Object(C.a)(e),s=Object(P.a)(e,t),n="undefined"==typeof window?"":Object(k.d)(Object(I.a)(window,"location.pathname",""));return{hasSelectedSiteLoaded:!n||Object(O.a)(n)&&n===t||n===s,selectedSiteId:t}}),D)(M)},"./lib/analytics/track-component-view/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/debug/src/browser.js"),h=s.n(m),f=s("../node_modules/prop-types/index.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s("../node_modules/react-redux/es/index.js"),v=s("./state/analytics/actions/bump-stat.js"),y=s("./state/analytics/actions/record.js"),_=h()("calypso:analytics:TrackComponentView"),I=function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"UNSAFE_componentWillMount",value:function(){_("Component will mount.");var e=this.props,t=e.eventName,s=e.eventProperties;t&&(_('Recording Tracks event "'.concat(t,'".')),this.props.recordTracksEvent(t,s));var n=this.props,a=n.statGroup,i=n.statName;a&&(_('Bumping stat "'.concat(i,'".')),this.props.bumpStat(a,i))}},{key:"render",value:function(){return null}}]),s}(g.Component);p()(I,"propTypes",{eventName:b.a.string,eventProperties:b.a.object,recordTracksEvent:b.a.func,bumpStat:b.a.func}),p()(I,"defaultProps",{recordTracksEvent:function(){},bumpStat:function(){}}),t.a=Object(j.c)(null,{bumpStat:v.a,recordTracksEvent:y.e})(I)},"./lib/build-url/index.ts":function(e,t,s){"use strict";function n(e,t){var s=new URL(e,"http://dummy.example");return t?s.searchParams.set("s",t):s.searchParams.delete("s"),"".concat(s.pathname).concat(s.search).concat(s.hash).replace(/%20/g,"+")}s.d(t,"a",(function(){return n}))},"./lib/embed-frame-markup/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s("../node_modules/react/index.js"),a=s.n(n),i=s("../node_modules/react-dom/server.browser.js"),r=s("../node_modules/lodash-es/map.js"),o=s("../node_modules/lodash-es/flatMap.js"),c="https://s0.wp.com/wp-includes/js/jquery/jquery.js";function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.body,s=e.scripts,n=e.styles;return t||s||n?Object(i.renderToStaticMarkup)(a.a.createElement("html",null,a.a.createElement("head",null,Object(r.a)(n,(function(e,t){var s=e.media,n=e.src;return a.a.createElement("link",{key:t,rel:"stylesheet",media:s,href:n})})),a.a.createElement("style",{dangerouslySetInnerHTML:{__html:"a { cursor: default; }"}})),a.a.createElement("body",{style:{margin:0}},a.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}}),a.a.createElement("script",{src:c}),a.a.createElement("script",{dangerouslySetInnerHTML:{__html:"\n\t\t\t\t\t[ 'click', 'dragstart' ].forEach( function( type ) {\n\t\t\t\t\t\tdocument.addEventListener( type, function( event ) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t\t\t}, true );\n\t\t\t\t\t} );\n\t\t\t\t"}}),Object(o.a)(s,(function(e,t){var s=e.extra,n=e.src;return[s?a.a.createElement("script",{key:t+"-extra",dangerouslySetInnerHTML:{__html:s}}):null,a.a.createElement("script",{key:t,src:n})]}))))):""}},"./lib/human-date/index.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("../packages/i18n-calypso/dist/esm/index.js"),a=s("../node_modules/moment/moment.js"),i=s.n(a);function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ll",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.a.getLocaleSlug(),a=i()().locale(s);e=i()(e).locale(s);var r=a.diff(e);if(r<0&&(r=0),r<6e4)return n.a.translate("just now");if(r<36e5){var o=Math.ceil(r/6e4);return n.a.translate("%(minutes)dm ago",{args:{minutes:o},comment:"example for a resulting string: 2m ago"})}if(r<864e5){var c=a.diff(e,"hours");return n.a.translate("%(hours)dh ago",{args:{hours:c},comment:"example for a resulting string: 5h ago"})}if(r<6048e5){var l=a.diff(e,"days");return n.a.translate("%(days)dd ago",{args:{days:l},comment:"example for a resulting string: 4d ago"})}return e.format(t)}},"./lib/interval/index.ts":function(e,t,s){"use strict";s.d(t,"e",(function(){return a})),s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return r})),s.d(t,"d",(function(){return o})),s.d(t,"b",(function(){return c}));var n=s("./lib/interval/use-interval.ts"),a=function(e){return Object(n.a)(e.onTick,e.period),null},i=1e3,r=5e3,o=1e4,c=6e4},"./lib/interval/use-interval.ts":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("../node_modules/react/index.js");function a(e,t){var s=Object(n.useRef)(e);Object(n.useEffect)((function(){s.current=e}),[e]),Object(n.useEffect)((function(){if(null!==t&&!1!==t){var e=setInterval((function(){s.current()}),t);return function(){return clearInterval(e)}}}),[t])}},"./lib/media-serialization/index.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return V}));var n={};s.r(n),s.d(n,"deserialize",(function(){return O}));var a={};s.r(a),s.d(a,"deserialize",(function(){return S}));var i={};s.r(i),s.d(i,"deserialize",(function(){return D}));var r={};s.r(r),s.d(r,"deserialize",(function(){return N}));var o={};s.r(o),s.d(o,"deserialize",(function(){return L}));var c={};s.r(c),s.d(c,"deserialize",(function(){return A}));var l=s("../node_modules/lodash-es/includes.js"),d="DOM",u="STRING",p="SHORTCODE",m="OBJECT",h="API",f="UNKNOWN",b={IMAGE:"IMAGE",VIDEO:"VIDEO",AUDIO:"AUDIO",UNKNOWN:"UNKNOWN"},g=s("./lib/media/utils/get-mime-prefix.js"),j=["closed","self-closing","single"],v=/\bsize-(\w+)\b/,y=/\bwp-image-((media-)?\d+)\b/,_=/\balign(left|center|right|none)\b/;function I(e,t){return t.type=b.IMAGE,t.media.URL=e.getAttribute("src"),t.media.alt=e.getAttribute("alt"),t.media.transient=e.hasAttribute("data-istransient"),["width","height"].forEach((function(s){var n="natural"+s[0].toUpperCase()+s.slice(1),a=e.getAttribute(s)||e[n]||e[s];a&&isFinite(a)&&(t.media[s]=parseInt(a,10))})),v.test(e.className)&&(t.appearance.size=e.className.match(v)[1]),_.test(e.className)&&(t.appearance.align=e.className.match(_)[1]),y.test(e.className)&&(t.media.ID=e.className.match(y)[1],isFinite(t.media.ID)&&(t.media.ID=parseInt(t.media.ID,10))),t}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{media:{},appearance:{}};switch(e.nodeName){case"IMG":t=I(e,t)}return t}var x=s("./lib/shortcode/index.js"),k=s("./lib/post-normalizer/utils/dom-for-html.js");function E(e,t){var s=Object(x.b)(e);return s?V(s,t):t}function w(e,t){var s=function(e){var t;if(document.implementation&&document.implementation.createHTMLDocument)t=document.implementation.createHTMLDocument("").body;else try{return Object(k.a)(e).firstChild}catch(e){}return(t=t||document.createElement("div")).innerHTML=e,t.firstChild}(e);return s instanceof window.Element?V(s,t):t}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{media:{},appearance:{}};return[E,w].reduce((function(s,n){return Object.assign(s,n(e,t))}),{})}var C=/((?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?)([\s\S]*)/i,P=/attachment_(\d+)/,T=/align(\w+)/;function M(e,t){if(e.attrs&&e.attrs.named&&(T.test(e.attrs.named.align)&&(t.appearance.align=e.attrs.named.align.match(T)[1]),P.test(e.attrs.named.id)&&(t.media.ID=parseInt(e.attrs.named.id.match(P)[1],10)),t.media.width&&isFinite(e.attrs.named.width)&&(t.media.width=parseInt(e.attrs.named.width,10))),!e.content)return t;var s=e.content.match(C);return s&&s[2]&&(t.media.caption=s[2].trim()),s?V(s[1],t):t}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{media:{},appearance:{}};switch(e.tag){case"caption":t=M(e,t)}return t}function N(e){return e}var R=s("../node_modules/lodash-es/assign.js");function L(e){var t={media:Object(R.a)({transient:!1},e),appearance:{}};switch(Object(g.a)(e)){case"image":t.type=b.IMAGE;break;case"audio":t.type=b.AUDIO;break;case"video":t.type=b.VIDEO}return t}function A(){return{type:b.UNKNOWN,media:{},appearance:{}}}var U={dom:n,string:a,shortcode:i,object:r,api:o,unknown:c};function V(e,t){var s=function(e){return"string"==typeof e?u:"object"==typeof e&&"string"==typeof e.nodeName?d:e&&e.tag&&Object(l.a)(j,e.type)?p:e&&e.type&&Object(l.a)(b,e.type)?m:Object(g.a)(e)?h:f}(e);return U[s.toLowerCase()].deserialize(e,t)}},"./lib/media/actions.js":function(e,t,s){"use strict";var n=s("./dispatcher/index.js"),a={_fetching:{},setQuery:function(e,t){n.a.handleViewAction({type:"SET_MEDIA_QUERY",siteId:e,query:t})}};t.a=a},"./lib/media/store.js":function(e,t,s){"use strict";var n=s("../node_modules/lodash-es/values.js"),a=s("./lib/media/utils/is-item-being-uploaded.js"),i=s("./dispatcher/index.js"),r=s("./lib/mixins/emitter/index.js"),o={_media:{},_pointers:{}};function c(e,t,s){if(e in o._media||(o._media[e]={}),s){e in o._pointers||(o._pointers[e]={}),o._pointers[e][s]=t.ID;var n=o._media[e][s];Object(a.a)(n)&&(t.description=n.description,t.alt=n.alt,t.caption=n.caption),delete o._media[e][s]}o._media[e][t.ID]=t}function l(e,t){e in o._media&&(o._media[e][t.ID]={ID:t.ID,status:t.status})}Object(r.a)(o),o.get=function(e,t){if(e in o._media)return e in o._pointers&&t in o._pointers[e]?o.get(e,o._pointers[e][t]):o._media[e][t]},o.getAll=function(e){if(e in o._media)return Object(n.a)(o._media[e])},o.dispatchToken=i.a.register((function(e){var t,s=e.action;switch(s.type){case"CREATE_MEDIA_ITEM":case"RECEIVE_MEDIA_ITEM":case"RECEIVE_MEDIA_ITEMS":if(s.error&&s.siteId&&s.id&&(l(s.siteId,{ID:s.id}),o.emit("change")),s.error||!s.siteId||!s.data)break;Array.isArray(s.data.media)?(t=s.siteId,s.data.media.forEach((function(e){c(t,e)}))):c(s.siteId,s.data,s.id),o.emit("change","RECEIVE_MEDIA_ITEM"===s.type&&s);break;case"REMOVE_MEDIA_ITEM":if(!s.siteId||!s.data)break;s.error?c(s.siteId,s.data):l(s.siteId,s.data),o.emit("change","deleted"===s.data.status&&s);break;case"FETCH_MEDIA_ITEM":if(!s.siteId||!s.id)break;c(s.siteId,{ID:s.id}),o.emit("change")}})),t.a=o},"./lib/media/utils/filter-items-by-mime-prefix.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("./lib/media/utils/get-mime-prefix.js");function a(e,t){return e.filter((function(e){return Object(n.a)(e)===t}))}},"./lib/media/utils/generate-gallery-shortcode.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("../node_modules/lodash-es/includes.js"),a=s("../node_modules/lodash-es/omitBy.js"),i=s("./lib/media/constants.js"),r=s("./lib/shortcode/index.js");function o(e){var t;if(e.items.length)return delete(t=Object.assign({ids:e.items.map((function(e){return e.ID})).join()},e)).items,Object(n.a)(i.a,t.type)||delete t.columns,Object(n.a)(i.c,t.type)||delete t.size,(t=Object(a.a)(t,(function(e,t){return i.b[t]===e}))).orderBy&&(t.orderby=t.orderBy,delete t.orderBy),Object(r.c)({tag:"gallery",type:"single",attrs:t})}},"./lib/media/utils/get-allowed-file-types-for-site.js":function(e,t,s){"use strict";function n(e){return e?e.options.allowed_file_types:[]}s.d(t,"a",(function(){return n}))},"./lib/media/utils/get-file-extension.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("./node_modules/path-browserify/index.js"),a=s.n(n),i=s("../node_modules/valid-url/index.js"),r=s("./lib/url/url-parts.ts");function o(e){var t;if(e){var s,n="string"==typeof e,o="File"in window&&e instanceof window.File;if(n)s=Object(i.isUri)(e)?Object(r.b)(e).pathname:e,t=a.a.extname(s).slice(1);else if(o)t=a.a.extname(e.name).slice(1);else if(e.extension)t=e.extension;else{var c=Object(r.b)(e.URL||e.file||e.guid||"").pathname||"";t=a.a.extname(c).slice(1)}return t}}},"./lib/media/utils/get-mime-prefix.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("./lib/media/utils/get-mime-type.js");function a(e){var t=Object(n.a)(e);if(t){var s=t.match(/^([^/]+)\//);return s?s[1]:void 0}}},"./lib/media/utils/get-mime-type.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("./lib/media/constants.js"),a=s("./lib/media/utils/get-file-extension.js");function i(e){if(e){if(e.mime_type)return e.mime_type;if("File"in window&&e instanceof window.File)return e.type;var t=Object(a.a)(e);if(t)return t=t.toLowerCase(),n.f.hasOwnProperty(t)?n.f[t]:void 0}}},"./lib/media/utils/get-thumbnail-size-dimensions.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("./lib/media/constants.js");function a(e,t){var s,a;return t&&t.options&&(s=t.options["image_"+e+"_width"],a=t.options["image_"+e+"_height"]),e in n.h&&(s=s||n.h[e].width,a=a||n.h[e].height),{width:s,height:a}}},"./lib/media/utils/is-item-being-uploaded.js":function(e,t,s){"use strict";function n(e){return e?!!e.transient:null}s.d(t,"a",(function(){return n}))},"./lib/media/utils/is-site-allowed-file-types-to-be-trusted.js":function(e,t,s){"use strict";function n(e){return!e||!e.jetpack}s.d(t,"a",(function(){return n}))},"./lib/media/utils/is-videopress-item.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=/^[a-z\d]+$/i;function a(e){return!(!e||!e.videopress_guid)&&n.test(e.videopress_guid)}},"./lib/post-normalizer/utils/dom-for-html.js":function(e,t,s){"use strict";function n(e){if("undefined"!=typeof DOMParser&&window.DOMParser.prototype.parseFromString){var t=(new window.DOMParser).parseFromString(e,"text/html");if(t&&t.body)return t.body}var s=document.implementation.createHTMLDocument("processing doc").createElement("div");return s.innerHTML=e,s}s.d(t,"a",(function(){return n}))},"./lib/products-values/is-free-plan.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("./lib/plans/constants.js"),a=s("./lib/products-values/utils/assert-valid-product.js"),i=s("./lib/products-values/format-product.js");function r(e){return e=Object(i.a)(e),Object(a.a)(e),e.product_slug===n.qd}},"./lib/react-pass-to-children/index.js":function(e,t,s){"use strict";var n=s("../node_modules/lodash-es/assign.js"),a=s("../node_modules/react/index.js"),i=s.n(a);t.a=function(e,t){var s,a=Object(n.a)({},e.props,t);return delete a.children,i.a.Children.count(e.props.children)>1?(s=i.a.Children.map(e.props.children,(function(e){return i.a.isValidElement(e)?i.a.cloneElement(e,a):e})),i.a.createElement("div",null,s)):i.a.cloneElement(e.props.children,a)}},"./lib/scroll-to/index.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return m}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),c=s.n(o),l=new Map;function d(e){return e=e&&void 0!==e.scrollTop?e:window,function(t,s){e===window?e.scrollTo(t,s):(e.scrollTop=s,e.scrollLeft=t)}}var u=function(){function e(t){var s=this;a()(this,e),c()(this,"finish",(function(){s.updater(s.end.x,s.end.y),s.onComplete&&s.onComplete(),l.delete(s.container)})),c()(this,"step",(function(e){if(s.nextFrame=null,!s.startTime)return s.startTime=e,void s.animate();if(e-s.startTime>=s.duration)s.finish();else{var t=(e-s.startTime)/s.duration,n=s.easing(t),a=Math.round(s.start.x+(s.end.x-s.start.x)*n),i=Math.round(s.start.y+(s.end.y-s.start.y)*n);a===s.x&&i===s.y||(s.x=a,s.y=i,s.updater(a,i)),s.animate()}})),this.x=t.x,this.y=t.y,this.startTime=null,this.duration=t.duration,this.start=t.start,this.end=t.end,this.onStart=t.onStart,this.onComplete=t.onComplete,this.updater=t.updater,this.easing=t.easing,this.container=t.container}return r()(e,[{key:"animate",value:function(){this.nextFrame=requestAnimationFrame(this.step)}},{key:"cancel",value:function(){this.nextFrame&&(cancelAnimationFrame(this.nextFrame),this.nextFrame=null),this.finishTimeout&&(clearTimeout(this.finishTimeout),this.finishTimeout=null)}},{key:"jumpTo",value:function(e,t){this.cancel(),this.end={x:e,y:t},this.updater(e,t),this.finishTimeout=setTimeout(this.finish,this.duration)}}]),e}();function p(e){var t=e-1;return Math.sqrt(1-t*t)}function m(e){var t=e.container||window;if(!l.has(t)){var s=function(e){return e&&void 0!==e.scrollTop?{x:e.scrollLeft,y:e.scrollTop}:{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}}(t),n=new u({start:s,end:{x:e.x,y:e.y},container:t,easing:e.easing||p,duration:e.duration||500,updater:d(t),x:s.x,y:s.y,onStart:e.onStart,onComplete:e.onComplete});return l.set(t,n),n.animate(),e.onStart&&e.onStart(),n}l.get(t).jumpTo(e.x,e.y)}},"./lib/search-url/index.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var n=s("../node_modules/page/page.js"),a=s.n(n),i=s("./lib/build-url/index.ts"),r=s("../node_modules/debug/src/browser.js"),o=s.n(r)()("calypso:search-url");function c(e,t,s){if(s)s(e);else{var n=Object(i.a)(window.location.href,e);o("search posts for:",e),t&&e?(o("replacing URL: "+n),a.a.replace(n)):(o("setting URL: "+n),a.a.show(n))}}},"./lib/shortcode/index.js":function(e,t,s){"use strict";s.d(t,"c",(function(){return c})),s.d(t,"b",(function(){return l})),s.d(t,"a",(function(){return u}));var n=s("../node_modules/lodash-es/memoize.js"),a=s("../node_modules/lodash-es/isEqual.js"),i=/(\w+)\s*=\s*"([^"]*)"(?:\s|$)|(\w+)\s*=\s*\'([^\']*)\'(?:\s|$)|(\w+)\s*=\s*([^\s\'"]+)(?:\s|$)|"([^"]*)"(?:\s|$)|(\S+)(?:\s|$)/g,r=/\[(\[?)([^\[\]\/\s\u00a0\u200b]+)(?![\w-])([^\]\/]*(?:\/(?!\])[^\]\/]*)*?)(?:(\/)\]|\](?:([^\[]*(?:\[(?!\/\2\])[^\[]*)*)(\[\/\2\]))?)(\]?)/,o=Object(n.a)((function(e){var t,s={},n=[];for(e=e.replace(/[\u00a0\u200b]/g," ");t=i.exec(e);)t[1]?s[t[1].toLowerCase()]=t[2]:t[3]?s[t[3].toLowerCase()]=t[4]:t[5]?s[t[5].toLowerCase()]=t[6]:t[7]?n.push(t[7]):t[8]&&n.push(t[8]);return{named:s,numeric:n}})),c=function(e){var t="["+e.tag,s=function(e){var t,s;if("string"==typeof e)return o(e);if(Array.isArray(e))s=e;else{if("object"==typeof e&&Object(a.a)(Object.keys(e),["named","numeric"]))return e;"object"==typeof e&&(t=e)}return{named:t||{},numeric:s||[]}}(e.attrs);return Object.keys(s.named).forEach((function(e){var n=s.named[e];t+=" "+e+'="'+n+'"'})),s.numeric.forEach((function(e){/\s/.test(e)?t+=' "'+e+'"':t+=" "+e})),"single"===e.type?t+"]":"self-closing"===e.type?t+" /]":(t+="]",e.content&&(t+=e.content),t+"[/"+e.tag+"]")},l=function(e){var t,s=e.match(r);if(!s)return null;t=s[4]?"self-closing":s[6]?"closed":"single";var n={tag:s[2],type:t};return/\S/.test(s[3])&&(n.attrs=o(s[3])),s[5]&&(n.content=s[5]),n},d=Object(n.a)((function(e){return new RegExp("\\[(\\[?)("+e+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)","g")})),u=function e(t,s){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=d(t);a.lastIndex=n||0;var i=a.exec(s);if(i){if("["===i[1]&&"]"===i[7])return e(t,s,a.lastIndex);var r={index:i.index,content:i[0],shortcode:l(i[0])};return i[1]&&(r.content=r.content.slice(1),r.index++),i[7]&&(r.content=r.content.slice(0,-1)),r}}},"./lib/version-compare/index.js":function(e,t,s){"use strict";t.a=function(e,t,s){var n,a=0,i=0,r={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},o=function(e){return(e=(e=(""+e).replace(/[_\-+]/g,".")).replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".")).length?e.split("."):[-8]},c=function(e){return e?isNaN(e)?r[e]||-7:parseInt(e,10):0};for(e=o(e),t=o(t),n=Math.max(e.length,t.length),a=0;a<n;a++)if(e[a]!=t[a]){if(e[a]=c(e[a]),t[a]=c(t[a]),e[a]<t[a]){i=-1;break}if(e[a]>t[a]){i=1;break}}if(!s)return i;switch(s){case">":case"gt":return i>0;case">=":case"ge":return i>=0;case"<=":case"le":return i<=0;case"==":case"=":case"eq":return 0===i;case"<>":case"!=":case"ne":return 0!==i;case"":case"<":case"lt":return i<0;default:return null}}},"./my-sites/customize/panels.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var n=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=s.n(i),o={widgets:["panel","widgets"],fonts:["section","jetpack_fonts"],identity:["section","title_tagline"],"custom-css":["section","jetpack_custom_css"],amp:["section","amp_design"],menus:["panel","nav_menus"],homepage:["section","static_front_page"]};function c(e){if(o.hasOwnProperty(e)){var t=r()(o[e],2),s=t[0],n=t[1];return a()({},"autofocus[".concat(s,"]"),n)}return null}},"./my-sites/marketing/connections/service-action.jsx":function(e,t,s){"use strict";var n=s("../node_modules/prop-types/index.js"),a=s.n(n),i=s("../node_modules/react/index.js"),r=s.n(i),o=s("../node_modules/react-redux/es/index.js"),c=s("../node_modules/lodash-es/identity.js"),l=s("../packages/i18n-calypso/dist/esm/index.js"),d=s("./state/ui/selectors/get-selected-site-id.js"),u=s("../packages/components/dist/esm/button/index.js"),p=s("./state/analytics/actions/record.js"),m=s("./state/selectors/get-current-route-parameterized.js"),h=s("./state/selectors/get-removable-connections.js"),f=function(e){var t,s=e.isConnecting,n=e.isDisconnecting,a=e.isRefreshing,i=e.onAction,o=e.removableConnections,c=e.service,l=e.status,d=e.translate,p=e.recordTracksEvent,m=e.path,h=!1,f="unknown"===l||n||a||s,b=function(e){e.stopPropagation(),i()};return"unknown"===l?t=d("Loading",{context:"Sharing: Publicize status pending button label"}):n?t=d("Disconnecting",{context:"Sharing: Publicize disconnect pending button label"}):a?(t=d("Reconnecting",{context:"Sharing: Publicize reconnect pending button label"}),h=!0):s?t=d("Connecting",{context:"Sharing: Publicize connect pending button label"}):"connected"===l||"must-disconnect"===l?(t=o.length>1?d("Disconnect All",{context:"Sharing: Publicize disconnect button label"}):d("Disconnect",{context:"Sharing: Publicize disconnect button label"}),"must-disconnect"===l&&(h=!0)):"reconnect"===l?(t=d("Reconnect",{context:"Sharing: Publicize reconnect pending button label"}),h=!0):t=d("Connect",{context:"Sharing: Publicize connect pending button label"}),"google_plus"===c.ID&&1>o.length?(t=d("Unavailable",{context:"Sharing: Publicize connect unavailable button label"}),r.a.createElement(u.a,{compact:!0,disabled:!0},t)):"mailchimp"===c.ID&&"not-connected"===l?r.a.createElement("div",null,r.a.createElement(u.a,{className:"connections__signup",compact:!0,href:"https://public-api.wordpress.com/rest/v1.1/sharing/mailchimp/signup",onClick:function(){return p("calypso_connections_signup_button_click",{service:"mailchimp",path:m}),!0},target:"_blank",disabled:f},d("Sign up")),r.a.createElement(u.a,{scary:h,compact:!0,onClick:b,disabled:f},t)):r.a.createElement(u.a,{scary:h,compact:!0,onClick:b,disabled:f},t)};f.propTypes={isConnecting:a.a.bool,isDisconnecting:a.a.bool,isRefreshing:a.a.bool,onAction:a.a.func,removableConnections:a.a.arrayOf(a.a.object),service:a.a.object.isRequired,status:a.a.string,translate:a.a.func,recordTracksEvent:a.a.func},f.defaultProps={isConnecting:!1,isDisconnecting:!1,isRefreshing:!1,onAction:function(){},removableConnections:[],status:"unknown",translate:c.a},t.a=Object(o.c)((function(e,t){var s=t.service,n=Object(d.a)(e);return{removableConnections:Object(h.a)(e,s.ID),path:Object(m.a)(e,n)}}),{recordTracksEvent:p.e})(Object(l.c)(f))},"./my-sites/media-library/content.scss":function(e,t,s){},"./my-sites/media-library/drop-zone.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/prop-types/index.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/react-redux/es/index.js"),y=s("../node_modules/lodash-es/noop.js"),_=s("./components/gridicon/index.tsx"),I=s("../packages/i18n-calypso/dist/esm/index.js"),O=s("./lib/analytics/mc.js"),x=s("./components/drop-zone/index.jsx"),k=s("./lib/site/utils.js"),E=s("./state/media/actions.js"),w=s("./state/media/thunks/index.js"),S=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"uploadFiles",(function(t){e.props.site&&Object(k.h)("upload_files",e.props.site)&&(e.props.clearMediaItemErrors(e.props.site.ID),e.props.addMedia(t,e.props.site),e.props.onAddMedia(),e.props.trackStats&&Object(O.a)("editor_upload_via","drop"))})),h()(c()(e),"isValidTransfer",(function(e){return!!e&&(!e.mozSourceNode&&(!e.types||-1!==Array.prototype.indexOf.call(e.types,"Files")))})),e}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.site,s=e.fullScreen,n=e.translate,a=Object(k.h)("upload_files",t),i=a?null:n("You are not authorized to upload files to this site"),r=a?j.a.createElement(_.a,{icon:"cloud-upload",size:48}):j.a.createElement(_.a,{icon:"cross",size:48});return j.a.createElement(x.a,{fullScreen:s,onVerifyValidTransfer:this.isValidTransfer,onFilesDrop:this.uploadFiles,textLabel:i,icon:r})}}]),s}(j.a.Component);h()(S,"displayName","MediaLibraryDropZone"),h()(S,"propTypes",{site:b.a.object,fullScreen:b.a.bool,onAddMedia:b.a.func,trackStats:b.a.bool,addMedia:b.a.func}),h()(S,"defaultProps",{fullScreen:!0,onAddMedia:y.a,trackStats:!0}),t.a=Object(v.c)(null,{addMedia:w.b,clearMediaItemErrors:E.c})(Object(I.c)(S))},"./my-sites/media-library/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("../node_modules/classnames/index.js"),j=s.n(g),v=s("../node_modules/lodash-es/includes.js"),y=s("../node_modules/lodash-es/some.js"),_=s("../node_modules/lodash-es/isEqual.js"),I=s("../node_modules/prop-types/index.js"),O=s.n(I),x=s("../node_modules/react-redux/es/index.js"),k=s("../node_modules/lodash-es/map.js"),E=s("../node_modules/lodash-es/groupBy.js"),w=s("../node_modules/lodash-es/noop.js"),S=s("../node_modules/lodash-es/values.js"),C=s("../node_modules/lodash-es/head.js"),P=s("../node_modules/lodash-es/isEmpty.js"),T=s("../node_modules/lodash-es/size.js"),M=s("../node_modules/page/page.js"),D=s.n(M),N=s("../packages/i18n-calypso/dist/esm/index.js"),R=s("./lib/analytics/tracks.js"),L=s("./lib/analytics/ga.js"),A=s("./state/selectors/get-media-library-selected-items.js"),U=s("./lib/analytics/track-component-view/index.jsx"),V=s("./components/notice/index.jsx"),q=s("./components/notice/notice-action.jsx"),F=s("./lib/media/actions.js"),z=s("./lib/react-pass-to-children/index.js"),B=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),W=s.n(B),G={getMimeBaseTypeFromFilter:function(e){var t;switch(e){case"images":t="image/";break;case"audio":t="audio/";break;case"videos":t="video/";break;case"documents":t="application/";break;default:t=""}return t},getGoogleQuery:function(e,t){var s=t.categoryFilter,n=t.filter,a=[];return n&&this.convertMimeFilter(n)&&a.push("mediaType="+this.convertMimeFilter(n)),s&&a.push("categoryInclude="+s),a.length?W()(W()({},e),{},{filter:a}):e},convertMimeFilter:function(e){return"videos"===e?"video":"images"===e?"photo":null}},H=s("./state/media/actions.js"),Y=s("./state/media/thunks/index.js"),K=s("./state/selectors/get-media-query-manager.js");function Q(e,t){var s,n,a=null===(s=e.media.fetching[t])||void 0===s?void 0:s.query,i=Object(K.a)(e,t);if(!i)return null;var r=i.getItemsIgnoringPage(a),o=Object(S.a)(null===(n=e.media.transientItems[t])||void 0===n?void 0:n.transientItems);return o.concat(r).filter((function(e){return e})).slice(0).sort((function(e,t){if(e.date&&t.date){var s=Date.parse(t.date)-Date.parse(e.date);if(0!==s)return s}return t.ID-e.ID}))}var X=s("./state/selectors/get-next-page-handle.js");function $(e,t){return!(t in e.media.fetching)||!("nextPageHandle"in e.media.fetching[t])||null!==Object(X.a)(e,t)}var J=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"getQuery",(function(t){var s={};return(t=t||e.props).search&&(s.search=t.search),t.filter&&!t.source&&("this-post"===t.filter?t.postId&&(s.post_ID=t.postId):s.mime_type=G.getMimeBaseTypeFromFilter(t.filter)),t.source&&(s.source=t.source,s.path="recent","google_photos"===t.source)?G.getGoogleQuery(s,t):s})),h()(c()(e),"fetchData",(function(){e.props.fetchNextMediaPage(e.props.siteId)})),e}return r()(s,[{key:"UNSAFE_componentWillMount",value:function(){F.a.setQuery(this.props.siteId,this.getQuery()),this.props.setQuery(this.props.siteId,this.getQuery())}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.getQuery(e);this.props.siteId===e.siteId&&Object(_.a)(t,this.getQuery())||(F.a.setQuery(e.siteId,t),this.props.setQuery(e.siteId,t))}},{key:"render",value:function(){return Object(z.a)(this,{mediaHasNextPage:this.props.hasNextPage,mediaOnFetchNextPage:this.fetchData})}}]),s}(b.a.Component);h()(J,"displayName","MediaListData"),h()(J,"propTypes",{siteId:O.a.number.isRequired,source:O.a.string,postId:O.a.number,filter:O.a.string,search:O.a.string}),J.defaultProps={setQuery:function(){}};var Z=Object(x.c)((function(e,t){return{media:Q(e,t.siteId),hasNextPage:$(e,t.siteId)}}),{fetchNextMediaPage:Y.g,setQuery:H.q})(J),ee=s("./lib/media/constants.js"),te=s("./state/selectors/can-current-user.js"),se=s("./state/sites/selectors/get-site-slug.js"),ne=s("./components/gridicon/index.tsx"),ae=s("./components/popover/menu.jsx"),ie=s("./components/popover/menu-item.jsx"),re=s("../node_modules/lodash-es/debounce.js"),oe=s("../node_modules/lodash-es/partial.js"),ce=s("./components/forms/range/index.jsx"),le=s("./components/segmented-control/index.jsx"),de=s("./state/preferences/actions.js"),ue=s("./state/preferences/selectors.js"),pe=function(e){d()(s,e);var t=p()(s);function s(){var e;return a()(this,s),(e=t.apply(this,arguments)).onScaleChange=e.onScaleChange.bind(c()(e)),e.savePreference=e.savePreference.bind(c()(e)),e.debouncedSavePreference=Object(re.a)(e.savePreference,1e3),e.setScaleToMobileGrid=e.setScale.bind(c()(e),.32),e.setScaleToMobileFull=e.setScale.bind(c()(e),1),e.state={},e}return r()(s,[{key:"componentWillUnmount",value:function(){this.debouncedSavePreference.cancel()}},{key:"savePreference",value:function(e){this.props.saveMediaScalePreference(e)}},{key:"setScale",value:function(e){e!==this.props.scale&&(this.props.onChange(e),this.props.setMediaScalePreference(e),this.debouncedSavePreference(e))}},{key:"onScaleChange",value:function(e){var t=parseInt(e.target.value,10),s=t*ee.g.length/100,n=ee.g[Math.floor(s)];this.setState({sliderPosition:t}),this.setScale(n)}},{key:"getSliderPosition",value:function(){if(this.state.hasOwnProperty("sliderPosition"))return this.state.sliderPosition;var e=this.props.scale,t=ee.g.indexOf(e);return-1===t?0:Math.floor(99*t/(ee.g.length-1))}},{key:"render",value:function(){var e=this.props,t=e.translate,s=e.scale;return b.a.createElement("div",{className:"media-library__scale"},b.a.createElement(le.a,{className:"media-library__scale-toggle",compact:!0},b.a.createElement(le.a.Item,{selected:1!==s,onClick:this.setScaleToMobileGrid,title:t("Grid")},b.a.createElement(ne.a,{icon:"grid",size:18})),b.a.createElement(le.a.Item,{selected:1===s,onClick:this.setScaleToMobileFull,title:t("List")},b.a.createElement(ne.a,{icon:"menu",size:18}))),b.a.createElement(ce.a,{step:"1",min:"0",max:99,minContent:b.a.createElement(ne.a,{icon:"image",size:12}),maxContent:b.a.createElement(ne.a,{icon:"image",size:24}),value:this.getSliderPosition(),onChange:this.onScaleChange,className:"media-library__scale-range"}))}}]),s}(f.Component);h()(pe,"propTypes",{mediaScale:O.a.number,onChange:O.a.func,setMediaScalePreference:O.a.func,saveMediaScalePreference:O.a.func}),h()(pe,"defaultProps",{onChange:function(){}});var me=Object(x.c)((function(e){return{scale:Object(ue.b)(e,"mediaScale")}}),{setMediaScalePreference:Object(oe.a)(de.c,"mediaScale"),saveMediaScalePreference:Object(oe.a)(de.b,"mediaScale")})(Object(N.c)(pe)),he=s("../node_modules/lodash-es/uniq.js"),fe=s("./lib/analytics/mc.js"),be=s("./lib/media/utils/is-site-allowed-file-types-to-be-trusted.js"),ge=s("./lib/media/utils/get-allowed-file-types-for-site.js"),je=(s("./my-sites/media-library/upload-button.scss"),function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"formRef",b.a.createRef()),h()(c()(e),"onClick",(function(){e.props.onClick&&e.props.onClick(),e.props.href&&D()(e.props.href)})),h()(c()(e),"uploadFiles",(function(t){t.target.files&&e.props.site&&(e.props.clearMediaItemErrors(e.props.site.ID),e.props.addMedia(t.target.files,e.props.site)),e.formRef.current.reset(),e.props.onAddMedia(),Object(fe.a)("editor_upload_via","add_button")})),h()(c()(e),"getInputAccept",(function(){if(!Object(be.a)(e.props.site))return null;var t=Object(ge.a)(e.props.site);return Object(he.a)(t.concat(ee.j)).map((function(e){return".".concat(e)})).join()})),e}return r()(s,[{key:"render",value:function(){var e=j()("media-library__upload-button","button",this.props.className);return b.a.createElement("form",{ref:this.formRef,className:e},this.props.children,b.a.createElement("input",{type:"file",accept:this.getInputAccept(),multiple:!0,onChange:this.uploadFiles,onClick:this.onClick,className:"media-library__upload-button-input"}))}}]),s}(b.a.Component));h()(je,"propTypes",{site:O.a.object,onAddMedia:O.a.func,className:O.a.string,addMedia:O.a.func}),h()(je,"defaultProps",{onAddMedia:w.a,type:"button",href:null});var ve=Object(x.c)(null,{addMedia:Y.b,clearMediaItemErrors:H.c})(je),ye=s("./components/forms/form-text-input/index.jsx"),_e=s("../packages/components/dist/esm/screen-reader-text/index.js"),Ie=(s("./my-sites/media-library/upload-url.scss"),function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{value:"",isError:!1}),h()(c()(e),"upload",(function(t){t.preventDefault();var s=!t.target.checkValidity();e.setState({isError:s}),!s&&e.props.site&&(e.props.clearMediaItemErrors(e.props.site.ID),e.props.addMedia(e.state.value,e.props.site),e.setState({value:"",isError:!1}),e.props.onAddMedia(),e.props.onClose(),Object(fe.a)("editor_upload_via","url"))})),h()(c()(e),"onChange",(function(t){e.setState({isError:!1,value:t.target.value})})),h()(c()(e),"onKeyDown",(function(t){if("Escape"===t.key)return e.props.onClose(t);"Enter"===t.key&&e.upload(t)})),e}return r()(s,[{key:"render",value:function(){var e=j()("media-library__upload-url",this.props.className),t=this.props,s=t.onClose,n=t.translate;return b.a.createElement("form",{className:e,onSubmit:this.upload,noValidate:!0},b.a.createElement(ye.a,{type:"url",value:this.state.value,placeholder:"https://",onChange:this.onChange,onKeyDown:this.onKeyDown,isError:this.state.isError,autoFocus:!0,required:!0}),b.a.createElement("div",{className:"media-library__upload-url-button-group"},b.a.createElement("button",{type:"submit",className:"button is-primary"},n("Upload",{context:"verb"})),b.a.createElement("button",{type:"button",className:"media-library__upload-url-cancel",onClick:s},b.a.createElement(_e.a,null,n("Cancel")),b.a.createElement(ne.a,{icon:"cross"}))))}}]),s}(f.Component));h()(Ie,"propTypes",{className:O.a.string,site:O.a.object,onAddMedia:O.a.func,onClose:O.a.func,addMedia:O.a.func}),h()(Ie,"defaultProps",{onAddMedia:w.a,onClose:w.a});var Oe=Object(x.c)(null,{addMedia:Y.b,clearMediaItemErrors:H.c})(Object(N.c)(Ie)),xe=s("./lib/site/utils.js"),ke=s("../node_modules/@babel/runtime/helpers/extends.js"),Ee=s.n(ke),we=s("../node_modules/lodash-es/every.js"),Se=s("../node_modules/lodash-es/pick.js"),Ce=s("../node_modules/lodash-es/flow.js");var Pe=s("./state/current-user/selectors.js"),Te=s("./state/ui/media-modal/selectors.js"),Me=s("./state/editor/actions.js"),De=s("./state/ui/media-modal/constants.js"),Ne=s("./state/analytics/actions/with-analytics.js"),Re=s("./state/analytics/actions/bump-stat.js"),Le=s("./state/analytics/actions/record.js"),Ae=s("../packages/components/dist/esm/button/index.js"),Ue=function(e){d()(s,e);var t=p()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"getButtons",value:function(){var e=this.props,t=e.disabled,s=e.selectedItems,n=e.site,a=e.translate,i=e.user,r=e.view,o=e.onDelete,c=e.onViewDetails,l=[];De.a.LIST===r&&s.length&&l.push({key:"edit",text:a("Edit"),disabled:t,primary:!0,onClick:c});var d=s.length&&Object(we.a)(s,(function(e){return function(e,t,s){return t.ID===e.author_ID?s.capabilities.delete_posts:s.capabilities.delete_others_posts}(e,i,n)}));if(De.a.GALLERY!==r&&d){var u=t||Object(y.a)(s,"transient");l.push({key:"delete",icon:"trash",className:"editor-media-modal__delete",disabled:u,onClick:u?w.a:o})}return l}},{key:"render",value:function(){return this.props.hideButton?null:b.a.createElement("div",null,this.getButtons().map((function(e){return b.a.createElement(Ae.a,Ee()({className:j()("editor-media-modal__secondary-action",e.className),"data-e2e-button":e.key,compact:!0},Object(Se.a)(e,["key","disabled","onClick","primary"])),e.icon&&b.a.createElement(ne.a,{icon:e.icon}),e.text&&e.text)})))}}]),s}(f.Component);h()(Ue,"propTypes",{user:O.a.object,site:O.a.object,selectedItems:O.a.array,view:O.a.oneOf(Object(S.a)(De.a)),disabled:O.a.bool,onDelete:O.a.func,onViewDetails:O.a.func}),h()(Ue,"defaultProps",{disabled:!1,onDelete:w.a});var Ve=Object(x.c)((function(e,t){return{view:Object(Te.a)(e),user:Object(Pe.b)(e),siteSlug:t.site?Object(se.a)(e,t.site.ID):"",hideButton:!Object(te.b)(e,t.site.ID,"publish_posts")}}),{onViewDetails:Object(Ce.a)(Object(Ne.a)(Object(Re.a)("editor_media_actions","edit_button_dialog")),Object(Ne.a)(Object(Le.c)("Media","Clicked Dialog Edit Button")),Object(oe.a)(Me.m,De.a.DETAIL))},(function(e,t,s){return Object.assign({},s,e,t,Object(Se.a)(s,["onViewDetails","view"]))}))(Object(N.c)(Ue)),qe=s("../packages/components/dist/esm/card/index.js"),Fe=s("./components/button-group/index.jsx"),ze=s("./components/sticky-panel/index.jsx"),Be=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{addingViaUrl:!1,isMoreOptionsVisible:!1}),h()(c()(e),"setMoreOptionsContext",(function(t){t&&e.setState({moreOptionsContext:t})})),h()(c()(e),"toggleAddViaUrl",(function(t){e.setState({addingViaUrl:t,isMoreOptionsVisible:!1})})),h()(c()(e),"toggleMoreOptions",(function(t){e.setState({isMoreOptionsVisible:t})})),h()(c()(e),"renderUploadButtons",(function(){var t=e.props,s=t.site,n=t.filter,a=t.onAddMedia;if(Object(xe.h)("upload_files",s))return b.a.createElement(Fe.a,{className:"media-library__upload-buttons"},b.a.createElement(ve,{site:s,filter:n,onAddMedia:a,className:"media-library__upload-button button is-compact"},b.a.createElement(ne.a,{icon:"add-image"}),b.a.createElement("span",{className:"media-library__upload-button-label"},e.props.translate("Add new",{context:"Media upload"}))),b.a.createElement(Ae.a,{compact:!0,ref:e.setMoreOptionsContext,onClick:e.toggleMoreOptions.bind(c()(e),!e.state.isMoreOptionsVisible),className:"button media-library__upload-more","data-tip-target":"media-library-upload-more"},b.a.createElement(_e.a,null,e.props.translate("More Options")),b.a.createElement(ne.a,{icon:"chevron-down",size:18}),b.a.createElement(ae.a,{context:e.state.moreOptionsContext,isVisible:e.state.isMoreOptionsVisible,onClose:e.toggleMoreOptions.bind(c()(e),!1),position:"bottom right",className:"is-dialog-visible media-library__header-popover"},b.a.createElement(ie.a,{onClick:e.toggleAddViaUrl.bind(c()(e),!0)},e.props.translate("Add via URL",{context:"Media upload"})))))})),e}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.site,s=e.onAddMedia;if(this.state.addingViaUrl)return b.a.createElement(Oe,{site:t,onAddMedia:s,onClose:this.toggleAddViaUrl.bind(this,!1),className:"media-library__header"});var n=b.a.createElement(qe.a,{className:"media-library__header"},this.renderUploadButtons(),b.a.createElement(Ve,{selectedItems:this.props.selectedItems,onViewDetails:this.props.onViewDetails,onDelete:this.props.onDeleteItem,site:this.props.site,view:"LIST"}),b.a.createElement(me,{onChange:this.props.onMediaScaleChange}));return this.props.sticky?b.a.createElement(ze.a,{minLimit:660},n):n}}]),s}(b.a.Component);h()(Be,"displayName","MediaLibraryHeader"),h()(Be,"propTypes",{site:O.a.object,filter:O.a.string,sliderPositionCount:O.a.number,onMediaScaleChange:O.a.func,onAddMedia:O.a.func,sticky:O.a.bool}),h()(Be,"defaultProps",{onAddMedia:function(){},sliderPositionCount:100,sticky:!1});var We=Object(N.c)(Be),Ge=s("./state/selectors/is-fetching-next-page.js"),He=function(e){d()(s,e);var t=p()(s);function s(e){var n;return a()(this,s),n=t.call(this,e),h()(c()(n),"onCopy",(function(){var e=n.props,t=e.site,s=e.selectedItems,a=e.source;(0,e.onSourceChange)("",(function(){n.props.addExternalMedia(s,t,a)}))})),n.handleClick=n.onClick.bind(c()(n)),n.handleFetchOn=n.onSetFetch.bind(c()(n)),n.handleFetchOff=Object(re.a)(n.onDisableFetch.bind(c()(n)),250),n.state={debouncedFetching:e.isFetchingNextPage},n}return r()(s,[{key:"onSetFetch",value:function(){this.handleFetchOff.cancel(),this.setState({debouncedFetching:!0})}},{key:"onDisableFetch",value:function(){this.setState({debouncedFetching:!1})}},{key:"componentWillUnmount",value:function(){this.handleFetchOff.cancel()}},{key:"componentDidUpdate",value:function(){this.props.isFetchingNextPage!==this.state.debouncedFetching&&(this.props.isFetchingNextPage?this.handleFetchOn():this.handleFetchOff())}},{key:"onClick",value:function(){var e=this.props.site.ID;this.props.fetchNextMediaPage(e),this.props.changeMediaSource(e)}},{key:"renderCopyButton",value:function(){var e=this.props,t=e.selectedItems,s=e.translate;return b.a.createElement(Ae.a,{compact:!0,disabled:0===t.length,onClick:this.onCopy,primary:!0},s("Copy to media library"))}},{key:"renderPexelsAttribution",value:function(){var e=(0,this.props.translate)("Photos provided by {{a}}Pexels{{/a}}",{components:{a:b.a.createElement("a",{href:"https://www.pexels.com/",rel:"noopener noreferrer",target:"_blank"})}});return b.a.createElement("span",{className:"media-library__pexels-attribution"},e)}},{key:"renderCard",value:function(){var e=this.props,t=e.onMediaScaleChange,s=e.translate,n=e.canCopy,a=e.hasRefreshButton,i=e.hasAttribution;return b.a.createElement(qe.a,{className:"media-library__header"},i&&this.renderPexelsAttribution(),a&&b.a.createElement(Ae.a,{compact:!0,disabled:this.state.debouncedFetching,onClick:this.handleClick},b.a.createElement(ne.a,{icon:"refresh",size:24}),s("Refresh")),n&&this.renderCopyButton(),b.a.createElement(me,{onChange:t}))}},{key:"render",value:function(){return this.props.visible?this.props.sticky?b.a.createElement(ze.a,{minLimit:660},this.renderCard()):this.renderCard():null}}]),s}(b.a.Component);h()(He,"propTypes",{onMediaScaleChange:O.a.func,site:O.a.object.isRequired,visible:O.a.bool.isRequired,canCopy:O.a.bool,selectedItems:O.a.array,onSourceChange:O.a.func,sticky:O.a.bool,hasAttribution:O.a.bool,hasRefreshButton:O.a.bool,isFetchingNextPage:O.a.bool});var Ye=Object(x.c)((function(e,t){var s=t.site;return{isFetchingNextPage:Object(Ge.a)(e,null==s?void 0:s.ID)}}),{addExternalMedia:Y.a,changeMediaSource:H.a,fetchNextMediaPage:Y.g})(Object(N.c)(He)),Ke=s("../node_modules/lodash-es/filter.js"),Qe=s("../node_modules/lodash-es/clone.js"),Xe=s("../node_modules/lodash-es/findIndex.js"),$e=s("../node_modules/lodash-es/min.js"),Je=s("../node_modules/react-dom/index.js"),Ze=s.n(Je),et=s("./lib/media/utils/get-mime-prefix.js"),tt=s("./my-sites/media-library/list-item.tsx"),st=s("./my-sites/no-results/index.jsx"),nt=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"getLabel",(function(){var t;switch(e.props.filter){case"images":t=e.props.translate("No images match your search for {{searchTerm/}}.",{components:{searchTerm:b.a.createElement("em",null,e.props.search)},context:"Media no search results"});break;case"videos":t=e.props.translate("No videos match your search for {{searchTerm/}}.",{components:{searchTerm:b.a.createElement("em",null,e.props.search)},context:"Media no search results"});break;case"audio":t=e.props.translate("No audio files match your search for {{searchTerm/}}.",{components:{searchTerm:b.a.createElement("em",null,e.props.search)},context:"Media no search results"});break;case"documents":t=e.props.translate("No documents match your search for {{searchTerm/}}.",{components:{searchTerm:b.a.createElement("em",null,e.props.search)},context:"Media no search results"});break;default:t=e.props.translate("No media files match your search for {{searchTerm/}}.",{components:{searchTerm:b.a.createElement("em",null,e.props.search)},context:"Media no search results"})}return t})),e}return r()(s,[{key:"render",value:function(){return b.a.createElement(st.a,{text:this.getLabel(),image:"/calypso/images/pages/illustration-pages.svg"})}}]),s}(b.a.Component);h()(nt,"displayName","MediaLibraryListNoResults"),h()(nt,"propTypes",{filter:O.a.string,search:O.a.string}),h()(nt,"defaultProps",{search:""});var at=Object(N.c)(nt),it=s("./components/empty-content/index.jsx"),rt=s("./assets/images/illustrations/media.svg"),ot=function(e){d()(s,e);var t=p()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"getLabel",value:function(){var e=this.props,t=e.filter,s=e.source,n=e.translate;if("google_photos"===s)return n("You don't have any photos in your Google library.",{comment:"Media no results"});if("pexels"===s)return n("Use the search above to find free photos!",{comment:"Media no results"});switch(t){case"this-post":return n("There are no media items uploaded to this post.",{comment:"Media no results"});case"images":return n("You don't have any images.",{comment:"Media no results"});case"videos":return n("You don't have any videos.",{comment:"Media no results"});case"audio":return n("You don't have any audio files.",{comment:"Media no results"});case"documents":return n("You don't have any documents.",{comment:"Media no results"});default:return n("You don't have any media.",{comment:"Media no results"})}}},{key:"render",value:function(){var e="",t="";return Object(xe.h)("upload_files",this.props.site)&&!this.props.source?(e=this.props.translate("Would you like to upload something?"),t=b.a.createElement(ve,{className:"media-library__no-content-upload-button is-primary",site:this.props.site},this.props.translate("Upload media"))):"google_photos"===this.props.source&&(e=this.props.translate("New photos may take a few minutes to appear.")),b.a.createElement(it.a,{title:this.getLabel(),line:e,action:t,illustration:rt.a,illustrationWidth:150})}}]),s}(f.Component);h()(ot,"propTypes",{site:O.a.object,filter:O.a.string,source:O.a.string});var ct=Object(N.c)(ot),lt=s("../node_modules/lodash-es/identity.js"),dt=s("./lib/plans/constants.js"),ut=s("./blocks/upsell-nudge/index.jsx"),pt=s("./lib/formatting/prevent-widows.js"),mt=s("./state/ui/selectors/get-selected-site-id.js"),ht=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"getTitle",(function(){switch(e.props.filter){case"videos":return e.props.translate("Upload Videos",{textOnly:!0,context:"Media upload plan needed"});case"audio":return e.props.translate("Upload Audio",{textOnly:!0,context:"Media upload plan needed"});default:return e.props.translate("Upload Media",{textOnly:!0,context:"Media upload plan needed"})}})),h()(c()(e),"getSummary",(function(){switch(e.props.filter){case"videos":return Object(pt.a)(e.props.canUpgrade?e.props.translate("To upload video files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}):e.props.translate("Uploading video requires a paid plan.")+" "+e.props.translate("Contact your site administrator and ask them to upgrade this site to WordPress.com Premium, Business, or eCommerce."),2);case"audio":return Object(pt.a)(e.props.canUpgrade?e.props.translate("To upload audio files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}):e.props.translate("Uploading audio requires a paid plan.")+" "+e.props.translate("Contact your site administrator and ask them to upgrade this site to WordPress.com Premium, Business, or eCommerce."),2);default:return Object(pt.a)(e.props.translate("To upload audio and video files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}),2)}})),h()(c()(e),"viewPlansPage",(function(){var t=e.props.site.slug,s=void 0===t?"":t;Object(R.recordTracksEvent)("calypso_media_plans_button_click"),D()("/plans/".concat(s))})),e}return r()(s,[{key:"render",value:function(){var e=b.a.createElement(Ae.a,{className:"button is-primary",onClick:this.viewPlansPage},this.props.translate("See Plans"));return b.a.createElement(it.a,{title:this.getTitle(),line:this.getSummary(),action:this.props.children||e,illustration:""})}}]),s}(b.a.Component);h()(ht,"displayName","MediaLibraryListPlanPromo"),h()(ht,"propTypes",{site:O.a.object,filter:O.a.string});var ft=Object(x.c)((function(e){return{canUpgrade:Object(te.b)(e,Object(mt.a)(e),"manage_options")}}))(Object(N.c)(ht));function bt(e,t){return t("audio"===e?"Upgrade to the Premium Plan to Enable Audio Uploads":"Upgrade to the Premium Plan to Enable VideoPress")}function gt(e,t){return t("audio"===e?"By upgrading to the Premium plan, you'll enable audio upload support on your site.":"By upgrading to the Premium plan, you'll enable VideoPress support on your site.")}var jt=function(e){var t=e.translate,s=e.filter,n=e.site;return b.a.createElement("div",{className:"media-library__videopress-nudge-container"},b.a.createElement(ft,{site:n,filter:s},b.a.createElement(ut.a,{className:"media-library__videopress-nudge-regular",title:bt(s,t),description:gt(s,t),feature:"audio"===s?dt.y:dt.Uc,event:"calypso_media_uploads_upgrade_nudge",tracksImpressionName:"calypso_upgrade_nudge_impression",tracksClickName:"calypso_upgrade_nudge_cta_click",showIcon:!0})))};jt.propTypes={site:O.a.object,translate:O.a.func,filter:O.a.string},jt.defaultProps={translate:lt.a,filter:"video"};var vt=Object(N.c)(jt),yt=s("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),_t=s.n(yt),It=s("../node_modules/lodash-es/slice.js"),Ot=s("../node_modules/lodash-es/reduce.js"),xt=s("../node_modules/lodash-es/get.js"),kt=s("../node_modules/lodash-es/last.js"),Et=s("../node_modules/lodash-es/keys.js"),wt=s("../node_modules/lodash-es/omit.js"),St=s("./components/infinite-list/index.jsx"),Ct=function(e){var t=e.itemsCount,s=e.itemsPerRow,n=e.lastInRow,a=e.scale,i=e.text,r=1%a/(s-1)*100||0,o={marginRight:"".concat(n?0:r,"%"),width:"".concat(a*t*100+r*(t-1),"%")};return b.a.createElement("div",{className:"sorted-grid__label",style:o},i)};Ct.propTypes={itemsCount:O.a.number,itemsPerRow:O.a.number,lastInRow:O.a.bool,scale:O.a.number.isRequired,text:O.a.string},Ct.defaultProps={text:""};var Pt=Object(x.c)((function(e){return{scale:Object(ue.b)(e,"mediaScale")}}),null,null,{pure:!1})(Ct),Tt=(s("./components/sorted-grid/style.scss"),function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"renderItem",(function(t){return t.isGridLabel?e.renderLabels(t):e.props.renderItem(t)})),e}return r()(s,[{key:"getItems",value:function(){for(var e=[],t=0;t<this.props.items.length;t+=this.props.itemsPerRow){var s=Object(It.a)(this.props.items,t,t+this.props.itemsPerRow),n=Object(Ot.a)(Object(k.a)(s,this.props.getItemGroup),(function(e,t){return e[t]=Object(xt.a)(e,t,0)+1,e}),{});e.push.apply(e,[{isGridLabel:!0,id:t,groups:n}].concat(_t()(s)))}return e}},{key:"renderLabels",value:function(e){var t=this;return b.a.createElement("div",{key:"header_".concat(e.id),className:"sorted-grid__header"},Object(k.a)(e.groups,(function(s,n){return""!==t.props.getGroupLabel(n)&&b.a.createElement(Pt,{key:"group_".concat(n),text:t.props.getGroupLabel(n),itemsCount:s,itemsPerRow:t.props.itemsPerRow,lastInRow:Object(kt.a)(Object(Et.a)(e.groups))===n})})))}},{key:"render",value:function(){var e=Object(wt.a)(this.props,"getGroupLabel","getItemGroup","items","renderItem");return b.a.createElement(St.a,Ee()({items:this.getItems(),renderItem:this.renderItem},e))}}]),s}(f.PureComponent));h()(Tt,"propTypes",{getGroupLabel:O.a.func.isRequired,getItemGroup:O.a.func.isRequired,items:O.a.array,itemsPerRow:O.a.number.isRequired});var Mt=Tt,Dt=s("./components/localized-moment/index.js"),Nt=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{}),h()(c()(e),"setListContext",(function(t){t&&e.setState({listContext:Ze.a.findDOMNode(t)})})),h()(c()(e),"getMediaItemHeight",(function(){return Math.round(e.props.containerWidth*e.props.mediaScale)+e.props.rowPadding})),h()(c()(e),"getItemsPerRow",(function(){return Math.floor(1/e.props.mediaScale)})),h()(c()(e),"getMediaItemStyle",(function(t){var s=e.getItemsPerRow(),n=s===1/e.props.mediaScale,a=0==(t+1)%s,i={paddingBottom:e.props.rowPadding,fontSize:225*e.props.mediaScale};if(!n&&!a){var r=1%e.props.mediaScale/(s-1)*100+"%";e.props.isRtl?i.marginLeft=r:i.marginRight=r}return i})),h()(c()(e),"toggleItem",(function(t,s){var n;n=e.props.single?Object(Ke.a)(e.props.selectedItems,{ID:t.ID}):Object(Qe.a)(e.props.selectedItems);var a=-1===Object(Xe.a)(n,{ID:t.ID}),i=Object(Xe.a)(e.props.media,{ID:t.ID}),r=i,o=i;!e.props.single&&s&&(r=Math.min(r,e.state.lastSelectedMediaIndex),o=Math.max(o,e.state.lastSelectedMediaIndex));for(var c=r;c<=o;c++){var l=Object(Xe.a)(n,{ID:e.props.media[c].ID});a&&-1===l?n.push(e.props.media[c]):a||-1===l||n.splice(l,1)}e.setState({lastSelectedMediaIndex:i}),e.props.site&&e.props.setMediaLibrarySelectedItems(e.props.site.ID,n)})),h()(c()(e),"getItemRef",(function(e){return"item-"+e.ID})),h()(c()(e),"getGroupLabel",(function(t){return e.props.moment(t).format("LL")})),h()(c()(e),"getItemGroup",(function(t){return Object($e.a)([t.date.slice(0,10),e.props.moment(new Date).format("YYYY-MM-DD")])})),h()(c()(e),"renderItem",(function(t){var s=Object(Xe.a)(e.props.media,{ID:t.ID}),n=e.props.selectedItems,a=Object(Xe.a)(n,{ID:t.ID}),i=e.getItemRef(t),r=!e.props.single&&-1!==a&&1===n.length&&"image"===Object(et.a)(t);return b.a.createElement(tt.a,{ref:i,key:i,style:e.getMediaItemStyle(s),media:t,scale:e.props.mediaScale,thumbnailType:e.props.thumbnailType,showGalleryHelp:r,selectedIndex:a,onToggle:e.toggleItem,onEditItem:e.props.onEditItem})})),h()(c()(e),"renderLoadingPlaceholders",(function(){var t=e.getItemsPerRow(),s=(e.props.media||[]).length,n=t-s%t;return Array.apply(null,new Array(n)).map((function(e,t){return b.a.createElement(tt.a,{key:"placeholder-"+t,style:this.getMediaItemStyle(s+t),scale:this.props.mediaScale})}),c()(e))})),e}return r()(s,[{key:"sourceIsUngrouped",value:function(e){return-1!==["pexels"].indexOf(e)}},{key:"render",value:function(){var e=this,t=this.getItemGroup,s=this.getGroupLabel;if(this.props.filterRequiresUpgrade)return b.a.createElement(vt,{filter:this.props.filter,site:this.props.site});if(!this.props.mediaHasNextPage&&this.props.media&&0===this.props.media.length)return b.a.createElement(this.props.search?at:ct,{site:this.props.site,filter:this.props.filter,search:this.props.search,source:this.props.source});var n=function(){this.props.mediaOnFetchNextPage()}.bind(this);return this.sourceIsUngrouped(this.props.source)&&(t=function(){return e.props.source},s=function(){return""}),b.a.createElement(Mt,{ref:this.setListContext,getItemGroup:t,getGroupLabel:s,context:!!this.props.scrollable&&this.state.listContext,items:this.props.media||[],itemsPerRow:this.getItemsPerRow(),lastPage:!this.props.mediaHasNextPage,fetchingNextPage:this.props.isFetchingNextPage,guessedItemHeight:this.getMediaItemHeight(),fetchNextPage:n,getItemRef:this.getItemRef,renderItem:this.renderItem,renderLoadingPlaceholders:this.renderLoadingPlaceholders,className:"media-library__list"})}}]),s}(b.a.Component);h()(Nt,"displayName","MediaLibraryList"),h()(Nt,"propTypes",{site:O.a.object,media:O.a.arrayOf(O.a.object),selectedItems:O.a.arrayOf(O.a.object),filter:O.a.string,filterRequiresUpgrade:O.a.bool.isRequired,search:O.a.string,containerWidth:O.a.number,rowPadding:O.a.number,mediaScale:O.a.number.isRequired,thumbnailType:O.a.string,mediaHasNextPage:O.a.bool,isFetchingNextPage:O.a.bool,mediaOnFetchNextPage:O.a.func,single:O.a.bool,scrollable:O.a.bool,onEditItem:O.a.func}),h()(Nt,"defaultProps",{containerWidth:0,rowPadding:10,mediaHasNextPage:!1,isFetchingNextPage:!1,mediaOnFetchNextPage:w.a,single:!1,scrollable:!1,onEditItem:w.a});var Rt=Object(x.c)((function(e,t){var s=t.site;return{mediaScale:Object(ue.b)(e,"mediaScale"),selectedItems:Object(A.a)(e,null==s?void 0:s.ID),isFetchingNextPage:Object(Ge.a)(e,null==s?void 0:s.ID)}}),{setMediaLibrarySelectedItems:H.o})(Object(N.i)(Object(Dt.b)(Nt))),Lt=s("./state/sharing/services/selectors.js"),At=s("./components/data/query-keyring-services/index.jsx"),Ut=s("./components/data/query-publicize-connections/index.jsx"),Vt=s("./my-sites/marketing/connections/service-action.jsx"),qt=s("./state/sharing/keyring/actions.js"),Ft=s("./state/sharing/keyring/selectors.js"),zt=s("../packages/request-external-access/dist/esm/index.js"),Bt=function(e){d()(s,e);var t=p()(s);function s(e){var n;return a()(this,s),(n=t.call(this,e)).handleAction=n.onAction.bind(c()(n)),n.state={isConnecting:!1,isRefreshing:!1},n}return r()(s,[{key:"getConnectionStatus",value:function(e,t){return t?"unknown":e?"broken"===e.status?"reconnect":"connected":"not-connected"}},{key:"onAction",value:function(){var e=this.props.service;"reconnect"===this.getConnectionStatus(this.props.connectedService,this.state.isFetching)?this.refresh(e):this.addConnection(e)}},{key:"refresh",value:function(e){this.setState({isRefreshing:!0}),this.requestAccess(e.refresh_URL),this.trackEvent(e.ID,"Clicked Connect Button")}},{key:"addConnection",value:function(e){this.setState({isConnecting:!0}),this.requestAccess(e.connect_URL),this.trackEvent(e.ID,"Clicked Reconnect Button")}},{key:"requestAccess",value:function(e){var t=this;Object(zt.a)(e,(function(){t.props.requestKeyringConnections()}))}},{key:"trackEvent",value:function(e,t){this.props.recordGoogleEvent("Sharing",t,e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){!0===e.isFetching&&this.setState({isConnecting:!1,isRefreshing:!1})}},{key:"render",value:function(){var e=this.getConnectionStatus(this.props.connectedService,this.props.isFetching),t=this.state,s=t.isConnecting,n=t.isRefreshing,a=this.props.service;return b.a.createElement(Vt.a,{status:e,service:a,onAction:this.handleAction,isConnecting:s,isRefreshing:n,isDisconnecting:!1})}}]),s}(f.Component);h()(Bt,"propTypes",{service:O.a.object.isRequired,isFetching:O.a.bool.isRequired,connectedService:O.a.object});var Wt=Object(x.c)((function(e,t){var s=function(e,t){return Object(Ft.c)(e).filter((function(e){return e.service===t}))}(e,t.serviceName);return{isFetching:Object(Ft.e)(e),connectedService:s.length>0?s[0]:null}}),{requestKeyringConnections:qt.c,recordGoogleEvent:Le.c})(Bt),Gt=function(e){d()(s,e);var t=p()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e=this.props.service;return b.a.createElement("div",null,b.a.createElement(Ut.a,{selectedSite:!0}),b.a.createElement(At.a,null),e&&b.a.createElement(Wt,{service:e}))}}]),s}(f.Component);h()(Gt,"propTypes",{serviceName:O.a.string.isRequired});var Ht=Object(x.c)((function(e,t){return{service:Object(Lt.b)(e,t.serviceName)}}))(Gt),Yt=s("./state/guided-tours/actions.js"),Kt=s("./state/guided-tours/selectors/index.js"),Qt=s("./state/notices/actions.js"),Xt=(s("./my-sites/media-library/content.scss"),function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"retryList",(function(){e.props.changeMediaSource(e.props.site.ID)})),h()(c()(e),"goToSharing",(function(t){t.preventDefault(),D()("/marketing/connections/".concat(e.props.site.slug))})),e}return r()(s,[{key:"componentDidUpdate",value:function(e){this.props.shouldPauseGuidedTour!==e.shouldPauseGuidedTour&&this.props.toggleGuidedTour(this.props.shouldPauseGuidedTour),!this.hasGoogleExpired(e)&&this.hasGoogleExpired(this.props)&&this.props.googleConnection&&this.props.deleteKeyringConnection(this.props.googleConnection),!this.isGoogleConnectedAndVisible(e)&&this.isGoogleConnectedAndVisible(this.props)&&this.hasGoogleExpired(this.props)&&this.props.changeMediaSource(this.props.site.ID)}},{key:"isGoogleConnectedAndVisible",value:function(e){var t=e.googleConnection;return!("google_photos"!==e.source||!t||"ok"!==t.status)}},{key:"hasGoogleExpired",value:function(e){var t=e.mediaValidationErrorTypes;return"google_photos"===e.source&&-1!==t.indexOf(ee.i.SERVICE_AUTH_FAILED)}},{key:"renderErrors",value:function(){var e=this,t=this.props,s=t.mediaValidationErrorTypes,n=t.site,a=t.translate;return Object(k.a)(Object(E.a)(s),(function(t,s){var i,r,o={count:t.length,args:t.length};n&&(r=function(){return e.props.clearMediaErrors(n.ID,s)});var c="is-error",l=void 0,d=void 0,u=!1;switch(s){case ee.i.FILE_TYPE_NOT_IN_PLAN:c="is-warning",l="plan-media-storage-error-video",d="video-upload",i=a("%d file could not be uploaded because your site does not support video files. Upgrade to a premium plan for video support.","%d files could not be uploaded because your site does not support video files. Upgrade to a premium plan for video support.",o);break;case ee.i.FILE_TYPE_UNSUPPORTED:i=a("%d file could not be uploaded because the file type is not supported.","%d files could not be uploaded because their file types are unsupported.",o);break;case ee.i.UPLOAD_VIA_URL_404:i=a("%d file could not be uploaded because no image exists at the specified URL.","%d files could not be uploaded because no images exist at the specified URLs",o);break;case ee.i.EXCEEDS_MAX_UPLOAD_SIZE:i=a("%d file could not be uploaded because it exceeds the maximum upload size.","%d files could not be uploaded because they exceed the maximum upload size.",o);break;case ee.i.NOT_ENOUGH_SPACE:l="plan-media-storage-error",d="extra-storage",i=a("%d file could not be uploaded because there is not enough space left.","%d files could not be uploaded because there is not enough space left.",o);break;case ee.i.EXCEEDS_PLAN_STORAGE_LIMIT:l="plan-media-storage-error",d="extra-storage",i=a("%d file could not be uploaded because you have reached your plan storage limit.","%d files could not be uploaded because you have reached your plan storage limit.",o);break;case ee.i.SERVICE_AUTH_FAILED:i=e.getAuthFailMessageForSource(),c="is-warning",u=!1;break;case ee.i.SERVICE_FAILED:i=a("We are unable to retrieve your full media library."),u=!0;break;case ee.i.SERVICE_UNAVAILABLE:i=e.getServiceUnavailableMessageForSource(),u=!0;break;default:i=a("%d file could not be uploaded because an error occurred while uploading.","%d files could not be uploaded because errors occurred while uploading.",o)}return b.a.createElement(V.a,{key:s,status:c,text:i,onDismissClick:r},e.renderNoticeAction(l,d),u&&e.renderTryAgain())}))}},{key:"getAuthFailMessageForSource",value:function(){var e=this.props,t=e.translate;return t("google_photos"===e.source?"We are moving to a new and faster Photos from Google service. Please reconnect to continue accessing your photos.":"Your service has been disconnected. Please reconnect to continue.")}},{key:"getServiceUnavailableMessageForSource",value:function(){var e=this.props,t=e.translate;return t("pexels"===e.source?"We were unable to connect to the Pexels service. Please try again later.":"We were unable to connect to the external service. Please try again later.")}},{key:"renderTryAgain",value:function(){return b.a.createElement(q.a,{onClick:this.retryList},this.props.translate("Retry"))}},{key:"renderNoticeAction",value:function(e,t){if(!e)return null;var s={cta_name:e,cta_feature:t};return b.a.createElement(q.a,{external:!0,href:t?"/plans/compare/".concat(this.props.siteSlug,"?feature=").concat(t):"/plans/".concat(this.props.siteSlug),onClick:this.recordPlansNavigation.bind(this,"calypso_upgrade_nudge_cta_click",s)},this.props.translate("Upgrade Plan"),b.a.createElement(U.a,{eventName:"calypso_upgrade_nudge_impression",eventProperties:s}))}},{key:"recordPlansNavigation",value:function(e,t){Object(L.a)("Media","Clicked Upload Error Action"),Object(R.recordTracksEvent)(e,t)}},{key:"renderGooglePhotosConnect",value:function(){var e=this.props.translate("To show your Google Photos library you need to connect your Google account.");return b.a.createElement("div",{className:"media-library__connect-message"},b.a.createElement("p",null,b.a.createElement("img",{src:"/calypso/images/sharing/google-photos-connect.png",width:"400",alt:""})),b.a.createElement("p",null,e),b.a.createElement(Ht,{serviceName:"google_photos"}))}},{key:"renderConnectExternalMedia",value:function(){switch(this.props.source){case"google_photos":return this.renderGooglePhotosConnect()}return null}},{key:"getThumbnailType",value:function(){return""!==this.props.source?ee.e:ee.d}},{key:"needsToBeConnected",value:function(){var e=this.props,t=e.source,s=e.isConnected;return""!==t&&!s||!(""===t||!s||!this.hasGoogleExpired(this.props))}},{key:"renderMediaList",value:function(){return!this.props.site||this.props.isRequesting&&!this.hasRequested?(this.hasRequested=!0,b.a.createElement(Rt,{key:"list-loading",filterRequiresUpgrade:this.props.filterRequiresUpgrade})):this.needsToBeConnected()?this.renderConnectExternalMedia():b.a.createElement(Z,{siteId:this.props.site.ID,postId:this.props.postId,filter:this.props.filter,search:this.props.search,source:this.props.source},b.a.createElement(Rt,{key:"list-"+[this.props.site.ID,this.props.search,this.props.filter].join(),site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.props.filterRequiresUpgrade,search:this.props.search,containerWidth:this.props.containerWidth,thumbnailType:this.getThumbnailType(),single:this.props.single,scrollable:this.props.scrollable,onEditItem:this.props.onEditItem}))}},{key:"renderHeader",value:function(){return this.needsToBeConnected()?null:""!==this.props.source?b.a.createElement(Ye,{onMediaScaleChange:this.props.onMediaScaleChange,site:this.props.site,visible:!this.props.isRequesting,canCopy:void 0===this.props.postId,source:this.props.source,onSourceChange:this.props.onSourceChange,selectedItems:this.props.selectedItems,sticky:!this.props.scrollable,hasAttribution:"pexels"===this.props.source,hasRefreshButton:"pexels"!==this.props.source}):this.props.filterRequiresUpgrade?null:b.a.createElement(We,{site:this.props.site,filter:this.props.filter,onMediaScaleChange:this.props.onMediaScaleChange,onAddMedia:this.props.onAddMedia,onAddAndEditImage:this.props.onAddAndEditImage,selectedItems:this.props.selectedItems,onViewDetails:this.props.onViewDetails,onDeleteItem:this.props.onDeleteItem,sticky:!this.props.scrollable})}},{key:"render",value:function(){var e=j()("media-library__content",{"has-no-upload-button":!this.props.displayUploadMediaButton});return b.a.createElement("div",{className:e},this.renderHeader(),this.renderErrors(),this.renderMediaList())}}]),s}(b.a.Component));h()(Xt,"propTypes",{site:O.a.object,mediaValidationErrors:O.a.object,filter:O.a.string,filterRequiresUpgrade:O.a.bool,search:O.a.string,source:O.a.string,containerWidth:O.a.number,single:O.a.bool,scrollable:O.a.bool,onAddMedia:O.a.func,onMediaScaleChange:O.a.func,onEditItem:O.a.func,postId:O.a.number,isConnected:O.a.bool}),h()(Xt,"defaultProps",{mediaValidationErrors:Object.freeze({}),onAddMedia:w.a,source:""});var $t=Object(x.c)((function(e,t){var s,n=Object(Kt.a)(e),a=Object(S.a)(t.mediaValidationErrors).map(C.a),i=!Object(P.a)(n.tour)&&0<Object(T.a)(a),r=Object(Ft.d)(e,"google_photos");return{siteSlug:t.site?Object(se.a)(e,t.site.ID):"",isRequesting:Object(Ft.e)(e),displayUploadMediaButton:Object(te.b)(e,t.site.ID,"publish_posts"),mediaValidationErrorTypes:a,shouldPauseGuidedTour:i,googleConnection:1===r.length?r[0]:null,selectedItems:Object(A.a)(e,null===(s=t.site)||void 0===s?void 0:s.ID)}}),{toggleGuidedTour:function(e){return function(t){t(e?Object(Yt.b)():Object(Yt.f)())}},deleteKeyringConnection:function(e){return function(t){t(Object(Qt.h)((function(){return Object(qt.a)(e)}))())}},clearMediaErrors:H.b,changeMediaSource:H.a},null,{pure:!1})(Object(N.c)(Xt)),Jt=s("./state/selectors/get-media-errors.js"),Zt=s("./my-sites/media-library/drop-zone.jsx"),es=s("./lib/media/utils/filter-items-by-mime-prefix.js"),ts=function(e){var t;switch(e){case"images":t="image";break;case"audio":t="audio";break;case"videos":t="video";break;case"documents":t="application"}return t},ss=s("../node_modules/lodash-es/pull.js"),ns=s("../node_modules/lodash-es/union.js"),as=s("./components/section-nav/index.jsx"),is=s("./components/section-nav/tabs.jsx"),rs=s("./components/section-nav/item.jsx"),os=s("./components/search/index.jsx"),cs=s("./blocks/plan-storage/index.jsx"),ls=s("../node_modules/lodash-es/find.js"),ds=function(){return b.a.createElement("svg",{className:"gridicon",viewBox:"0 0 48 48",height:"24",width:"24",xmlns:"http://www.w3.org/2000/svg"},b.a.createElement("path",{fill:"none",d:"M0 0h48v48H0V0z"}),b.a.createElement("path",{d:"M12.63 14l-8.89 8.96c-.1.11-.26.36-.26.52 0 .32.2.52.52.52h14c2.28 0 4-1.72 4-4v-6h-9.37zM44 24H30c-2.28 0-4 1.72-4 4v6h9.37l8.89-8.96c.1-.11.26-.36.26-.52 0-.32-.2-.52-.52-.52zM25.04 3.74c-.11-.1-.36-.26-.52-.26-.32 0-.52.2-.52.52v14c0 2.28 1.72 4 4 4h6v-9.37l-8.96-8.89zM20 26h-6v9.37l8.96 8.89c.11.1.36.26.52.26.32 0 .52-.2.52-.52V30c0-2.28-1.72-4-4-4z"}))},us=s("./config/index.js"),ps=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{popover:!1}),h()(c()(e),"storeButtonRef",(function(t){return e.buttonRef=t})),h()(c()(e),"togglePopover",(function(){e.setState({popover:!e.state.popover})})),h()(c()(e),"changeSource",(function(t){return function(){t!==e.props.source&&e.props.onSourceChange(t)}})),h()(c()(e),"getSources",(function(){var t=e.props,s=t.disabledSources,n=t.translate,a=t.ignorePermissions,i=t.canUserUploadFiles,r=a||i,o=[{value:"",label:n("Media library"),icon:b.a.createElement(ne.a,{icon:"image",size:24})}];return us.a.isEnabled("external-media/google-photos")&&r&&o.push({value:"google_photos",label:n("Google Photos"),icon:b.a.createElement(ds,null)}),us.a.isEnabled("external-media/free-photo-library")&&r&&o.push({value:"pexels",label:n("Pexels free photos"),icon:b.a.createElement(ne.a,{icon:"image-multiple",size:24})}),o.filter((function(e){var t=e.value;return!Object(v.a)(s,t)}))})),e}return r()(s,[{key:"renderScreenReader",value:function(e){return b.a.createElement(_e.a,null,e&&e.label)}},{key:"renderMenuItems",value:function(e){var t=this;return e.map((function(e){var s=e.icon,n=e.label,a=e.value;return b.a.createElement(ie.a,{key:a,"data-source":a,onClick:t.changeSource(a)},s,n)}))}},{key:"render",value:function(){var e=this.props,t=e.translate,s=e.source,n=this.getSources(),a=Object(ls.a)(n,(function(e){return e.value===s})),i=j()("media-library__datasource",{"is-single-source":1===n.length}),r=j()("button media-library__source-button",{"is-open":this.state.popover});return us.a.isEnabled("external-media")||n.length?b.a.createElement("div",{className:i},b.a.createElement(Ae.a,{borderless:!0,ref:this.storeButtonRef,className:r,onClick:this.togglePopover,title:t("Choose media library source")},a&&a.icon,this.renderScreenReader(a),b.a.createElement(ne.a,{icon:"chevron-down",size:18})),n.length>1&&b.a.createElement(ae.a,{context:this.buttonRef,isVisible:this.state.popover,position:"bottom right",onClose:this.togglePopover,className:"is-dialog-visible media-library__header-popover"},this.renderMenuItems(n))):null}}]),s}(f.Component);h()(ps,"propTypes",{source:O.a.string.isRequired,onSourceChange:O.a.func.isRequired,disabledSources:O.a.array,ignorePermissions:O.a.bool}),h()(ps,"defaultProps",{disabledSources:[],ignorePermissions:!1});var ms=Object(x.c)((function(e){return{canUserUploadFiles:Object(te.b)(e,Object(mt.a)(e),"upload_files")}}))(Object(N.c)(ps)),hs=["pexels","google_photos"],fs=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"changeFilter",(function(t){return function(){e.props.onFilterChange(t)}})),e}return r()(s,[{key:"getSearchPlaceholderText",value:function(){var e=this.props,t=e.filter,s=e.source,n=e.translate;if("pexels"===s)return n("Search for free photos");switch(t){case"this-post":return n("Search media uploaded to this post");case"images":return n("Search images");case"audio":return n("Search audio files");case"videos":return n("Search videos");case"documents":return n("Search documents");default:return n("Search all media")}}},{key:"getFilterLabel",value:function(e){var t=this.props.translate;switch(e){case"this-post":return t("This Post",{comment:"Filter label for media list"});case"images":return t("Images",{comment:"Filter label for media list"});case"audio":return t("Audio",{comment:"Filter label for media list"});case"videos":return t("Videos",{comment:"Filter label for media list"});case"documents":return t("Documents",{comment:"Filter label for media list"});default:return t("All",{comment:"Filter label for media list"})}}},{key:"isFilterDisabled",value:function(e){var t=this.props.enabledFilters;return t&&(!e.length||!Object(v.a)(t,e))}},{key:"getFiltersForSource",value:function(e){return"pexels"===e?[]:"google_photos"===e?["","images","videos"]:["","this-post","images","documents","videos","audio"]}},{key:"renderTabItems",value:function(){var e=this,t=this.getFiltersForSource(this.props.source);return this.props.post||Object(ss.a)(t,"this-post"),0===t.length?null:b.a.createElement(is.a,null,t.map((function(t){return b.a.createElement(rs.a,{key:"filter-tab-"+t,selected:e.props.filter===t,onClick:e.changeFilter(t),disabled:e.isFilterDisabled(t)},e.getFilterLabel(t))})))}},{key:"renderSearchSection",value:function(){var e=this.props,t=e.source,s=e.onSearch,n=e.search,a=e.filterRequiresUpgrade,i=e.isConnected;if(a||!i)return null;if("google_photos"===t)return null;var r=""===t;return b.a.createElement(os.a,{key:t,analyticsGroup:"Media",pinned:r,fitsContainer:!0,onSearch:s,initialValue:n,placeholder:this.getSearchPlaceholderText(),delaySearch:!0})}},{key:"renderPlanStorage",value:function(){if(this.props.source)return null;return b.a.createElement(cs.a,{siteId:this.props.site.ID},b.a.createElement(U.a,{eventName:"calypso_upgrade_nudge_impression",eventProperties:{cta_name:"plan-media-storage"}}))}},{key:"render",value:function(){var e=this.props.disableLargeImageSources?Object(ns.a)(this.props.disabledDataSources,hs):this.props.disabledDataSources;return b.a.createElement("div",{className:"media-library__filter-bar"},b.a.createElement(ms,{source:this.props.source,onSourceChange:this.props.onSourceChange,disabledSources:e}),b.a.createElement(as.a,{selectedText:this.getFilterLabel(this.props.filter),hasSearch:!0,allowDropdown:!this.props.source},this.renderTabItems(),this.renderSearchSection()),this.renderPlanStorage())}}]),s}(f.Component);h()(fs,"propTypes",{basePath:O.a.string,enabledFilters:O.a.arrayOf(O.a.string),filter:O.a.string,filterRequiresUpgrade:O.a.bool,search:O.a.string,source:O.a.string,site:O.a.object,onFilterChange:O.a.func,onSearch:O.a.func,translate:O.a.func,post:O.a.bool,isConnected:O.a.bool,disableLargeImageSources:O.a.bool,disabledDataSources:O.a.arrayOf(O.a.string)}),h()(fs,"defaultProps",{filter:"",basePath:"/media",onFilterChange:w.a,onSourceChange:w.a,onSearch:w.a,translate:lt.a,source:"",post:!1,isConnected:!0,disableLargeImageSources:!1,disabledDataSources:[]});var bs=Object(N.c)(fs),gs=s("./components/data/query-preferences/index.jsx"),js=s("./lib/search-url/index.js"),vs=(s("./my-sites/media-library/style.scss"),["pexels"]),ys=function(e){return""!==e&&!Object(v.a)(vs,e)},_s=function(e,t){return!ys(t)||Object(y.a)(Object(Ft.c)(e),{type:"other",status:"ok",service:t})},Is=function(e,t){return ys(t)&&!Object(Ft.e)(e)&&!Object(y.a)(Object(Ft.c)(e),{type:"other",status:"ok"})},Os=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"doSearch",(function(t){Object(js.a)(t,e.props.search,e.props.onSearch)})),h()(c()(e),"onAddMedia",(function(){var t=e.props.selectedItems,s=t;e.props.site&&(e.props.filter&&(s=Object(es.a)(s,ts(e.props.filter))),e.props.single&&s.length>1&&(s=s.slice(-1)),Object(_.a)(t,s)||e.props.setMediaLibrarySelectedItems(e.props.site.ID,s),e.props.onAddMedia())})),e}return r()(s,[{key:"componentDidMount",value:function(){this.props.needsKeyring&&this.props.requestKeyringConnections()}},{key:"componentDidUpdate",value:function(e){this.props.needsKeyring&&!ys(e.source)&&this.props.requestKeyringConnections()}},{key:"filterRequiresUpgrade",value:function(){var e=this.props,t=e.filter,s=e.site;if(e.source)return!1;switch(t){case"audio":return!(s&&s.options.upgraded_filetypes_enabled||s.jetpack);case"videos":return!(s&&s.options.videopress_enabled||s.jetpack)}return!1}},{key:"renderDropZone",value:function(){return""!==this.props.source?null:b.a.createElement(Zt.a,{site:this.props.site,filter:this.props.filter,fullScreen:this.props.fullScreenDropZone,onAddMedia:this.onAddMedia})}},{key:"render",value:function(){var e=j()("media-library",{"is-single":this.props.single},this.props.className);return b.a.createElement("div",{className:e},b.a.createElement(gs.a,null),this.renderDropZone(),b.a.createElement(bs,{site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.filterRequiresUpgrade(),enabledFilters:this.props.enabledFilters,search:this.props.search,onFilterChange:this.props.onFilterChange,onSourceChange:this.props.onSourceChange,source:this.props.source,onSearch:this.doSearch,isConnected:this.props.isConnected,post:!!this.props.postId,disableLargeImageSources:this.props.disableLargeImageSources,disabledDataSources:this.props.disabledDataSources}),b.a.createElement($t,{site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.filterRequiresUpgrade(),search:this.props.search,source:this.props.source,isConnected:this.props.isConnected,containerWidth:this.props.containerWidth,single:this.props.single,scrollable:this.props.scrollable,onAddMedia:this.onAddMedia,onAddAndEditImage:this.props.onAddAndEditImage,onMediaScaleChange:this.props.onScaleChange,onSourceChange:this.props.onSourceChange,onDeleteItem:this.props.onDeleteItem,onEditItem:this.props.onEditItem,onViewDetails:this.props.onViewDetails,postId:this.props.postId,mediaValidationErrors:this.props.site?this.props.mediaValidationErrors:void 0}))}}]),s}(f.Component);h()(Os,"propTypes",{className:O.a.string,site:O.a.object,filter:O.a.string,enabledFilters:O.a.arrayOf(O.a.string),search:O.a.string,source:O.a.string,onAddMedia:O.a.func,onFilterChange:O.a.func,onSourceChange:O.a.func,onSearch:O.a.func,onScaleChange:O.a.func,onEditItem:O.a.func,fullScreenDropZone:O.a.bool,containerWidth:O.a.number,single:O.a.bool,scrollable:O.a.bool,postId:O.a.number,disableLargeImageSources:O.a.bool,disabledDataSources:O.a.arrayOf(O.a.string)}),h()(Os,"defaultProps",{fullScreenDropZone:!0,onAddMedia:function(){},onScaleChange:function(){},scrollable:!1,source:"",disableLargeImageSources:!1,disabledDataSources:[]});t.a=Object(x.c)((function(e,t){var s=t.source,n=void 0===s?"":s,a=t.site;return{isConnected:_s(e,n),mediaValidationErrors:Object(Jt.a)(e,null==a?void 0:a.ID),needsKeyring:Is(e,n),selectedItems:Object(A.a)(e,null==a?void 0:a.ID)}}),{requestKeyringConnections:qt.c,setMediaLibrarySelectedItems:H.o})(Os)},"./my-sites/media-library/list-item-file-details.scss":function(e,t,s){},"./my-sites/media-library/list-item-video.scss":function(e,t,s){},"./my-sites/media-library/list-item.scss":function(e,t,s){},"./my-sites/media-library/list-item.tsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return se}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createClass.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/inherits.js"),b=s.n(f),g=s("../node_modules/@babel/runtime/helpers/createSuper.js"),j=s.n(g),v=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),y=s.n(v),_=s("../node_modules/lodash-es/isEqual.js"),I=s("../node_modules/lodash-es/noop.js"),O=s("../node_modules/react/index.js"),x=s.n(O),k=s("../node_modules/classnames/index.js"),E=s.n(k),w=s("./components/spinner/index.jsx"),S=s("./components/gridicon/index.tsx"),C=s("../node_modules/prop-types/index.js"),P=s.n(C),T=s("./lib/media/utils/url.js"),M=(s("./my-sites/media-library/list-item-file-details.scss"),function(e){b()(s,e);var t=j()(s);function s(){return d()(this,s),t.apply(this,arguments)}return p()(s,[{key:"render",value:function(){return x.a.createElement("div",{className:"media-library__list-item-file-details media-library__list-item-centered"},x.a.createElement("div",{className:"media-library__list-item-icon"},x.a.createElement(S.a,{icon:this.props.icon})),x.a.createElement("div",{className:"media-library__list-item-file-name",style:{fontSize:12*(1+this.props.scale)}},this.props.media.title),x.a.createElement("hr",{className:"media-library__list-item-details-separator"}),x.a.createElement("div",{className:"media-library__list-item-file-extension",style:{fontSize:9*(1+this.props.scale)}},(this.props.media.extension||"").toUpperCase()))}}]),s}(x.a.Component));y()(M,"displayName","MediaLibraryListItemFileDetails"),y()(M,"propTypes",{media:P.a.object,scale:P.a.number,icon:P.a.string}),y()(M,"defaultProps",{icon:"pages"});var D=s("./my-sites/media-library/media-image.tsx"),N=s("./lib/media/constants.js"),R=function(e){b()(s,e);var t=j()(s);function s(){var e;d()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),y()(h()(e),"state",{}),y()(h()(e),"getImageDimensions",(function(){return{width:e.props.media.width||e.state.imageWidth,height:e.props.media.height||e.state.imageHeight}})),y()(h()(e),"getImageStyle",(function(){var t=e.getImageDimensions();return{maxHeight:t.height>t.width?"none":"100%",maxWidth:t.height<t.width?"none":"100%"}})),y()(h()(e),"setUnknownImageDimensions",(function(t){var s=null;e.props.media.width||(s={imageWidth:t.target.clientWidth}),e.props.media.height||((s=s||{}).imageHeight=t.target.clientHeight),s&&e.setState(s)})),e}return p()(s,[{key:"render",value:function(){var e=Math.round(1/this.props.maxScale*this.state.maxSeenScale*this.props.maxImageWidth),t=Object(T.a)(this.props.media,{resize:"".concat(e,",").concat(e),size:this.props.thumbnailType===N.e&&"medium"});return t?x.a.createElement(D.a,{src:t,onLoad:this.setUnknownImageDimensions,alt:this.props.media.alt||this.props.media.title,style:this.getImageStyle(),className:"media-library__list-item-centered is-image",draggable:"false"}):x.a.createElement(M,{scale:this.props.scale,media:this.props.media,icon:"image"})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var s=t.maxSeenScale||0;return e.scale>s?{maxSeenScale:e.scale}:null}}]),s}(x.a.Component);y()(R,"propTypes",{media:P.a.object,scale:P.a.number,maxScale:P.a.number,maxImageWidth:P.a.number,thumbnailType:P.a.string}),y()(R,"defaultProps",{maxImageWidth:450,maxScale:N.g[N.g.length-1]});var L=s("../packages/photon/dist/esm/index.js"),A=(s("./my-sites/media-library/list-item-video.scss"),s("./my-sites/media-library/media-file.tsx")),U=function(e){b()(s,e);var t=j()(s);function s(){var e;d()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),y()(h()(e),"getHighestQualityThumbnail",(function(){if(e.props.media.thumbnails)return e.props.media.thumbnails.fmt_hd||e.props.media.thumbnails.fmt_dvd||e.props.media.thumbnails.fmt_std})),e}return p()(s,[{key:"render",value:function(){var e=this.getHighestQualityThumbnail();if(e){var t=this.props.thumbnailType===N.e?e:Object(L.a)(e,{width:this.props.maxImageWidth});return x.a.createElement(A.a,{src:t,component:V,placeholder:V})}return x.a.createElement(M,a()({},this.props,{icon:"video-camera"}))}}]),s}(x.a.Component);function V(e){var t=e.src,s={};return t&&(s.backgroundImage="url("+t+")"),x.a.createElement("div",{className:"media-library__list-item-video",style:s},x.a.createElement("span",{className:"media-library__list-item-icon media-library__list-item-centered"},x.a.createElement(S.a,{icon:"video-camera"})))}y()(U,"displayName","MediaLibraryListItemVideo"),y()(U,"propTypes",{media:P.a.object,maxImageWidth:P.a.number,thumbnailType:P.a.string}),y()(U,"defaultProps",{maxImageWidth:450});var q=function(e){b()(s,e);var t=j()(s);function s(){return d()(this,s),t.apply(this,arguments)}return p()(s,[{key:"render",value:function(){return x.a.createElement(M,a()({},this.props,{icon:"audio"}))}}]),s}(x.a.Component);y()(q,"displayName","MediaLibraryListItemDocument");var F=function(e){b()(s,e);var t=j()(s);function s(){return d()(this,s),t.apply(this,arguments)}return p()(s,[{key:"render",value:function(){return x.a.createElement(M,this.props)}}]),s}(x.a.Component);y()(F,"displayName","MediaLibraryListItemDocument");var z=s("./lib/media/utils/get-mime-prefix.js"),B=s("../packages/viewport/dist/esm/index.js"),W=s("../packages/i18n-calypso/dist/esm/index.js"),G=s("../node_modules/react-redux/es/index.js"),H=s("../node_modules/redux/es/redux.js"),Y=s("./components/popover/index.jsx"),K=s("./components/forms/form-checkbox/index.jsx"),Q=s("../packages/components/dist/esm/button/index.js"),X=s("./state/preferences/actions.js"),$=s("./state/preferences/selectors.js"),J=s("./state/ui/selectors/get-section-name.js"),Z=s("./components/data/query-preferences/index.jsx"),ee=function(e){b()(s,e);var t=j()(s);function s(){var e;d()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),y()(h()(e),"state",{isDismissed:!1,rememberDismiss:!0}),y()(h()(e),"setRenderContext",(function(t){t&&e.setState({renderContext:t})})),y()(h()(e),"toggleRememberDismiss",(function(){setTimeout((function(){e.setState({rememberDismiss:!e.state.rememberDismiss})}),0)})),y()(h()(e),"dismiss",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.remember;e.setState({isDismissed:!0}),e.props.onDismiss({remember:s})})),y()(h()(e),"renderPopover",(function(){var t=e.state,s=t.renderContext,n=t.isDismissed;if(s&&!n)return x.a.createElement(Y.a,{onClose:function(){return e.dismiss()},context:s,position:"bottom",isVisible:!Object(B.e)(),className:"popover__gallery-help is-dialog-visible"},x.a.createElement("div",{className:"editor-media-modal__gallery-help-content"},x.a.createElement("div",{className:"editor-media-modal__gallery-help-instruction"},x.a.createElement("span",{className:"editor-media-modal__gallery-help-icon"},x.a.createElement(S.a,{icon:"image-multiple",size:20})),x.a.createElement("span",{className:"editor-media-modal__gallery-help-text"},e.props.translate("Select more than one image to create a gallery."))),x.a.createElement("div",{className:"editor-media-modal__gallery-help-actions"},x.a.createElement("label",{className:"editor-media-modal__gallery-help-remember-dismiss"},x.a.createElement(K.a,{checked:e.state.rememberDismiss,onChange:e.toggleRememberDismiss}),x.a.createElement("span",null,e.props.translate("Don't show again"))),x.a.createElement(Q.a,{onClick:function(){return e.dismiss({remember:e.state.rememberDismiss})},compact:!0},e.props.translate("Got it",{context:"Button label",comment:"User clicks this to confirm that he has understood the text"})))))})),e}return p()(s,[{key:"render",value:function(){return"post-editor"!==this.props.sectionName||this.props.isMediaModalGalleryInstructionsDismissed?null:x.a.createElement("div",{ref:this.setRenderContext,className:"editor-media-modal__gallery-help"},x.a.createElement(Z.a,null),this.renderPopover())}}]),s}(x.a.PureComponent);y()(ee,"displayName","EditorMediaModalGalleryHelp"),y()(ee,"propTypes",{onDismiss:P.a.func,sectionName:P.a.string}),y()(ee,"defaultProps",{onDismiss:function(){}});var te=Object(G.c)((function(e){return{sectionName:Object(J.a)(e),isMediaModalGalleryInstructionsDismissed:Object($.b)(e,"mediaModalGalleryInstructionsDismissed")||Object($.b)(e,"mediaModalGalleryInstructionsDismissedForSession")}}),(function(e){return Object(H.bindActionCreators)({onDismiss:function(e){return e.remember?Object(X.b)("mediaModalGalleryInstructionsDismissed",!0):Object(X.c)("mediaModalGalleryInstructionsDismissedForSession",!0)}},e)}))(Object(W.c)(ee)),se=(s("./my-sites/media-library/list-item.scss"),function(e){b()(s,e);var t=j()(s);function s(){var e;d()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),y()(h()(e),"clickItem",(function(t){e.props.onToggle&&e.props.onToggle(e.props.media,t.shiftKey)})),y()(h()(e),"renderItem",(function(){var t;if(e.props.media){switch(Object(z.a)(e.props.media)){case"image":t=R;break;case"video":t=U;break;case"audio":t=q;break;default:t=F}return x.a.createElement(t,e.props)}})),e}return p()(s,[{key:"shouldComponentUpdate",value:function(e){return!(e.media===this.props.media&&e.scale===this.props.scale&&e.maxImageWidth===this.props.maxImageWidth&&e.thumbnailType===this.props.thumbnailType&&e.selectedIndex===this.props.selectedIndex&&Object(_.a)(e.style,this.props.style))}},{key:"render",value:function(){var e,t,s=this.props,n=s.media,i=s.scale,o=(s.maxImageWidth,s.thumbnailType,s.showGalleryHelp),l=s.selectedIndex,d=(s.onToggle,s.onEditItem,s.style),u=c()(s,["media","scale","maxImageWidth","thumbnailType","showGalleryHelp","selectedIndex","onToggle","onEditItem","style"]),p=null,m=E()("media-library__list-item",{"is-placeholder":!n,"is-selected":-1!==l,"is-transient":n&&n.transient,"is-small":i<=.125}),h=r()({width:100*i+"%"},d);return n&&n.file&&(e=n.file),-1!==l&&void 0!==l&&(p={"data-selected-number":(t=l+1)>99?"99+":t}),x.a.createElement("button",a()({className:m,style:h,onClick:this.clickItem},u,p),x.a.createElement("span",{className:"media-library__list-item-selected-icon"},x.a.createElement(S.a,{icon:"checkmark",size:18})),x.a.createElement("figure",{className:"media-library__list-item-figure",title:e},this.renderItem(),n&&n.transient&&x.a.createElement("div",{className:"media-library__list-item-spinner"},x.a.createElement(w.a,null)),o&&x.a.createElement(te,null)))}}]),s}(x.a.Component));y()(se,"defaultProps",{maxImageWidth:450,selectedIndex:-1,onToggle:I.a,onEditItem:I.a})},"./my-sites/media-library/style.scss":function(e,t,s){},"./my-sites/media-library/upload-button.scss":function(e,t,s){},"./my-sites/media-library/upload-url.scss":function(e,t,s){},"./my-sites/no-results/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("../node_modules/react/index.js"),a=s.n(n),i=s("../packages/i18n-calypso/dist/esm/index.js");s("./my-sites/no-results/style.scss");function r(e){var t=Object(i.h)(),s=e.image,n=e.text,r=void 0===n?t("No results."):n;return a.a.createElement("div",{className:"no-results"},s&&a.a.createElement("img",{className:"no-results__img",src:s,alt:""}),a.a.createElement("span",null,r))}},"./my-sites/no-results/style.scss":function(e,t,s){},"./post-editor/editor-diff-viewer/style.scss":function(e,t,s){},"./post-editor/editor-document-head/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/prop-types/index.js"),a=s.n(n),i=s("../node_modules/react/index.js"),r=s.n(i),o=s("../node_modules/react-redux/es/index.js"),c=s("../packages/i18n-calypso/dist/esm/index.js"),l=s("./components/data/document-head/index.jsx"),d=s("./components/data/query-post-types/index.jsx"),u=s("./state/ui/selectors/get-selected-site-id.js"),p=s("./state/editor/selectors.js"),m=s("./state/posts/selectors/get-edited-post-value.js"),h=s("./state/post-types/selectors.js");function f(e){var t,s=e.translate,n=e.siteId,a=e.type,i=e.typeObject,o=e.newPost;return t="post"===a?s(o?"New Post":"Edit Post",{textOnly:!0}):"page"===a?s(o?"New Page":"Edit Page",{textOnly:!0}):o?i?i.labels.new_item:s("New",{textOnly:!0}):i?i.labels.edit_item:s("Edit",{context:"verb",textOnly:!0}),r.a.createElement("div",null,n&&"page"!==a&&"post"!==a&&r.a.createElement(d.a,{siteId:n}),r.a.createElement(l.a,{title:t}))}f.propTypes={translate:a.a.func,siteId:a.a.number,type:a.a.string,typeObject:a.a.object,newPost:a.a.bool},t.a=Object(o.c)((function(e){var t=Object(u.a)(e),s=Object(p.f)(e),n=Object(m.a)(e,t,s,"type");return{siteId:t,type:n,typeObject:Object(h.a)(e,t,n),newPost:Object(p.m)(e)}}))(Object(c.c)(f))},"./post-editor/editor-media-modal/index.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/createClass.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../node_modules/prop-types/index.js"),j=s.n(g),v=s("../node_modules/react/index.js"),y=s.n(v),_=s("../node_modules/react-redux/es/index.js"),I=s("../node_modules/lodash-es/partial.js"),O=s("../node_modules/lodash-es/get.js"),x=s("../node_modules/lodash-es/map.js"),k=s("../node_modules/lodash-es/some.js"),E=s("./post-editor/media-modal/index.jsx"),w=s("./lib/media/utils/generate-gallery-shortcode.js"),S=s("./post-editor/media-modal/markup.js"),C=s("./state/analytics/actions/bump-stat.js"),P=s("./state/ui/selectors/get-selected-site.js"),T=s("./state/editor/save-blockers/actions.js"),M=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"onClose",(function(t){if(t)return e.props.isGutenberg?e.props.onClose(t):e.insertMedia(t);e.props.onClose()})),e}return c()(s,[{key:"insertMedia",value:function(e){var t,s,n=e.type,a=e.items,i=e.settings,r=this.props.site,o=Object(I.a)(S.a.get,r);switch(n){case"gallery":t="individual"===Object(O.a)(i,"type")?Object(x.a)(i.items,o).join(""):Object(w.a)(i),s="insert_gallery";break;case"media":default:t=Object(x.a)(a,o).join(""),s="insert_item"}Object(k.a)(a,"transient")&&this.props.blockSave("MEDIA_MODAL_TRANSIENT_INSERT"),t&&(this.props.onInsertMedia(t),s&&this.props.bumpStat("editor_media_actions",s)),this.props.onClose()}},{key:"render",value:function(){return y.a.createElement(E.default,a()({},this.props,{onClose:this.onClose}))}}]),s}(v.Component);b()(M,"propTypes",{site:j.a.object,onInsertMedia:j.a.func,onClose:j.a.func,isGutenberg:j.a.bool}),b()(M,"defaultProps",{onInsertMedia:function(){},onClose:function(){}}),t.a=Object(_.c)((function(e){return{site:Object(P.a)(e)}}),{blockSave:T.a,bumpStat:C.a})(M)},"./post-editor/editor-revisions-list/style.scss":function(e,t,s){},"./post-editor/editor-revisions/dialog.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("../node_modules/react-redux/es/index.js"),j=s("../node_modules/prop-types/index.js"),v=s.n(j),y=s("../packages/i18n-calypso/dist/esm/index.js"),_=s("../node_modules/lodash-es/get.js"),I=s("../node_modules/lodash-es/flow.js"),O=s("../packages/components/dist/esm/dialog/index.js"),x=s("./state/ui/selectors/get-selected-site-id.js"),k=s("./state/editor/selectors.js"),E=s("./lib/create-selector/index.js"),w=(s("./state/posts/init.js"),Object(E.a)((function(e,t,s,n){return Object(_.a)(e.posts.revisions.diffs,[t,s,"revisions",n],null)}),(function(e){return[e.posts.revisions.diffs]})));function S(e){return Object(_.a)(e,"posts.revisions.selection.revisionId")}function C(e){var t=Object(x.a)(e),s=Object(k.f)(e),n=S(e);return w(e,t,s,n)}function P(e){return Object(_.a)(e,"posts.revisions.ui.isDialogVisible",!1)}var T=s("./state/analytics/actions/record.js"),M=s("./state/posts/revisions/actions.js"),D=s("../node_modules/lodash-es/orderBy.js"),N=Object(E.a)((function(e,t,s){var n=Object(_.a)(e.posts.revisions.diffs,[t,s,"revisions"]);return Object(D.a)(n,["post_modified_gmt","id"],["desc","desc"])}),(function(e){return[e.posts.revisions.diffs]})),R=s("../node_modules/lodash-es/uniq.js"),L=s("../node_modules/lodash-es/map.js"),A=Object(E.a)((function(e,t,s){return Object(R.a)(Object(L.a)(Object(_.a)(e.posts.revisions.diffs,[t,s,"revisions"],{}),(function(e){return parseInt(e.post_author,10)})))}),(function(e){return[e.posts.revisions.diffs]}));function U(e,t,s,n,a){var i="".concat(n||0,":").concat(a||0);return Object(_.a)(e.posts.revisions.diffs,[t,s,i,"diff"],{})}var V=Object(E.a)((function(e,t,s){for(var n=N(e,t,s),a={},i=0;i<n.length;i++){var r=Object(_.a)(n,[i,"id"],0),o=r&&Object(_.a)(n,[i-1,"id"]),c=r&&Object(_.a)(n,[i+1,"id"]);a[r]={diff:U(e,t,s,c,r),nextRevisionId:o,prevRevisionId:c}}return a}),(function(e){return[e.posts.revisions.diffs]})),q=s("../packages/viewport/dist/esm/index.js"),F=s("../node_modules/classnames/index.js"),z=s.n(F),B=s("../node_modules/lodash-es/debounce.js"),W=s("../node_modules/lodash-es/throttle.js"),G=s("../node_modules/lodash-es/last.js"),H=s("../node_modules/lodash-es/head.js"),Y=s("../node_modules/lodash-es/has.js"),K=s("../node_modules/lodash-es/filter.js"),Q=s("./components/gridicon/index.tsx");function X(e){return Object(_.a)(e,"posts.revisions.ui.diffView","unified")}var $=s("./components/text-diff/index.jsx"),J=s("./lib/scroll-to/index.js"),Z=(s("./post-editor/editor-diff-viewer/style.scss"),function(e){return Object(_.a)(e,"offsetTop",0)+Object(_.a)(e,"offsetHeight",0)/2}),ee=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"state",{changeOffsets:[],scrollTop:0,viewportHeight:0}),h()(c()(e),"isBigViewport",!1),h()(c()(e),"lastScolledRevisionId",null),h()(c()(e),"tryScrollingToFirstChangeOrTop",(function(){e.props.selectedRevisionId&&e.props.selectedRevisionId!==e.lastScolledRevisionId&&(e.lastScolledRevisionId=e.props.selectedRevisionId,e.recomputeChanges((function(){e.centerScrollingOnOffset(e.state.changeOffsets[0]||0,!1)})))})),h()(c()(e),"recomputeChanges",(function(t){var s=".text-diff__additions, .text-diff__deletions";e.isBigViewport&&"split"===e.props.diffView&&(s=".editor-diff-viewer__secondary-pane .text-diff__additions, .editor-diff-viewer__main-pane .text-diff__deletions");var n=e.node.querySelectorAll(s);e.setState({changeOffsets:Object(L.a)(n,Z),viewportHeight:Object(_.a)(e.node,"offsetHeight",0),scrollTop:Object(_.a)(e.node,"scrollTop",0)},t)})),h()(c()(e),"debouncedRecomputeChanges",Object(B.a)((function(){e.isBigViewport=Object(q.f)(">1040px"),e.recomputeChanges(null)}),500)),h()(c()(e),"centerScrollingOnOffset",(function(t){var s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Math.max(0,t-e.state.viewportHeight/2);s?Object(J.a)({container:e.node,x:0,y:n}):e.node.scrollTop=n})),h()(c()(e),"handleScroll",(function(t){e.setState({scrollTop:Object(_.a)(t.target,"scrollTop",0)})})),h()(c()(e),"throttledScrollHandler",Object(W.a)(e.handleScroll,100)),h()(c()(e),"handleScrollableRef",(function(t){t?(e.node=t,e.node.addEventListener("scroll",e.throttledScrollHandler)):(e.node.removeEventListener("scroll",e.throttledScrollHandler),e.node=null)})),h()(c()(e),"scrollAbove",(function(){e.centerScrollingOnOffset(Object(G.a)(e.changesAboveViewport)),e.props.recordTracksEvent("calypso_editor_post_revisions_scroll_hint_used",{direction:"above"})})),h()(c()(e),"scrollBelow",(function(){e.centerScrollingOnOffset(Object(H.a)(e.changesBelowViewport)),e.props.recordTracksEvent("calypso_editor_post_revisions_scroll_hint_used",{direction:"below"})})),e}return r()(s,[{key:"componentDidMount",value:function(){this.tryScrollingToFirstChangeOrTop(),"undefined"!=typeof window&&(window.addEventListener("resize",this.debouncedRecomputeChanges),this.isBigViewport=Object(q.f)(">1040px"))}},{key:"componentWillUnmount",value:function(){"undefined"!=typeof window&&window.removeEventListener("resize",this.debouncedRecomputeChanges)}},{key:"componentDidUpdate",value:function(){this.tryScrollingToFirstChangeOrTop()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.selectedRevisionId!==this.props.selectedRevisionId&&this.setState({changeOffsets:[]}),e.diffView!==this.props.diffView&&this.recomputeChanges(null)}},{key:"render",value:function(){var e=this,t=this.props,s=t.diff,n=t.diffView,a=z()("editor-diff-viewer",{"is-loading":!Object(Y.a)(s,"post_content")&&!Object(Y.a)(s,"post_title"),"is-split":"split"===n}),i=this.state.scrollTop+this.state.viewportHeight;this.changesAboveViewport=Object(K.a)(this.state.changeOffsets,(function(t){return t<e.state.scrollTop})),this.changesBelowViewport=Object(K.a)(this.state.changeOffsets,(function(e){return e>i}));var r=this.state.viewportHeight>470,o=this.changesAboveViewport.length,c=this.changesBelowViewport.length;return b.a.createElement("div",{className:a},b.a.createElement("div",{className:"editor-diff-viewer__scrollable",ref:this.handleScrollableRef},b.a.createElement("div",{className:"editor-diff-viewer__main-pane"},b.a.createElement("h1",{className:"editor-diff-viewer__title"},b.a.createElement($.a,{operations:s.post_title})),b.a.createElement("pre",{className:"editor-diff-viewer__content"},b.a.createElement($.a,{operations:s.post_content,splitLines:!0}))),"split"===n&&b.a.createElement("div",{className:"editor-diff-viewer__secondary-pane"},b.a.createElement("h1",{className:"editor-diff-viewer__title"},b.a.createElement($.a,{operations:s.post_title})),b.a.createElement("pre",{className:"editor-diff-viewer__content"},b.a.createElement($.a,{operations:s.post_content,splitLines:!0})))),r&&o>0&&b.a.createElement("div",{className:"editor-diff-viewer__hint-above",onClick:this.scrollAbove},b.a.createElement(Q.a,{className:"editor-diff-viewer__hint-icon",size:18,icon:"arrow-up"}),this.props.translate("%(numberOfChanges)d change","%(numberOfChanges)d changes",{args:{numberOfChanges:o},count:o})),r&&c>0&&b.a.createElement("div",{className:"editor-diff-viewer__hint-below",onClick:this.scrollBelow},b.a.createElement(Q.a,{className:"editor-diff-viewer__hint-icon",size:18,icon:"arrow-down"}),this.props.translate("%(numberOfChanges)d change","%(numberOfChanges)d changes",{args:{numberOfChanges:c},count:c})))}}]),s}(f.PureComponent);h()(ee,"propTypes",{postId:v.a.number.isRequired,selectedRevisionId:v.a.number,siteId:v.a.number.isRequired,diff:v.a.shape({post_content:v.a.array,post_title:v.a.array,totals:v.a.object}).isRequired,diffView:v.a.string,recordTracksEvent:v.a.func.isRequired,translate:v.a.func.isRequired});var te=Object(I.a)(y.c,Object(g.c)((function(e,t){var s=t.siteId,n=t.postId,a=t.selectedRevisionId;return{revision:w(e,s,n,a,"display"),diffView:X(e)}}),{recordTracksEvent:T.e}))(ee),se=s("../node_modules/react-dom/index.js"),ne=s.n(se),ae=s("../node_modules/lodash-es/isEmpty.js"),ie=function(e){var t=e.numRevisions,s=e.translate;return b.a.createElement("div",{className:"editor-revisions-list__header"},b.a.createElement("span",{className:"editor-revisions-list__count"},!!t&&s("%(revisions)d revision","%(revisions)d revisions",{count:t,args:{revisions:t}})))};ie.propTypes={numRevisions:v.a.number.isRequired,translate:v.a.func.isRequired};var re=Object(y.c)(ie),oe=s("./components/segmented-control/index.jsx"),ce=function(e){var t=e.diffView,s=e.viewSplit,n=e.viewUnified,a=Object(y.h)();return b.a.createElement(oe.a,{compact:!0,className:"editor-revisions-list__view-buttons"},b.a.createElement(oe.a.Item,{className:"editor-revisions-list__unified-button",onClick:n,selected:"unified"===t},a("Unified")),b.a.createElement(oe.a.Item,{className:"editor-revisions-list__split-button",onClick:s,selected:"split"===t},a("Split")))};ce.propTypes={viewSplit:v.a.func.isRequired,viewUnified:v.a.func.isRequired,translate:v.a.func.isRequired};var le={viewUnified:M.g,viewSplit:M.f},de=Object(g.c)((function(e){return{diffView:X(e)}}),le)(ce),ue=s("../packages/components/dist/esm/button/index.js"),pe=s("./components/button-group/index.jsx"),me=function(e){var t=e.nextIsDisabled,s=e.prevIsDisabled,n=e.selectNextRevision,a=e.selectPreviousRevision;return b.a.createElement(pe.a,{className:"editor-revisions-list__navigation"},b.a.createElement(ue.a,{compact:!0,className:"editor-revisions-list__prev-button",type:"button",onClick:a,disabled:s},b.a.createElement(Q.a,{icon:"chevron-down"})),b.a.createElement(ue.a,{compact:!0,className:"editor-revisions-list__next-button",type:"button",onClick:n,disabled:t},b.a.createElement(Q.a,{icon:"chevron-up"})))};me.propTypes={selectNextRevision:v.a.func.isRequired,selectPreviousRevision:v.a.func.isRequired,nextIsDisabled:v.a.bool,prevIsDisabled:v.a.bool};var he=me;function fe(e,t){return e.posts.revisions.authors.items[t]}var be=s("./state/sites/selectors/is-single-user-site.js"),ge=s("./components/time-since/index.jsx"),je=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"selectRevision",(function(){e.props.selectPostRevision(e.props.revision.id)})),e}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.authorName,s=e.revision,n=e.revisionChanges,a=e.isMultiUserSite,i=e.translate,r=Object(_.a)(n,"add",0),o=Object(_.a)(n,"del",0),c={added:r&&i("%(changes)d word added","%(changes)d words added",{args:{changes:r},count:r}),removed:o&&i("%(changes)d word removed","%(changes)d words removed",{args:{changes:o},count:o})};return b.a.createElement("button",{className:"editor-revisions-list__button",onClick:this.selectRevision,type:"button"},b.a.createElement("span",{className:"editor-revisions-list__date"},b.a.createElement(ge.a,{date:Object(_.a)(s,"post_modified_gmt"),dateFormat:"lll"})),t&&a&&b.a.createElement("span",{className:"editor-revisions-list__author"},t),b.a.createElement("div",{className:"editor-revisions-list__changes"},r>0&&b.a.createElement("span",{className:"editor-revisions-list__additions","aria-label":c.added,title:c.added},b.a.createElement("b",null,"+"),r),o>0&&b.a.createElement("span",{className:"editor-revisions-list__deletions","aria-label":c.removed,title:c.removed},b.a.createElement("b",null,"-"),o),0===r&&0===o&&b.a.createElement("span",{className:"editor-revisions-list__minor-changes"},i("minor",{context:"post revisions: minor changes"}))))}}]),s}(f.PureComponent);je.propTypes={postId:v.a.number,revision:v.a.object.isRequired,revisionChanges:v.a.object.isRequired,siteId:v.a.number.isRequired,authorName:v.a.string,isMultiUserSite:v.a.bool.isRequired,selectPostRevision:v.a.func.isRequired,translate:v.a.func.isRequired};var ve=Object(I.a)(y.c,Object(g.c)((function(e,t){var s=t.revision,n=t.siteId;return{authorName:Object(_.a)(fe(e,Object(_.a)(s,"post_author")),"display_name",""),isMultiUserSite:!Object(be.a)(e,n)}}),{selectPostRevision:M.e}))(je),ye=s("./lib/keyboard-shortcuts/index.js"),_e=(s("./post-editor/editor-revisions-list/style.scss"),function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"selectRevision",(function(t){e.props.selectPostRevision(t)})),h()(c()(e),"trySelectingLatestRevision",(function(){var t=e.props.latestRevisionId;t&&e.selectRevision(t)})),h()(c()(e),"selectNextRevision",(function(){var t=e.props.nextRevisionId;t&&e.selectRevision(t)})),h()(c()(e),"selectPreviousRevision",(function(){var t=e.props.prevRevisionId;t&&e.selectRevision(t)})),e}return r()(s,[{key:"componentDidMount",value:function(){window.scrollTo(0,0),ye.a.on("move-selection-up",this.selectNextRevision),ye.a.on("move-selection-down",this.selectPreviousRevision),this.props.selectedRevisionId||this.trySelectingLatestRevision()}},{key:"componentWillUnmount",value:function(){ye.a.off("move-selection-up",this.selectNextRevision),ye.a.off("move-selection-down",this.selectPreviousRevision)}},{key:"componentDidUpdate",value:function(e){this.props.selectedRevisionId||this.trySelectingLatestRevision(),this.props.selectedRevisionId!==e.selectedRevisionId&&this.scrollToSelectedItem()}},{key:"scrollToSelectedItem",value:function(){var e=ne.a.findDOMNode(this),t=e.querySelector(".editor-revisions-list__scroller"),s=e.querySelector(".editor-revisions-list__revision.is-selected"),n=e.querySelector(".editor-revisions-list__list");if(t&&s&&n){var a=s.getBoundingClientRect(),i=a.top,r=a.right,o=a.bottom,c=a.left,l=n.getBoundingClientRect(),d=l.top,u=l.left,p=l.width,m=l.height,h=t.getBoundingClientRect(),f=h.top,b=h.bottom,g=h.height,j=h.left,v=h.right,y=h.width;if(p>m){var _=c<j,I=r>v,O=c-u,x=Math.abs(y-(r-u));(_||I)&&(t.scrollLeft=_?O:x)}else{var k=i<f,E=o>b,w=i-d,S=Math.abs(g-(o-d));(k||E)&&(t.scrollTop=k?w:S)}}}},{key:"render",value:function(){var e=this.props,t=e.comparisons,s=e.nextIsDisabled,n=e.prevIsDisabled,a=e.postId,i=e.revisions,r=e.selectedRevisionId,o=e.siteId,c=z()("editor-revisions-list",{"is-loading":Object(ae.a)(i)});return b.a.createElement("div",{className:c},b.a.createElement(re,{numRevisions:i.length}),b.a.createElement(de,null),b.a.createElement(he,{nextIsDisabled:s,prevIsDisabled:n,selectNextRevision:this.selectNextRevision,selectPreviousRevision:this.selectPreviousRevision}),b.a.createElement("div",{className:"editor-revisions-list__scroller"},b.a.createElement("ul",{className:"editor-revisions-list__list"},Object(L.a)(i,(function(e){var s=z()("editor-revisions-list__revision",{"is-selected":e.id===r}),n=Object(_.a)(t,[e.id,"diff","totals"],{});return b.a.createElement("li",{className:s,key:e.id},b.a.createElement(ve,{postId:a,revision:e,revisionChanges:n,siteId:o}))})))))}}]),s}(f.PureComponent));h()(_e,"propTypes",{comparisons:v.a.object,postId:v.a.number,siteId:v.a.number,revisions:v.a.array.isRequired,selectedRevisionId:v.a.number,nextIsDisabled:v.a.bool,prevIsDisabled:v.a.bool});var Ie=Object(g.c)((function(e,t){var s=t.comparisons,n=t.revisions,a=t.selectedRevisionId,i=Object(_.a)(s,[a],{}),r=i.nextRevisionId,o=i.prevRevisionId,c=Object(_.a)(Object(H.a)(n),"id"),l=c===a,d=!l&&Object(_.a)(Object(G.a)(n),"id")===a,u=l||1===n.length;return{latestRevisionId:c,prevIsDisabled:d||1===n.length,nextIsDisabled:u,nextRevisionId:r,prevRevisionId:o}}),{selectPostRevision:M.e})(_e),Oe=s("./state/posts/selectors/get-edited-post-value.js"),xe=function(e){d()(s,e);var t=p()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"componentDidMount",value:function(){this.request()}},{key:"componentDidUpdate",value:function(e){this.props.siteId===e.siteId&&this.props.postId===e.postId||this.request()}},{key:"request",value:function(){var e=this.props,t=e.comparisons,s=e.postId,n=e.postType,a=e.siteId;this.props.requestPostRevisions(a,s,n,t)}},{key:"render",value:function(){return null}}]),s}(f.Component);xe.propTypes={comparisons:v.a.array,postId:v.a.number,siteId:v.a.number,postType:v.a.string,requestPostRevisions:v.a.func};var ke=Object(g.c)((function(e,t){var s=t.postId,n=t.siteId;return{postType:Object(Oe.a)(e,n,s,"type")}}),{requestPostRevisions:M.d})(xe),Ee=s("../node_modules/@wordpress/is-shallow-equal/lib/index.js"),we=s.n(Ee),Se=s("./state/action-types.js"),Ce=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),Pe=s.n(Ce),Te=s("../node_modules/lodash-es/omitBy.js"),Me=s("../node_modules/lodash-es/isUndefined.js"),De=s("../node_modules/lodash-es/omit.js"),Ne=s("../node_modules/lodash-es/noop.js"),Re=s("./state/data-layer/wpcom-http/utils.js"),Le=s("./state/data-layer/wpcom-http/actions.js"),Ae=s("./state/data-layer/handler-registry.js"),Ue=function(e){return Object(Te.a)({ID:e.id,display_name:e.name,username:e.slug},Me.a)},Ve=function(e){var t=e.siteId,s=e.ids,n=e.page,a=void 0===n?1:n,i=e.perPage,r=void 0===i?10:i;return Object(Le.a)({path:"/sites/".concat(t,"/users"),method:"GET",apiNamespace:"wp/v2",query:{include:s,page:a,per_page:r}},e)},qe=Object(Re.a)({fetch:Ve,onSuccess:function(e,t){return function(s){s(function(e){return{type:Se.Um,users:e}}(Object(L.a)(t,Ue)));var n=e.page,a=void 0===n?1:n,i=e.perPage,r=void 0===i?10:i;Object(_.a)(Object(Re.b)(e),"X-WP-TotalPages",0)>a&&s(Ve(Pe()(Pe()({},Object(De.a)(e,"meta")),{},{page:a+1,perPage:r})))}},onError:Ne.a});Object(Ae.b)("state/data-layer/wpcom/sites/users/index.js",h()({},Se.Mm,[qe]));var Fe=function(e){d()(s,e);var t=p()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"componentDidMount",value:function(){this.request()}},{key:"componentDidUpdate",value:function(e){we()(this.props.userIds,e.userIds)&&this.props.siteId===e.siteId||this.request()}},{key:"request",value:function(){var e=this.props,t=e.siteId,s=e.userIds;s.length&&this.props.requestPostRevisionAuthors(t,s)}},{key:"render",value:function(){return null}}]),s}(f.Component);h()(Fe,"propTypes",{requestPostRevisionAuthors:v.a.func,siteId:v.a.number,userIds:v.a.arrayOf(v.a.number)});var ze=Object(g.c)(null,{requestPostRevisionAuthors:function(e,t){return{type:Se.Mm,ids:t,siteId:e}}})(Fe),Be=(s("./post-editor/editor-revisions/style.scss"),function(e){d()(s,e);var t=p()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"componentDidMount",value:function(){this.props.recordTracksEvent("calypso_editor_post_revisions_open")}},{key:"render",value:function(){var e=this.props,t=e.authorsIds,s=e.comparisons,n=e.postId,a=e.revisions,i=e.selectedDiff,r=e.selectedRevisionId,o=e.siteId;return b.a.createElement("div",{className:"editor-revisions"},b.a.createElement(ke,{postId:n,siteId:o,selectedRevisionId:r}),b.a.createElement(ze,{siteId:o,userIds:t}),b.a.createElement(te,{diff:i,postId:n,selectedRevisionId:r,siteId:o}),b.a.createElement(Ie,{comparisons:s,postId:n,revisions:a,selectedRevisionId:r,siteId:o}))}}]),s}(f.Component));Be.propTypes={authorsIds:v.a.array.isRequired,comparisons:v.a.object,postId:v.a.number.isRequired,revisions:v.a.array.isRequired,selectedDiff:v.a.object,selectedRevisionId:v.a.number,siteId:v.a.number.isRequired,recordTracksEvent:v.a.func.isRequired,translate:v.a.func.isRequired};var We=Object(I.a)(y.c,Object(g.c)((function(e){var t=Object(k.f)(e),s=Object(x.a)(e),n=N(e,s,t),a=S(e),i=V(e,s,t),r=Object(_.a)(i,[a,"diff"],{});return{authorsIds:A(e,s,t),comparisons:i,postId:t,revisions:n,selectedDiff:r,selectedRevisionId:a,siteId:s}}),{recordTracksEvent:T.e}))(Be),Ge=s("./components/close-on-escape/index.jsx"),He=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"onLoadClick",(function(){var t=e.props,s=t.loadRevision,n=t.revision,a=t.closeDialog;s(n),a(),e.props.recordTracksEvent("calypso_editor_post_revisions_load_revision")})),h()(c()(e),"dialogButtons",(function(){var t=e.props,s=t.postId,n=t.revision,a=t.siteId,i=t.translate;return[{action:"cancel",compact:!0,label:i("Cancel")},{action:"load",compact:!0,disabled:!(n&&s&&a),isPrimary:!0,label:i("Load",{context:"Load revision in editor"}),onClick:e.onLoadClick}]})),e}return r()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.toggleBodyClass({isVisible:this.props.isVisible}),this.props.selectPostRevision(null)}},{key:"UNSAFE_componentWillUpdate",value:function(e){var t=e.isVisible;this.toggleBodyClass({isVisible:t})}},{key:"toggleBodyClass",value:function(e){var t=e.isVisible;if("object"==typeof document&&Object(_.a)(document,"body.classList")){t?document.body.classList.add("showing-post-revisions-dialog"):document.body.classList.remove("showing-post-revisions-dialog")}}},{key:"render",value:function(){var e=this.props,t=e.isVisible,s=e.closeDialog;return b.a.createElement(O.a,{buttons:this.dialogButtons(),className:"editor-revisions__dialog",isVisible:t,onClose:s},b.a.createElement(Ge.a,{onEscape:s}),b.a.createElement(We,null))}}]),s}(f.PureComponent);h()(He,"propTypes",{loadRevision:v.a.func.isRequired,isVisible:v.a.bool.isRequired,closeDialog:v.a.func.isRequired,recordTracksEvent:v.a.func.isRequired,translate:v.a.func.isRequired});t.a=Object(I.a)(y.c,Object(g.c)((function(e){return{isVisible:P(e),postId:Object(k.f)(e),revision:C(e),siteId:Object(x.a)(e)}}),{recordTracksEvent:T.e,closeDialog:M.a,selectPostRevision:M.e}))(He)},"./post-editor/editor-revisions/style.scss":function(e,t,s){},"./post-editor/media-modal/content.jsx":function(e,t,s){"use strict";var n=s("../node_modules/react/index.js"),a=s.n(n),i=s("../node_modules/classnames/index.js"),r=s.n(i);s("./post-editor/media-modal/content.scss");t.a=function(e){var t=e.children,s=e.className;return a.a.createElement("div",{className:r()("editor-media-modal__content",s)},t)}},"./post-editor/media-modal/content.scss":function(e,t,s){},"./post-editor/media-modal/detail/detail-preview-media-file.tsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/slicedToArray.js"),a=s.n(n),i=s("../node_modules/react/index.js"),r=s.n(i),o=s("../packages/i18n-calypso/dist/esm/index.js"),c=s("./lib/media/utils/url.js"),l=s("./my-sites/media-library/media-file.tsx");t.a=Object(o.c)((function(e){var t=e.className,s=e.component,n=e.item,o=e.site,d=e.translate,u=Object(i.useState)(!1),p=a()(u,2),m=p[0],h=p[1];if(m){var f="".concat(o.URL,"/wp-login.php?redirect_to=").concat(n.URL);return r.a.createElement("div",{className:"editor-media-modal-detail__preview is-too-large"},d("Preview unavailable, {{a}}click here to open the file directly{{/a}}.",{components:{a:r.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:f})}}))}return r.a.createElement(l.a,{component:s,src:Object(c.a)(n,{}),maxSize:20971520,onError:function(){return h(!0)},controls:!0,className:t})}))},"./post-editor/media-modal/detail/detail-preview-video.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return A}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createClass.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../node_modules/prop-types/index.js"),j=s.n(g),v=s("../node_modules/react/index.js"),y=s.n(v),_=s("../node_modules/classnames/index.js"),I=s.n(_),O=s("./lib/media/utils/is-videopress-item.js"),x=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),k=s.n(x),E=s("../node_modules/lodash-es/get.js"),w=s("../node_modules/lodash-es/invoke.js"),S=s("../node_modules/lodash-es/noop.js"),C=s("../node_modules/debug/src/browser.js"),P=s.n(C),T=s("../packages/load-script/dist/esm/index.js"),M=P()("calypso:post-editor:videopress"),D="https://wordpress.com/wp-content/plugins/video/assets/js/next/videopress.js",N=function(e){p()(s,e);var t=h()(s);function s(){var e;c()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(k()(e),"setVideoInstance",(function(t){return e.video=t})),b()(k()(e),"onScriptLoaded",(function(t){var s=e.props,n=s.isPlaying,a=s.item,i=s.onScriptLoadError;if(t)return M("Script".concat(Object(E.a)(t,"src","")," failed to load.")),void i();var r=a.height,o=void 0===r?480:r,c=a.videopress_guid,l=a.width,d=void 0===l?854:l;c&&"undefined"!=typeof window&&window.videopress&&(e.player=window.videopress(c,e.video,{autoPlay:n,height:o,width:d}))})),b()(k()(e),"receiveMessage",(function(t){if(!t.origin||t.origin===location.origin){var s=t.data;s&&"videopress_loading_state"===s.event&&"state"in s&&"converting"in s&&("loaded"!==s.state||s.converting||e.props.onVideoLoaded())}})),e}return d()(s,[{key:"componentDidMount",value:function(){this.loadInitializeScript(),window.addEventListener("message",this.receiveMessage,!1)}},{key:"componentWillUnmount",value:function(){Object(T.c)(D,this.onScriptLoaded),this.destroy()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.isPlaying&&!e.isPlaying?this.pause():!this.props.isPlaying&&e.isPlaying&&this.play()}},{key:"componentDidUpdate",value:function(e){this.props.item.videopress_guid!==e.item.videopress_guid&&(this.destroy(),this.loadInitializeScript())}},{key:"shouldComponentUpdate",value:function(e){return this.props.item.videopress_guid!==e.item.videopress_guid}},{key:"loadInitializeScript",value:function(){Object(T.a)(D,this.onScriptLoaded)}},{key:"destroy",value:function(){if(window.removeEventListener("message",this.receiveMessage),this.player)for(Object(w.a)(this,"player.destroy");this.video.firstChild;)this.video.removeChild(this.video.firstChild)}},{key:"play",value:function(){Object(E.a)(this,"player.state")&&Object(w.a)(this,"player.state.play")}},{key:"pause",value:function(){if(Object(E.a)(this,"player.state")){Object(w.a)(this,"player.state.pause");var e=Object(w.a)(this,"player.state.videoAt");e&&this.props.onPause(e)}}},{key:"render",value:function(){var e=I()(this.props.className,"is-video");return y.a.createElement("div",{className:e,ref:this.setVideoInstance})}}]),s}(v.Component);b()(N,"propTypes",{className:j.a.string,isPlaying:j.a.bool,item:j.a.object.isRequired,onPause:j.a.func,onScriptLoadError:j.a.func,onVideoLoaded:j.a.func}),b()(N,"defaultProps",{isPlaying:!1,onPause:S.a,onScriptLoadError:S.a,onVideoLoaded:S.a});var R=N,L=s("./post-editor/media-modal/detail/detail-preview-media-file.tsx"),A=function(e){p()(s,e);var t=h()(s);function s(){return c()(this,s),t.apply(this,arguments)}return d()(s,[{key:"render",value:function(){if(Object(O.a)(this.props.item))return y.a.createElement(R,this.props);var e=this.props,t=e.className,s=r()(e,["className"]);return y.a.createElement(L.a,a()({component:"video",className:I()(t,"is-video")},s))}}]),s}(y.a.Component);b()(A,"displayName","EditorMediaModalDetailPreviewAudio"),b()(A,"propTypes",{className:j.a.string,item:j.a.object.isRequired,site:j.a.object.isRequired})},"./post-editor/media-modal/detail/index.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return Te}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/inherits.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/createSuper.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),h=s.n(m),f=s("../node_modules/prop-types/index.js"),b=s.n(f),g=s("../packages/i18n-calypso/dist/esm/index.js"),j=s("../node_modules/react/index.js"),v=s.n(j),y=s("../node_modules/react-redux/es/index.js"),_=s("../node_modules/lodash-es/noop.js"),I=s("../node_modules/lodash-es/partial.js"),O=s("../node_modules/classnames/index.js"),x=s.n(O),k=s("../node_modules/lodash-es/get.js"),E=s("../node_modules/lodash-es/includes.js"),w=s("../node_modules/lodash-es/flowRight.js"),S=s("../node_modules/url/url.js"),C=s.n(S),P=s("./components/gridicon/index.tsx"),T=s("./post-editor/media-modal/content.jsx"),M=s("../node_modules/react-dom/index.js"),D=s.n(M),N=s("../node_modules/lodash-es/debounce.js"),R=s("./lib/analytics/ga.js"),L=s("./lib/analytics/mc.js"),A=s("./lib/media/utils/get-mime-prefix.js"),U=s("./lib/media/utils/url.js"),V=s("./components/clipboard-button-input/index.jsx"),q=s("./components/forms/form-textarea/index.jsx"),F=s("./components/forms/form-text-input/index.jsx"),z=s("./components/track-input-changes/index.jsx"),B=s("./post-editor/media-modal/fieldset.jsx"),W=s("./state/media/thunks/index.js"),G=function(e){d()(s,e);var t=p()(s);function s(){var e;return a()(this,s),e=t.apply(this,arguments),h()(c()(e),"bumpTitleStat",(function(){Object(R.a)("Media","Changed Item Title"),Object(L.a)("calypso_media_edit_details","title")})),h()(c()(e),"bumpAltStat",(function(){Object(R.a)("Media","Changed Image Alt"),Object(L.a)("calypso_media_edit_details","alt")})),h()(c()(e),"bumpCaptionStat",(function(){Object(R.a)("Media","Changed Item Caption"),Object(L.a)("calypso_media_edit_details","caption")})),h()(c()(e),"bumpDescriptionStat",(function(){Object(R.a)("Media","Changed Item Description"),Object(L.a)("calypso_media_edit_details","description")})),h()(c()(e),"setFieldValue",(function(t){var s=t.target,n=Object.assign({ID:e.props.item.ID},Object(k.a)(e.state,"modifiedItem",{}),h()({},s.name,s.value));e.setState({modifiedItem:n}),e.persistChange()})),h()(c()(e),"scrollToShowVisibleDropdown",(function(e){e.open&&"scrollIntoView"in window.Element.prototype&&D.a.findDOMNode(e.target).scrollIntoView()})),e.persistChange=Object(N.a)(e.persistChange,1e3),e}return r()(s,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.item&&e.item&&e.item.ID!==this.props.item.ID&&(this.setState({modifiedItem:null}),this.persistChange.cancel())}},{key:"isMimePrefix",value:function(e){return Object(A.a)(this.props.item)===e}},{key:"persistChange",value:function(){this.props.site&&this.state.modifiedItem&&this.props.updateMedia(this.props.site.ID,this.state.modifiedItem)}},{key:"getItemValue",value:function(e){var t=Object(k.a)(this.state,["modifiedItem",e],null);return null!==t?t:this.props.item?this.props.item[e]:void 0}},{key:"renderImageAltText",value:function(){return this.isMimePrefix("image")?v.a.createElement(B.a,{legend:this.props.translate("Alt text")},v.a.createElement(z.a,{onNewValue:this.bumpAltStat},v.a.createElement(F.a,{name:"alt",value:this.getItemValue("alt"),onChange:this.setFieldValue}))):null}},{key:"render",value:function(){var e=this.props.translate;return v.a.createElement("div",{className:"editor-media-modal-detail__fields"},v.a.createElement(B.a,{legend:e("Title")},v.a.createElement(z.a,{onNewValue:this.bumpTitleStat},v.a.createElement(F.a,{name:"title",value:this.getItemValue("title"),onChange:this.setFieldValue}))),v.a.createElement(B.a,{legend:e("Caption")},v.a.createElement(z.a,{onNewValue:this.bumpCaptionStat},v.a.createElement(q.a,{name:"caption",value:this.getItemValue("caption"),onChange:this.setFieldValue}))),this.renderImageAltText(),v.a.createElement(B.a,{legend:e("Description")},v.a.createElement(z.a,{onNewValue:this.bumpDescriptionStat},v.a.createElement(q.a,{name:"description",value:this.getItemValue("description"),onChange:this.setFieldValue}))),v.a.createElement(B.a,{legend:e("URL")},v.a.createElement(V.a,{value:Object(U.a)(this.props.item)})))}}]),s}(j.Component);h()(G,"propTypes",{site:b.a.object,item:b.a.object});var H=Object(g.c)(Object(y.c)(null,{updateMedia:W.i})(G));function Y(e){if(!isNaN(e)){var t=Math.floor(e/3600),s=[Math.floor(e/60)%60,Math.floor(e)%60].map((function(e){return("0"+e).slice(-2)})).join(":");return t&&(s=[t,s].join(":")),-1===(s=s.replace(/^(00:)+/g,"")).indexOf(":")&&(s="0:"+s),s.replace(/^0(\d)(.*)/,"$1$2")}}var K=s("./components/localized-moment/index.js"),Q=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"getItemValue",(function(t){var s;if(!e.props.item)return e.props.translate("Loading");switch(t){case"extension":s=(e.props.item[t]||"").toUpperCase();break;case"dimensions":s=[v.a.createElement("abbr",{key:"width",title:e.props.translate("Width in pixels")},e.props.item.width),"  ",v.a.createElement("abbr",{key:"height",title:e.props.translate("Height in pixels")},e.props.item.height)];break;case"date":s=e.props.moment(e.props.item[t]).format("D MMMM YYYY");break;case"length":s=Y(e.props.item[t]);break;default:s=e.props.item[t]}return s})),h()(c()(e),"renderDimensions",(function(){if(e.props.item&&(e.props.item.width||e.props.item.height))return v.a.createElement("tr",null,v.a.createElement("th",null,e.props.translate("Dimensions")),v.a.createElement("td",null,e.getItemValue("dimensions")))})),h()(c()(e),"renderDuration",(function(){if(e.props.item&&e.props.item.length)return v.a.createElement("tr",null,v.a.createElement("th",null,e.props.translate("Duration")),v.a.createElement("td",null,e.getItemValue("length")))})),e}return r()(s,[{key:"render",value:function(){var e=x()("editor-media-modal-detail__file-info",{"is-loading":!this.props.item});return v.a.createElement("table",{className:e},v.a.createElement("tbody",null,v.a.createElement("tr",null,v.a.createElement("th",null,this.props.translate("File Name")),v.a.createElement("td",{title:this.getItemValue("file")},v.a.createElement("span",null,this.getItemValue("file")))),v.a.createElement("tr",null,v.a.createElement("th",null,this.props.translate("File Type")),v.a.createElement("td",null,this.getItemValue("extension"))),this.renderDimensions(),this.renderDuration(),v.a.createElement("tr",null,v.a.createElement("th",null,this.props.translate("Upload Date")),v.a.createElement("td",null,this.getItemValue("date")))))}}]),s}(v.a.Component);h()(Q,"displayName","EditorMediaModalDetailFileInfo"),h()(Q,"propTypes",{item:b.a.object});var X=Object(g.c)(Object(K.b)(Q)),$=s("./components/spinner/index.jsx"),J=s("./my-sites/media-library/media-image.tsx"),Z=s("./lib/media/utils/is-item-being-uploaded.js"),ee=function(e){d()(s,e);var t=p()(s);function s(e){var n;return a()(this,s),(n=t.call(this,e)).onImagePreloaderLoad=n.onImagePreloaderLoad.bind(c()(n)),n.state={loading:!1},n}return r()(s,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(this.props.item.URL===e.item.URL)return null;this.setState({loading:!0})}},{key:"onImagePreloaderLoad",value:function(){this.setState({loading:!1}),this.props.onLoad()}},{key:"render",value:function(){var e=Object(U.a)(this.props.item,{photon:this.props.site&&!this.props.site.is_private}),t=Object(Z.a)(this.props.item),s=this.state.loading,n=/^blob/.test(e),a=x()(this.props.className,"is-image",{"is-uploading":t},{"is-loading":s},{"is-blob":n}),i=x()(this.props.className,"is-image","is-fake",{"is-uploading":t},{"is-loading":s},{"is-blob":n});return v.a.createElement("div",null,v.a.createElement(J.a,{src:e,width:this.props.item.width,height:this.props.item.height,alt:this.props.item.alt||this.props.item.title,className:i}),v.a.createElement(J.a,{src:e,width:this.props.item.width,height:this.props.item.height,onLoad:this.onImagePreloaderLoad,placeholder:v.a.createElement("span",null),alt:this.props.item.alt||this.props.item.title,className:a}),(t||s)&&v.a.createElement($.a,null))}}]),s}(j.Component);h()(ee,"propTypes",{className:b.a.string,item:b.a.object.isRequired,site:b.a.object}),h()(ee,"defaultProps",{onLoad:_.a});var te=s("./post-editor/media-modal/detail/detail-preview-video.jsx"),se=s("../node_modules/@babel/runtime/helpers/extends.js"),ne=s.n(se),ae=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),ie=s.n(ae),re=s("./post-editor/media-modal/detail/detail-preview-media-file.tsx"),oe=function(e){d()(s,e);var t=p()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e=this.props,t=e.className,s=ie()(e,["className"]);return v.a.createElement(re.a,ne()({component:"audio",className:x()(t,"is-audio")},s))}}]),s}(v.a.Component);h()(oe,"displayName","EditorMediaModalDetailPreviewAudio"),h()(oe,"propTypes",{className:b.a.string,item:b.a.object.isRequired,site:b.a.object.isRequired});var ce=function(e){d()(s,e);var t=p()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){var e=x()(this.props.className,"is-document");return v.a.createElement("div",{className:e},v.a.createElement(P.a,{icon:"pages",size:120}))}}]),s}(v.a.Component);h()(ce,"displayName","EditorMediaModalDetailPreviewDocument"),h()(ce,"propTypes",{className:b.a.string});var le=s("../packages/components/dist/esm/button/index.js"),de=s("../packages/components/dist/esm/screen-reader-text/index.js"),ue=s("./components/data/query-jetpack-modules/index.jsx"),pe=s("./lib/version-compare/index.js"),me=s("./lib/media/utils/is-videopress-item.js"),he=s("./config/index.js"),fe=s("./state/ui/selectors/get-selected-site-id.js"),be=s("./state/sites/selectors/is-jetpack-site.js"),ge=s("./state/sites/selectors/get-site-option.js"),je=s("./state/sites/selectors/is-jetpack-module-active.js"),ve=s("./state/selectors/can-current-user.js"),ye=s("./state/selectors/is-private-site.ts"),_e=function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"handleOnRestoreClick",(function(){var t=e.props,s=t.site,n=t.item;(0,t.onRestore)(s&&s.ID,n)})),e}return r()(s,[{key:"shouldShowVideoEditingButtons",value:function(e){var t=this.props,s=t.isJetpack,n=t.isVideoPressEnabled,a=t.isVideoPressModuleActive;if(!Object(me.a)(e))return!1;if(s){if(!a)return!1}else if(!n)return!1;return!0}},{key:"shouldShowImageEditingButtons",value:function(e,t){var s=this.props.isSitePrivate;return!!e&&(!!he.a.isEnabled("post-editor/image-editor")&&(!s&&(!Object(k.a)(t,"jetpack",!1)||!Object(pe.a)(Object(k.a)(t,"options.jetpack_version","0.0"),"4.7-alpha","<"))))}},{key:"renderEditButton",value:function(){var e=this.props,t=e.item,s=e.onEdit,n=e.translate;if(!e.canUserUploadFiles)return null;var a=Object(A.a)(t);if(!Object(E.a)(["image","video"],a))return null;var i=n("video"===a?"Edit Thumbnail":"Edit Image");return v.a.createElement(le.a,{className:"editor-media-modal-detail__edit",onClick:s,disabled:Object(Z.a)(t)},v.a.createElement(P.a,{icon:"pencil",size:36})," ",i)}},{key:"renderRestoreButton",value:function(){var e=this.props,t=e.item,s=e.translate,n=C.a.parse(t.guid),a=C.a.parse(t.URL);return n.pathname!==a.pathname&&v.a.createElement(le.a,{className:x()("editor-media-modal-detail__restore"),onClick:this.handleOnRestoreClick,disabled:Object(Z.a)(t)},v.a.createElement(P.a,{icon:"refresh",size:36}),s("Restore Original"))}},{key:"renderMediaEditorButtons",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"is-desktop";if(!e)return null;var s=Object(A.a)(e);return"video"===s?this.renderVideoEditorButtons(e,t):this.renderImageEditorButtons(t)}},{key:"renderImageEditorButtons",value:function(e){var t=this.props,s=t.item,n=t.site;if(!this.shouldShowImageEditingButtons(s,n))return null;var a=x()("editor-media-modal-detail__edition-bar",e);return v.a.createElement("div",{className:a},this.renderRestoreButton(e),this.renderEditButton())}},{key:"renderVideoEditorButtons",value:function(e,t){if(!this.shouldShowVideoEditingButtons(e))return null;var s=x()("editor-media-modal-detail__edition-bar",t);return v.a.createElement("div",{className:s},this.renderEditButton())}},{key:"renderFields",value:function(){var e=this.props,t=e.site,s=e.item;return e.canUserUploadFiles?v.a.createElement(H,{site:t,item:s}):null}},{key:"renderPreviousItemButton",value:function(){var e=this.props,t=e.hasPreviousItem,s=e.onShowPreviousItem,n=e.translate;return t?v.a.createElement("button",{onClick:s,className:"editor-media-modal-detail__previous"},v.a.createElement(P.a,{icon:"chevron-left",size:36}),v.a.createElement(de.a,null,n("Previous"))):null}},{key:"renderNextItemButton",value:function(){var e=this.props,t=e.hasNextItem,s=e.onShowNextItem,n=e.translate;return t?v.a.createElement("button",{onClick:s,className:"editor-media-modal-detail__next"},v.a.createElement(P.a,{icon:"chevron-right",size:36}),v.a.createElement(de.a,null,n("Next"))):null}},{key:"renderItem",value:function(){var e,t=this.props,s=t.item,n=t.site;if(!s)return null;switch(Object(A.a)(s)){case"image":e=ee;break;case"video":e=te.a;break;case"audio":e=oe;break;default:e=ce}return v.a.createElement(e,{className:"editor-media-modal-detail__preview",site:n,item:s})}},{key:"render",value:function(){var e=this.props,t=e.isJetpack,s=e.item,n=e.siteId,a=x()("editor-media-modal-detail__item",{"is-loading":!s});return v.a.createElement("figure",{className:a},v.a.createElement(T.a,{className:"editor-media-modal-detail__content"},v.a.createElement("div",{className:"editor-media-modal-detail__preview-wrapper"},this.renderItem(),this.renderMediaEditorButtons(s),this.renderPreviousItemButton(),this.renderNextItemButton()),v.a.createElement("div",{className:"editor-media-modal-detail__sidebar"},t&&v.a.createElement(ue.a,{siteId:n}),this.renderMediaEditorButtons(s,"is-mobile"),this.renderFields(),v.a.createElement(X,{item:s}))))}}]),s}(j.Component);h()(_e,"propTypes",{site:b.a.object,item:b.a.object,hasPreviousItem:b.a.bool,hasNextItem:b.a.bool,onShowPreviousItem:b.a.func,onShowNextItem:b.a.func,onEdit:b.a.func,onRestore:b.a.func}),h()(_e,"defaultProps",{hasPreviousItem:!1,hasNextItem:!1,onShowPreviousItem:_.a,onShowNextItem:_.a,onEdit:_.a,onRestore:_.a});var Ie=Object(y.c)((function(e){var t=Object(fe.a)(e),s=Object(ve.b)(e,t,"upload_files");return{isJetpack:Object(be.a)(e,t),isVideoPressEnabled:Object(ge.a)(e,t,"videopress_enabled"),isVideoPressModuleActive:Object(je.a)(e,t,"videopress"),isSitePrivate:Object(ye.a)(e,t),siteId:t,canUserUploadFiles:s}})),Oe=Object(w.a)(Ie,g.c)(_e),xe=s("./lib/media/utils/filter-items-by-mime-prefix.js"),ke=s("./components/header-cake/index.jsx"),Ee=s("../node_modules/lodash-es/memoize.js"),we=Object(Ee.a)((function(e){(new window.Image).src=e})),Se=s("./state/ui/media-modal/constants.js"),Ce=s("./state/editor/actions.js"),Pe=(s("./post-editor/media-modal/detail/style.scss"),function(e){d()(s,e);var t=p()(s);function s(){var e;a()(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),h()(c()(e),"preloadImages",(function(){Object(xe.a)(e.props.items,"image").forEach((function(e){var t=Object(U.a)(e,{photon:this.props.site&&!this.props.site.is_private});we(t)}),c()(e))})),h()(c()(e),"incrementIndex",(function(t){e.props.onSelectedIndexChange(e.props.selectedIndex+t)})),e}return r()(s,[{key:"componentDidMount",value:function(){this.preloadImages()}},{key:"componentDidUpdate",value:function(){this.preloadImages()}},{key:"render",value:function(){var e=this.props,t=e.items,s=e.selectedIndex,n=e.site,a=e.backButtonText,i=e.onEditImageItem,r=e.onEditVideoItem,o=e.onRestoreItem,c=e.onReturnToList,l=e.translate,d=t[s],u=Object(A.a)(d);return v.a.createElement("div",{className:"editor-media-modal-detail"},v.a.createElement(ke.a,{onClick:c,backText:a||l("Media Library")}),v.a.createElement(Oe,{site:n,item:d,hasPreviousItem:s-1>=0,hasNextItem:s+1<t.length,onShowPreviousItem:this.incrementIndex.bind(this,-1),onShowNextItem:this.incrementIndex.bind(this,1),onRestore:o,onEdit:"video"===u?r:i}))}}]),s}(v.a.Component));h()(Pe,"propTypes",{site:b.a.object,items:b.a.array,selectedIndex:b.a.number,onSelectedIndexChange:b.a.func,onReturnToList:b.a.func,onEdit:b.a.func,onRestore:b.a.func}),h()(Pe,"defaultProps",{selectedIndex:0,onSelectedIndexChange:_.a});var Te=Object(g.c)(Pe);t.b=Object(y.c)(null,{onReturnToList:Object(I.a)(Ce.m,Se.a.LIST),onEditImageItem:Object(I.a)(Ce.m,Se.a.IMAGE_EDITOR),onEditVideoItem:Object(I.a)(Ce.m,Se.a.VIDEO_EDITOR)})(Te)},"./post-editor/media-modal/detail/style.scss":function(e,t,s){},"./post-editor/media-modal/dialog.jsx":function(e,t,s){"use strict";var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=s.n(i),o=s("../node_modules/react/index.js"),c=s.n(o),l=s("../node_modules/classnames/index.js"),d=s.n(l),u=s("../packages/components/dist/esm/dialog/index.js");s("./post-editor/media-modal/dialog.scss");t.a=function(e){var t=e.additionalClassNames,s=r()(e,["additionalClassNames"]);return c.a.createElement(u.a,a()({additionalClassNames:d()("editor-media-modal",t)},s))}},"./post-editor/media-modal/dialog.scss":function(e,t,s){},"./post-editor/media-modal/fieldset.jsx":function(e,t,s){"use strict";s.d(t,"a",(function(){return v}));var n=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/createClass.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/inherits.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/createSuper.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/prop-types/index.js"),h=s.n(m),f=s("../node_modules/react/index.js"),b=s.n(f),g=s("../node_modules/classnames/index.js"),j=s.n(g),v=(s("./post-editor/media-modal/fieldset.scss"),function(e){c()(s,e);var t=d()(s);function s(){return a()(this,s),t.apply(this,arguments)}return r()(s,[{key:"render",value:function(){return b.a.createElement("fieldset",{className:j()("editor-media-modal__fieldset",this.props.className)},b.a.createElement("legend",{className:"editor-media-modal__fieldset-legend"},this.props.legend),this.props.children)}}]),s}(b.a.Component));p()(v,"displayName","EditorMediaModalFieldset"),p()(v,"propTypes",{legend:h.a.oneOfType([h.a.string,h.a.element]).isRequired})},"./post-editor/media-modal/fieldset.scss":function(e,t,s){},"./post-editor/media-modal/gallery/style.scss":function(e,t,s){},"./post-editor/media-modal/index.jsx":function(e,t,s){"use strict";s.r(t),s.d(t,"EditorMediaModal",(function(){return ut}));var n=s("../node_modules/@babel/runtime/helpers/extends.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/classCallCheck.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/createClass.js"),c=s.n(o),l=s("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/inherits.js"),p=s.n(u),m=s("../node_modules/@babel/runtime/helpers/createSuper.js"),h=s.n(m),f=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),b=s.n(f),g=s("../node_modules/react/index.js"),j=s.n(g),v=s("../node_modules/prop-types/index.js"),y=s.n(v),_=s("../packages/i18n-calypso/dist/esm/index.js"),I=s("../node_modules/react-redux/es/index.js"),O=s("../node_modules/lodash-es/some.js"),x=s("../node_modules/lodash-es/uniqueId.js"),k=s("../node_modules/lodash-es/findIndex.js"),E=s("../node_modules/lodash-es/isEmpty.js"),w=s("../node_modules/lodash-es/head.js"),S=s("../node_modules/lodash-es/includes.js"),C=s("../node_modules/lodash-es/partial.js"),P=s("../node_modules/lodash-es/get.js"),T=s("../node_modules/lodash-es/values.js"),M=s("../node_modules/lodash-es/noop.js"),D=s("../node_modules/lodash-es/identity.js"),N=s("../node_modules/lodash-es/flow.js"),R=s("./my-sites/media-library/index.jsx"),L=s("./lib/analytics/ga.js"),A=s("./lib/analytics/mc.js"),U=s("./state/posts/stats/record-editor-event.js"),V=s("./state/posts/stats/record-editor-stat.js"),q=s("../node_modules/lodash-es/isEqual.js"),F=s("../node_modules/lodash-es/assign.js"),z=s("../node_modules/lodash-es/omitBy.js"),B=s("./components/header-cake/index.jsx"),W=s("./post-editor/media-modal/content.jsx"),G=s("./state/selectors/get-media-library-selected-items.js"),H=s("./my-sites/media-library/drop-zone.jsx"),Y=s("./lib/media/utils/filter-items-by-mime-prefix.js"),K=s("./state/media/actions.js"),Q=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"filterDroppedImagesSelected",(function(){var t=e.props,s=t.selectedItems,n=t.site;if(n){var a=Object(Y.a)(s,"image");Object(q.a)(s,a)||(e.props.setMediaLibrarySelectedItems(n.ID,a),e.props.onInvalidItemAdded())}})),e}return c()(s,[{key:"render",value:function(){return j.a.createElement(H.a,{site:this.props.site,onAddMedia:this.filterDroppedImagesSelected,fullScreen:!1})}}]),s}(j.a.Component);b()(Q,"propTypes",{site:y.a.object,onInvalidItemAdded:y.a.func}),b()(Q,"defaultProps",{onInvalidItemAdded:function(){}});var X=Object(I.c)((function(e,t){var s=t.site;return{selectedItems:Object(G.a)(e,null==s?void 0:s.ID)}}),{setMediaLibrarySelectedItems:K.o})(Q),$=s("../node_modules/lodash-es/fromPairs.js"),J=s("../node_modules/lodash-es/times.js"),Z=s("./post-editor/media-modal/fieldset.jsx"),ee=s("./components/select-dropdown/index.jsx"),te=s("./components/forms/form-checkbox/index.jsx"),se=s("./lib/media/constants.js"),ne=s("./lib/site/utils.js"),ae=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"getTypeOptions",(function(){var t=e.props.site,s={individual:e.props.translate("Individual Images"),default:e.props.translate("Thumbnail Grid")};return!t||t.jetpack&&!Object(ne.f)(t,"tiled-gallery")||Object(F.a)(s,{rectangular:e.props.translate("Tiled Mosaic"),square:e.props.translate("Square Tiles"),circle:e.props.translate("Circles"),columns:e.props.translate("Tiled Columns")}),!t||t.jetpack&&!Object(ne.f)(t,"shortcodes")||Object(F.a)(s,{slideshow:e.props.translate("Slideshow")}),s})),b()(d()(e),"getLinkOptions",(function(){return"individual"===e.props.settings.type?{}:{"":e.props.translate("Attachment Page"),file:e.props.translate("Media File"),none:e.props.translate("None")}})),b()(d()(e),"getSizeOptions",(function(){return Object(S.a)(se.c,e.props.settings.type)?{thumbnail:e.props.translate("Thumbnail"),medium:e.props.translate("Medium"),large:e.props.translate("Large"),full:e.props.translate("Full Size")}:{}})),b()(d()(e),"getColumnOptions",(function(){var t=Math.min(e.props.numberOfItems,9);return Object($.a)(Object(J.a)(t,(function(e){return[e+1,(e+1).toString()]})))})),b()(d()(e),"updateRandomOrder",(function(t){e.props.onUpdateSetting("orderBy",t.target.checked?"rand":null)})),b()(d()(e),"renderDropdown",(function(t,s,n){var a=e.props,i=a.settings,r=a.onUpdateSetting;if(Object.keys(s).length)return j.a.createElement(Z.a,{legend:t,className:"for-setting-"+n},j.a.createElement(ee.a,{selectedText:s[i[n]]},Object.keys(s).map((function(e){var t=s[e];return j.a.createElement(ee.a.Item,{key:"value-"+e,selected:e===i[n],onClick:function(){return r(n,isFinite(parseInt(e))?+e:e)}},t)}))))})),b()(d()(e),"renderColumnsOption",(function(){if(Object(S.a)(se.a,e.props.settings.type))return e.renderDropdown(e.props.translate("Columns"),e.getColumnOptions(),"columns")})),b()(d()(e),"renderRandomOption",(function(){var t=e.props.settings;if("individual"!==t.type)return j.a.createElement(Z.a,{legend:e.props.translate("Random Order")},j.a.createElement(te.a,{onChange:e.updateRandomOrder,checked:"rand"===t.orderBy}))})),e}return c()(s,[{key:"render",value:function(){var e=this.getTypeOptions(),t=this.getLinkOptions(),s=this.getSizeOptions();return j.a.createElement("div",{className:"editor-media-modal-gallery__fields"},this.renderDropdown(this.props.translate("Layout"),e,"type"),this.renderColumnsOption(),this.renderRandomOption(),this.renderDropdown(this.props.translate("Link To"),t,"link"),this.renderDropdown(this.props.translate("Size"),s,"size"))}}]),s}(j.a.Component);b()(ae,"propTypes",{site:y.a.object,settings:y.a.object,onUpdateSetting:y.a.func,numberOfItems:y.a.number}),b()(ae,"defaultProps",{settings:Object.freeze({}),onUpdateSetting:M.a,numberOfItems:0});var ie=Object(_.c)(ae),re=s("./components/notice/index.jsx"),oe=s("./components/segmented-control/index.jsx"),ce=s("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),le=s.n(ce),de=s("../node_modules/lodash-es/reverse.js"),ue=s("../node_modules/lodash-es/sortBy.js"),pe=s("../node_modules/lodash-es/map.js"),me=s("./components/ellipsis-menu/index.jsx"),he=s("./components/popover/menu-item.jsx"),fe=s("./components/forms/sortable-list/index.jsx"),be=s("./my-sites/media-library/list-item.tsx"),ge=s("./components/forms/form-text-input/index.jsx"),je=s("./state/media/thunks/index.js"),ve=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{caption:null}),b()(d()(e),"getValue",(function(){return null!==e.state.caption?e.state.caption:e.props.item?e.props.item.caption:void 0})),b()(d()(e),"setCaption",(function(t){e.setState({caption:t.target.value})})),b()(d()(e),"saveCaption",(function(){var t=e.props,s=t.siteId,n=t.item;if(s&&n){var a=e.getValue();n&&a===n.caption||e.props.updateMedia(s,Object.assign({},n,{caption:a}))}})),e}return c()(s,[{key:"render",value:function(){return j.a.createElement(ge.a,{value:this.getValue(),placeholder:this.props.translate("Caption this image"),onChange:this.setCaption,onBlur:this.saveCaption,onMouseDown:function(e){return e.stopPropagation()},className:"editor-media-modal-gallery__caption"})}}]),s}(j.a.Component);b()(ve,"displayName","EditorMediaModalGalleryCaption"),b()(ve,"propTypes",{siteId:y.a.number,item:y.a.object});var ye=Object(_.c)(Object(I.c)(null,{updateMedia:je.i})(ve)),_e=s("../node_modules/lodash-es/reject.js"),Ie=s("./components/gridicon/index.tsx"),Oe=s("../packages/components/dist/esm/screen-reader-text/index.js"),xe=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"remove",(function(){var t=e.props,s=t.siteId,n=t.itemId,a=t.selectedItems;if(s&&n){var i=Object(_e.a)(a,(function(e){return e.ID===n}));e.props.setMediaLibrarySelectedItems(s,i)}})),e}return c()(s,[{key:"render",value:function(){var e=this.props.translate;return j.a.createElement("button",{onClick:this.remove,onMouseDown:function(e){return e.stopPropagation()},className:"editor-media-modal-gallery__remove"},j.a.createElement(Oe.a,null,e("Remove")),j.a.createElement(Ie.a,{icon:"cross"}))}}]),s}(g.PureComponent);b()(xe,"propTypes",{siteId:y.a.number,itemId:y.a.number}),xe.displayName="RemoveButton";var ke=Object(I.c)((function(e,t){var s=t.siteId;return{selectedItems:Object(G.a)(e,s)}}),{setMediaLibrarySelectedItems:K.o})(Object(_.c)(xe)),Ee=s("./state/selectors/can-current-user.js"),we=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"renderCaption",(function(){var t=e.props,s=t.site,n=t.item;if(t.canUserUploadFiles)return j.a.createElement(ye,{siteId:s.ID,item:n})})),e}return c()(s,[{key:"render",value:function(){var e=this.props,t=e.site,s=e.item,n=e.showRemoveButton;return j.a.createElement("div",{className:"editor-media-modal-gallery__edit-item"},j.a.createElement(be.a,{media:s,scale:1,photon:!1}),this.renderCaption(),n&&j.a.createElement(ke,{siteId:t.ID,itemId:s.ID}))}}]),s}(g.Component);b()(we,"propTypes",{site:y.a.object,item:y.a.object,showRemoveButton:y.a.bool}),b()(we,"defaultProps",{showRemoveButton:!0});var Se=Object(I.c)((function(e,t){var s=t.site,n=void 0===s?{}:s;return{canUserUploadFiles:Object(Ee.b)(e,n.ID,"upload_files")}}))(we),Ce=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"onOrderChanged",(function(t){var s=[];e.props.settings.items.forEach((function(e,n){s[t[n]]=e})),e.props.onUpdateSetting({items:s,orderBy:null})})),e}return c()(s,[{key:"render",value:function(){var e,t=this.props,s=t.onUpdateSetting,n=t.site,a=t.settings,i=t.translate;if(!n||!a.items)return null;var r=(e={},b()(e,i("Reverse order"),Object(de.a)(le()(a.items))),b()(e,i("Order alphabetically"),Object(ue.a)(a.items,"title")),b()(e,i("Order chronologically"),Object(ue.a)(a.items,"date")),e);return j.a.createElement("div",null,j.a.createElement(me.a,{popoverClassName:"gallery__order-popover",position:"bottom right"},Object(pe.a)(r,(function(e,t){return j.a.createElement(he.a,{key:t,onClick:function(){return s({items:e})}},t)}))),j.a.createElement(fe.a,{onChange:this.onOrderChanged},a.items.map((function(e){return j.a.createElement(Se,{key:e.ID,site:n,item:e,showRemoveButton:a.items.length>1})}))))}}]),s}(j.a.Component);b()(Ce,"propTypes",{site:y.a.object,settings:y.a.object,onUpdateSetting:y.a.func}),b()(Ce,"defaultProps",{settings:Object.freeze({}),onUpdateSetting:M.a});var Pe=Object(_.c)(Ce),Te=s("../node_modules/classnames/index.js"),Me=s.n(Te),De=s("./lib/media/utils/generate-gallery-shortcode.js"),Ne=s("./components/gallery-shortcode/index.tsx"),Re=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{isLoading:!0,shortcode:Object(De.a)(e.props.settings)}),b()(d()(e),"isMounted",!1),b()(d()(e),"setLoaded",(function(){e.isMounted&&e.setState({isLoading:!1})})),e}return c()(s,[{key:"componentDidMount",value:function(){this.isMounted=!0}},{key:"componentWillUnmount",value:function(){this.isMounted=!1}},{key:"render",value:function(){var e=this.props,t=e.siteId,s=e.settings,n=this.state,a=n.isLoading,i=n.shortcode,r=Me()("editor-media-modal-gallery__preview-shortcode",{"is-loading":a||Object(O.a)(s.items,"transient")});return j.a.createElement("div",{className:r},j.a.createElement(Ne.a,{siteId:t,onLoad:this.setLoaded},i))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var s=Object(De.a)(e.settings);return t.shortcode===s?null:{isLoading:!0,shortcode:s}}}]),s}(j.a.Component);b()(Re,"propTypes",{siteId:y.a.number,settings:y.a.object});var Le=s("./post-editor/media-modal/markup.js"),Ae=s("./state/ui/selectors/get-selected-site.js"),Ue=function(e){p()(s,e);var t=h()(s);function s(){return r()(this,s),t.apply(this,arguments)}return c()(s,[{key:"render",value:function(){var e=this,t=this.props.items.map((function(t){var s=Le.a.caption(e.props.site,t);return null===s?j.a.createElement("div",{key:t.ID,dangerouslySetInnerHTML:{__html:Le.a.get(e.props.site,t)}}):j.a.cloneElement(s,{key:t.ID})}));return j.a.createElement("div",{className:"editor-media-modal-gallery__preview-individual"},j.a.createElement("div",{className:"editor-media-modal-gallery__preview-individual-content"},t))}}]),s}(j.a.Component);b()(Ue,"propTypes",{items:y.a.arrayOf(y.a.object),site:y.a.object});var Ve=Object(I.c)((function(e){return{site:Object(Ae.a)(e)}}))(Ue),qe=function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{isEditing:!1}),e}return c()(s,[{key:"renderPreviewModeToggle",value:function(){var e=this,t=this.props.translate;return j.a.createElement(oe.a,{className:"editor-media-modal-gallery__preview-toggle",compact:!0},j.a.createElement(oe.a.Item,{selected:!this.state.isEditing,onClick:function(){return e.setState({isEditing:!1})}},t("Preview")),j.a.createElement(oe.a.Item,{selected:this.state.isEditing,onClick:function(){return e.setState({isEditing:!0})}},t("Edit")))}},{key:"renderPreview",value:function(){var e=this.props,t=e.site,s=e.settings,n=e.onUpdateSetting;if(t&&s.items)return this.state.isEditing?j.a.createElement(Pe,{site:t,settings:s,onUpdateSetting:n}):"individual"===s.type?j.a.createElement(Ve,{items:s.items}):j.a.createElement(Re,{siteId:t.ID,settings:s})}},{key:"render",value:function(){var e=this.props.translate;return j.a.createElement("div",{className:"editor-media-modal-gallery__preview"},this.props.invalidItemDropped&&j.a.createElement(re.a,{status:"is-warning",onDismissClick:this.props.onDismissInvalidItemDropped,isCompact:!0},e("Galleries can only include images. All other uploads will be added to your media library.")),j.a.createElement("div",{className:"editor-media-modal-gallery__preview-wrapper"},this.renderPreview()),this.renderPreviewModeToggle())}}]),s}(g.Component);b()(qe,"propTypes",{site:y.a.object,settings:y.a.object,onUpdateSetting:y.a.func,invalidItemDropped:y.a.bool,onDismissInvalidItemDropped:y.a.func}),b()(qe,"defaultProps",{settings:Object.freeze({}),onUpdateSetting:M.a,invalidItemDropped:!1,onDismissInvalidItemDropped:M.a});var Fe=Object(_.c)(qe),ze=s("./state/ui/media-modal/constants.js"),Be=s("./state/editor/actions.js"),We=s("./state/media/thunks/get-media-item.js"),Ge=(s("./post-editor/media-modal/gallery/style.scss"),function(e){p()(s,e);var t=h()(s);function s(){var e;r()(this,s);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),b()(d()(e),"state",{invalidItemDropped:!1}),b()(d()(e),"reconcileSettingsItems",(function(t,s){var n=t.items.filter((function(e){return Object(O.a)(s,{ID:e.ID})})).concat(s.filter((function(e){return!Object(O.a)(t.items,{ID:e.ID})}))).map((function(t){return e.props.getMediaItem(e.props.site.ID,t.ID)}));Object(q.a)(n,t.items)||e.updateSetting("items",n)})),b()(d()(e),"maybeUpdateColumnsSetting",(function(){e.props.items.length<e.props.settings.columns&&e.updateSetting("columns",e.props.items.length)})),b()(d()(e),"setDefaultSettings",(function(){var t=e.props,s=t.site,n=t.settings,a=t.items,i=t.onUpdateSettings;if(!n){var r=Object(F.a)({},se.b,{items:a});!s||s.jetpack&&!Object(ne.f)(s,"tiled-gallery")||(r.type="rectangular"),i(r)}})),b()(d()(e),"updateSetting",(function(t,s){"string"==typeof t&&(t=b()({},t,s));var n=Object(F.a)({},e.props.settings,t);n=Object(z.a)(n,(function(e){return null===e})),e.props.onUpdateSettings(n)})),e}return c()(s,[{key:"UNSAFE_componentWillMount",value:function(){this.props.settings?(this.maybeUpdateColumnsSetting(),this.reconcileSettingsItems(this.props.settings,this.props.items)):this.setDefaultSettings()}},{key:"componentDidUpdate",value:function(e){this.props.settings&&(this.maybeUpdateColumnsSetting(),Object(q.a)(e.items,this.props.items)||this.reconcileSettingsItems(this.props.settings,this.props.items))}},{key:"render",value:function(){var e=this,t=this.props,s=t.site,n=t.items,a=t.settings;return j.a.createElement("div",{className:"editor-media-modal-gallery"},j.a.createElement(X,{site:s,onInvalidItemAdded:function(){return e.setState({invalidItemDropped:!0})}}),j.a.createElement(B.a,{onClick:this.props.onReturnToList,backText:this.props.translate("Media Library")}),j.a.createElement(W.a,{className:"editor-media-modal-gallery__content"},j.a.createElement(Fe,{site:s,items:n,settings:a,onUpdateSetting:this.updateSetting,invalidItemDropped:this.state.invalidItemDropped,onDismissInvalidItemDropped:function(){return e.setState({invalidItemDropped:!1})}}),j.a.createElement("div",{className:"editor-media-modal-gallery__sidebar"},j.a.createElement(ie,{site:s,settings:a,onUpdateSetting:this.updateSetting,numberOfItems:n.length}))))}}]),s}(j.a.Component));b()(Ge,"propTypes",{site:y.a.object,items:y.a.array,settings:y.a.object,onUpdateSettings:y.a.func,onReturnToList:y.a.func}),b()(Ge,"defaultProps",{onUpdateSettings:M.a});var He=Object(I.c)(null,{onReturnToList:Object(C.a)(Be.m,ze.a.LIST),getMediaItem:We.a})(Object(_.c)(Ge)),Ye=s("./lib/media/actions.js"),Ke=s("./lib/media/utils/is-item-being-uploaded.js"),Qe=s("./lib/media/utils/get-mime-prefix.js");var Xe=s("./lib/media/utils/get-mime-type.js"),$e=s("./components/close-on-escape/index.jsx"),Je=s("./lib/accept/index.js"),Ze=s("./state/ui/media-modal/selectors.js"),et=s("./state/sites/selectors/get-site.js"),tt=s("./state/editor/selectors.js"),st=s("./state/ui/media-modal/actions.js"),nt=s("./blocks/image-editor/index.jsx"),at=s("./blocks/video-editor/index.jsx"),it=s("./post-editor/media-modal/dialog.jsx"),rt=s("./post-editor/media-modal/detail/index.jsx"),ot=s("./state/analytics/actions/with-analytics.js"),ct=s("./state/analytics/actions/bump-stat.js"),lt=s("./state/analytics/actions/record.js");s("./post-editor/media-modal/index.scss");function dt(e,t,s){return!s(t)||Object(O.a)(t,(function(t){return Ke.a(t)&&("image"!==Qe.a(t)||!function(e){return!(!e||!e.URL)}(t)||e===ze.a.GALLERY)}))}var ut=function(e){p()(s,e);var t=h()(s);function s(e){var n;return r()(this,s),n=t.call(this,e),b()(d()(n),"confirmSelection",(function(){var e=n.props,t=e.view,s=e.selectedItems;if(!dt(t,s,n.props.isParentReady))if(s.length&&""!==n.state.source){var a=s.map((function(e){return Object.assign({},e,{ID:Object(x.a)("media-"),transient:!0})}));n.copyExternalAfterLoadingWordPressLibrary(a,n.state.source)}else{var i=s.length?{type:ze.a.GALLERY===t?"gallery":"media",items:s,settings:n.state.gallerySettings}:void 0;n.props.onClose(i)}})),b()(d()(n),"isTransientSelected",(function(){return n.props.selectedItems.some((function(e){return e.transient}))})),b()(d()(n),"setDetailSelectedIndex",(function(e){n.setState({detailSelectedIndex:e})})),b()(d()(n),"confirmDeleteMedia",(function(e){var t=n.props,s=t.site,a=t.selectedItems;if(s&&e){var i=a;ze.a.DETAIL===n.props.view&&(i=i[n.getDetailSelectedIndex()],n.setNextAvailableDetailView()),n.props.deleteMedia(s.ID,i),Object(A.a)("editor_media_actions","delete_media")}})),b()(d()(n),"deleteMedia",(function(){var e=n.props,t=e.view,s=e.selectedItems,a=e.translate,i=a("Are you sure you want to delete this item? Deleted media will no longer appear anywhere on your website, including all posts, pages, and widgets. This cannot be undone.","Are you sure you want to delete these items? Deleted media will no longer appear anywhere on your website, including all posts, pages, and widgets. This cannot be undone.",{count:ze.a.DETAIL===t?1:s.length});Object(Je.a)(i,n.confirmDeleteMedia,a("Delete"),null,{isScary:!0})})),b()(d()(n),"onAddMedia",(function(){n.props.recordEditorStat("media_explorer_upload"),n.props.recordEditorEvent("Upload Media")})),b()(d()(n),"onAddAndEditImage",(function(){n.props.setMediaLibrarySelectedItems(n.props.site.ID,[]),n.props.setView(ze.a.IMAGE_EDITOR)})),b()(d()(n),"restoreOriginalMedia",(function(e,t){e&&t&&(n.props.editMedia(e,{ID:t.ID,media_url:t.guid}),n.props.onRestoreMediaHook())})),b()(d()(n),"onImageEditorDone",(function(e,t,s){if(e)n.onImageEditorCancel(s);else{var a=s.fileName,i=s.site,r=s.ID,o=s.resetAllImageEditorState,c=s.width,l=s.height,d=Xe.a(a),u=Object.assign({ID:r,media:{fileName:a,fileContents:t,mimeType:d}},c&&{width:c},l&&{height:l});n.props.editMedia(i.ID,u),o(),n.props.setView(ze.a.DETAIL),n.props.onImageEditorDoneHook()}})),b()(d()(n),"handleUpdatePoster",(function(){n.props.setView(ze.a.DETAIL)})),b()(d()(n),"handleCancel",(function(){n.props.selectedItems[n.getDetailSelectedIndex()]?n.props.setView(ze.a.DETAIL):n.props.setView(ze.a.LIST)})),b()(d()(n),"onImageEditorCancel",(function(e){var t=e.resetAllImageEditorState;n.handleCancel(),t()})),b()(d()(n),"onFilterChange",(function(e){e!==n.state.filter&&Object(A.a)("editor_media_actions","filter_"+(e||"all")),n.setState({filter:e})})),b()(d()(n),"onScaleChange",(function(){n.statsTracking.scale||(Object(A.a)("editor_media_actions","scale"),n.statsTracking.scale=!0)})),b()(d()(n),"onSearch",(function(e){n.setState({search:e||void 0}),n.statsTracking.search||(Object(A.a)("editor_media_actions","search"),n.statsTracking.search=!0)})),b()(d()(n),"onSourceChange",(function(e){n.props.changeMediaSource(n.props.site.ID),n.setState({source:e,search:void 0,filter:""})})),b()(d()(n),"onClose",(function(){n.props.onClose()})),b()(d()(n),"editItem",(function(e){var t=n.props,s=t.site,a=t.selectedItems,i=t.single;if(s){var r=a;r.some((function(t){return t.ID===e.ID}))||(r=i?[e]:r.concat(e),n.props.setMediaLibrarySelectedItems(s.ID,r)),n.setDetailSelectedIndex(Object(k.a)(r,{ID:e.ID})),Object(A.a)("editor_media_actions","edit_button_contextual"),Object(L.a)("Media","Clicked Contextual Edit Button"),n.props.setView(ze.a.DETAIL)}})),b()(d()(n),"updateSettings",(function(e){n.setState({gallerySettings:e})})),n.state=n.getDefaultState(e),n}return c()(s,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.site&&this.props.visible&&!e.visible&&this.props.setMediaLibrarySelectedItems(e.site.ID,[]),this.props.visible!==e.visible&&(e.visible?(this.setState(this.getDefaultState(e)),e.source&&this.state.source!==e.source&&e.site&&this.props.changeMediaSource(e.site.ID)):this.props.resetView())}},{key:"componentDidMount",value:function(){this.statsTracking={}}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.view,s=e.selectedItems,n=e.site,a=e.single;Object(E.a)(s)||t!==ze.a.LIST&&!a||this.props.setMediaLibrarySelectedItems(n.ID,[])}},{key:"componentWillUnmount",value:function(){this.props.resetView(),this.props.setMediaLibrarySelectedItems(this.props.site.ID,[])}},{key:"getDefaultState",value:function(e){return{filter:"",detailSelectedIndex:0,source:e.source?e.source:"",gallerySettings:e.initialGallerySettings}}},{key:"copyExternalAfterLoadingWordPressLibrary",value:function(e,t){var s=this,n=this.props.site;this.props.changeMediaSource(n.ID),this.setState({source:"",search:void 0},(function(){Ye.a.setQuery(n.ID,{}),s.props.addExternalMedia(e,n,t)}))}},{key:"copyExternal",value:function(e,t){var s=this.props.site,n=!!this.state.search;n&&this.setState({search:""}),this.props.addExternalMedia(e,s,t),n&&Ye.a.setQuery(s.ID,{})}},{key:"setNextAvailableDetailView",value:function(){1===this.props.selectedItems.length?this.props.setView(ze.a.LIST):this.getDetailSelectedIndex()===this.props.selectedItems.length-1&&this.setDetailSelectedIndex(Math.max(this.getDetailSelectedIndex()-1,0))}},{key:"getDetailSelectedIndex",value:function(){var e=this.props.selectedItems,t=this.state.detailSelectedIndex;return t>=e.length?0:t}},{key:"getFirstEnabledFilter",value:function(){if(this.props.enabledFilters)return Object(w.a)(this.props.enabledFilters)}},{key:"getModalButtons",value:function(){if(!Object(S.a)([ze.a.IMAGE_EDITOR,ze.a.VIDEO_EDITOR],this.props.view)){var e=this.props.selectedItems,t=this.props.galleryViewEnabled,s=dt(this.props.view,e,this.props.isParentReady),n=[{action:"cancel",label:this.props.translate("Cancel")}];return""!==this.state.source?n.push({action:"confirm",label:this.props.labels.confirm||this.props.translate("Copy to media library"),isPrimary:!0,disabled:s||0===e.length,onClick:this.confirmSelection}):ze.a.GALLERY!==this.props.view&&e.length>1&&t&&!Object(O.a)(e,(function(e){return"image"!==Qe.a(e)}))?n.push({action:"confirm",label:this.props.translate("Continue"),isPrimary:!0,disabled:s||!this.props.site,onClick:Object(C.a)(this.props.setView,ze.a.GALLERY)}):n.push({action:"confirm",label:this.props.labels.confirm||this.props.translate("Insert"),isPrimary:!0,disabled:s||0===e.length||this.isTransientSelected(),onClick:this.confirmSelection}),n}}},{key:"shouldClose",value:function(){return!Object(S.a)([ze.a.IMAGE_EDITOR,ze.a.VIDEO_EDITOR],this.props.view)}},{key:"renderContent",value:function(){var e;switch(this.props.view){case ze.a.DETAIL:e=j.a.createElement(rt.b,{site:this.props.site,items:this.props.selectedItems,selectedIndex:this.getDetailSelectedIndex(),onRestoreItem:this.restoreOriginalMedia,onSelectedIndexChange:this.setDetailSelectedIndex});break;case ze.a.GALLERY:e=j.a.createElement(He,{site:this.props.site,items:this.props.selectedItems,settings:this.state.gallerySettings,onUpdateSettings:this.updateSettings});break;case ze.a.IMAGE_EDITOR:var t=this.props,s=t.site,n=t.imageEditorProps,i=t.selectedItems,r=this.getDetailSelectedIndex(),o=Object(P.a)(i,r,null);e=j.a.createElement(nt.a,a()({siteId:Object(P.a)(s,"ID"),media:o,onDone:this.onImageEditorDone,onCancel:this.onImageEditorCancel},n));break;case ze.a.VIDEO_EDITOR:var c=this.props.selectedItems,l=this.getDetailSelectedIndex(),d=Object(P.a)(c,l,null);e=j.a.createElement(at.a,{media:d,onCancel:this.handleCancel,onUpdatePoster:this.handleUpdatePoster});break;default:e=j.a.createElement(R.a,{site:this.props.site,filter:this.state.filter||this.props.defaultFilter||this.getFirstEnabledFilter(),enabledFilters:this.props.enabledFilters,search:this.state.search,source:this.state.source,onAddMedia:this.onAddMedia,onAddAndEditImage:this.onAddAndEditImage,onFilterChange:this.onFilterChange,onScaleChange:this.onScaleChange,onSourceChange:this.onSourceChange,onSearch:this.onSearch,onEditItem:this.editItem,fullScreenDropZone:!1,single:this.props.single,onDeleteItem:this.deleteMedia,onViewDetails:this.props.onViewDetails,postId:this.props.postId,disableLargeImageSources:this.props.disableLargeImageSources,disabledDataSources:this.props.disabledDataSources,scrollable:!0})}return e}},{key:"render",value:function(){return j.a.createElement(it.a,{isVisible:this.props.visible,buttons:this.getModalButtons(),onClose:this.onClose,isBackdropVisible:this.props.isBackdropVisible,shouldCloseOnOverlayClick:this.shouldClose(),shouldCloseOnEsc:!1},j.a.createElement($e.a,{onEscape:this.onClose}),this.renderContent())}}]),s}(g.Component);b()(ut,"propTypes",{visible:y.a.bool,selectedItems:y.a.arrayOf(y.a.object),onClose:y.a.func,isBackdropVisible:y.a.bool,isParentReady:y.a.func,site:y.a.object,siteId:y.a.number,labels:y.a.object,single:y.a.bool,defaultFilter:y.a.string,enabledFilters:y.a.arrayOf(y.a.string),view:y.a.oneOf(Object(T.a)(ze.a)),galleryViewEnabled:y.a.bool,setView:y.a.func,resetView:y.a.func,postId:y.a.number,disableLargeImageSources:y.a.bool,disabledDataSources:y.a.arrayOf(y.a.string),onImageEditorDoneHook:y.a.func,onRestoreMediaHook:y.a.func}),b()(ut,"defaultProps",{visible:!1,onClose:M.a,isBackdropVisible:!0,isParentReady:function(){return!0},labels:Object.freeze({}),setView:M.a,resetView:M.a,translate:D.a,view:ze.a.LIST,galleryViewEnabled:!0,imageEditorProps:{},deleteMedia:function(){},disableLargeImageSources:!1,disabledDataSources:[],onImageEditorDoneHook:M.a,onRestoreMediaHook:M.a});t.default=Object(I.c)((function(e,t){var s,n=t.site,a=t.siteId;return{view:Object(Ze.a)(e),site:n||Object(et.a)(e,a),postId:Object(tt.f)(e),selectedItems:Object(G.a)(e,null!==(s=null==n?void 0:n.ID)&&void 0!==s?s:a)}}),{setView:Be.m,resetView:st.a,deleteMedia:je.d,onViewDetails:Object(N.a)(Object(ot.a)(Object(ct.a)("editor_media_actions","edit_button_dialog")),Object(ot.a)(Object(lt.c)("Media","Clicked Dialog Edit Button")),Object(C.a)(Be.m,ze.a.DETAIL)),recordEditorEvent:U.a,recordEditorStat:V.a,editMedia:je.e,setMediaLibrarySelectedItems:K.o,addExternalMedia:je.a,changeMediaSource:K.a})(Object(_.c)(ut))},"./post-editor/media-modal/index.scss":function(e,t,s){},"./post-editor/media-modal/markup.js":function(e,t,s){"use strict";var n=s("../node_modules/lodash-es/assign.js"),a=s("../node_modules/react-dom/server.browser.js"),i=s.n(a),r=s("../node_modules/react/index.js"),o=s.n(r),c=s("../node_modules/classnames/index.js"),l=s.n(c),d=s("./lib/shortcode/index.js"),u=s("./lib/media/utils/get-mime-prefix.js"),p=s("./lib/media/utils/get-thumbnail-size-dimensions.js"),m=s("./lib/media/utils/url.js"),h=s("./lib/media/utils/is-videopress-item.js"),f=s("./lib/media-serialization/index.js"),b={get:function(e,t,s){if(!t||t.hasOwnProperty("status"))return"";var n=u.a(t);return n&&"function"==typeof b.mimeTypes[n]?b.mimeTypes[n](e,t,s):b.link(t)},link:function(e){var t=o.a.createElement("a",{href:e.URL,title:e.title},e.title);return i.a.renderToStaticMarkup(t)},caption:function(e,t){var s,n,a;"string"!=typeof t&&(t=b.get(e,t));var i=Object(d.b)(t);if(!i||!i.content)return null;var r=i.content.match(/((?:<a [^>]+>)?<img [^>]+>(?:<\/a>)?)([\s\S]*)/i);return r&&(s=r[1].trim(),n=r[2].trim()),(a=i.attrs.named.width)||(a=Object(f.a)(s).width),o.a.createElement("dl",{className:l()("wp-caption",i.attrs.named.align,i.attrs.named.classes),style:{width:parseInt(a,10)}},o.a.createElement("dt",{className:"wp-caption-dt",dangerouslySetInnerHTML:{__html:s}}),o.a.createElement("dd",{className:"wp-caption-dd"},n))},mimeTypes:{image:function(e,t,s){var a,r,c;if("full"===(s=Object(n.a)({size:"full",align:"none",forceResize:!1},s)).size)a=t.width,r=t.height;else{var u=p.a(s.size,e),h=Math.min(u.width/t.width||1/0,u.height/t.height||1/0);a=Math.round(t.width*h),r=Math.round(t.height*h)}c=s.forceResize||e&&!e.jetpack&&a&&a!==t.width?{maxWidth:a}:{size:s.size};var f=o.a.createElement("img",{src:m.a(t,c),alt:t.alt||t.title,width:isFinite(a)?a:null,height:isFinite(r)?r:null,className:l()("align"+s.align,"size-"+s.size,"wp-image-"+t.ID),"data-istransient":t.transient?"istransient":null}),b=i.a.renderToStaticMarkup(f);return t.caption&&a&&(b=Object(d.c)({tag:"caption",attrs:{id:"attachment_"+t.ID,width:a},content:[b,t.caption].join(" ")})),b},audio:function(e,t){return Object(d.c)({tag:"audio",attrs:{src:t.URL}})},video:function(e,t){return h.a(t)?Object(d.c)({tag:"wpvideo",attrs:[t.videopress_guid],type:"single"}):Object(d.c)({tag:"video",attrs:{src:t.URL,height:t.height,width:t.width}})}}};t.a=b},"./state/analytics/actions/enhance-with-site-type.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("../node_modules/lodash-es/set.js"),a=s("./state/action-types.js"),i=s("./state/ui/selectors/get-selected-site.js");function r(e,t){var s=Object(i.a)(t());return null!==s&&(e.type===a.A?Object(n.a)(e,"meta.analytics[0].payload.properties.site_type",s.jetpack?"jetpack":"wpcom"):Object(n.a)(e,"meta.analytics[0].payload.site_type",s.jetpack?"jetpack":"wpcom")),e}},"./state/analytics/actions/record-with-client-id.js":function(e,t,s){"use strict";s.d(t,"b",(function(){return l})),s.d(t,"a",(function(){return d}));var n=s("../node_modules/lodash-es/set.js"),a=s("./state/action-types.js"),i=s("./state/oauth2-clients/ui/selectors.js"),r=s("./state/utils/with-enhancers.js"),o=s("./state/analytics/actions/record.js"),c=function(e,t){var s=Object(i.b)(t());return s&&(e.type===a.A?Object(n.a)(e,"meta.analytics[0].payload.properties.client_id",s):Object(n.a)(e,"meta.analytics[0].payload.client_id",s)),e},l=Object(r.a)(o.e,c),d=Object(r.a)(o.d,c)},"./state/desktop/actions.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"c",(function(){return i})),s.d(t,"b",(function(){return r}));var n=s("./state/action-types.js"),a=function(e,t,s){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:n.ob,site:e,reason:t,editorUrl:s,wpAdminLoginUrl:a}},i=function(e){return{type:n.Yd,url:e}},r=function(e,t){return{type:n.np,title:e,contents:t}}},"./state/editor/actions.js":function(e,t,s){"use strict";s.d(t,"o",(function(){return I})),s.d(t,"n",(function(){return O})),s.d(t,"p",(function(){return x})),s.d(t,"j",(function(){return k})),s.d(t,"m",(function(){return E})),s.d(t,"k",(function(){return w})),s.d(t,"l",(function(){return S})),s.d(t,"b",(function(){return C})),s.d(t,"a",(function(){return P})),s.d(t,"c",(function(){return T})),s.d(t,"g",(function(){return M})),s.d(t,"d",(function(){return D})),s.d(t,"f",(function(){return N})),s.d(t,"i",(function(){return R})),s.d(t,"e",(function(){return L})),s.d(t,"h",(function(){return A}));var n,a=s("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),i=s.n(a),r=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(r),c=s("../node_modules/lodash-es/defaults.js"),l=s("../node_modules/lodash-es/filter.js"),d=s("../node_modules/lodash-es/get.js"),u=s("./lib/wp/browser.js"),p=s("./state/action-types.js"),m=s("./state/ui/media-modal/constants.js"),h=s("./state/ui/media-modal/actions.js"),f=s("./state/analytics/actions/with-analytics.js"),b=s("./state/analytics/actions/bump-stat.js"),g=s("./state/analytics/actions/record.js"),j=s("./state/preferences/actions.js"),v=s("./state/preferences/selectors.js"),y=s("./state/posts/actions/edit-post.js"),_=(s("./state/editor/init.js"),n={},o()(n,m.a.LIST,"view_list"),o()(n,m.a.DETAIL,"view_detail"),o()(n,m.a.GALLERY,"view_gallery"),o()(n,m.a.IMAGE_EDITOR,"view_edit"),o()(n,m.a.VIDEO_EDITOR,"view_edit"),n);function I(e,t){return function(s){s(N({isLoading:!0})),s({type:p.Td,siteId:e,postId:t})}}function O(e,t){return function(s){var n=Object(c.a)(t,{status:"draft",type:"post",content:"",title:""});s(N({isLoading:!0})),s({type:p.Td,siteId:e,postId:null}),s(Object(y.a)(e,null,n)),s(N())}}function x(e,t){return function(s){s(N()),s({type:p.Ud,siteId:e,postId:t})}}function k(e){return{type:p.Nd,source:e}}function E(e){var t=Object(h.b)(e),s=_[e];return s?Object(f.a)(Object(b.a)("editor_media_actions",s),t):t}function w(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(s,n){var a=Object(v.b)(n(),"editorConfirmationDisabledSites");s(t?Object(j.b)("editorConfirmationDisabledSites",Object(l.a)(a,(function(t){return e!==t}))):Object(j.b)("editorConfirmationDisabledSites",[].concat(i()(a),[e]))),s(Object(g.e)(t?"calypso_publish_confirmation_preference_enable":"calypso_publish_confirmation_preference_disable")),s(Object(b.a)("calypso_publish_confirmation",t?"enabled":"disabled"))}}var S=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{type:p.Jd,isIframeLoaded:e}},C=function(){return{type:p.yd}},P=function(e){return function(t){if(!e.ID)return Promise.reject(new Error("NO_AUTOSAVE"));t({type:p.wd});var s=u.a.undocumented().site(e.site_ID).postAutosave(e.ID,{content:e.content,title:e.title,excerpt:e.excerpt});return s.then((function(e){return t(function(e){return{type:p.zd,autosave:e}}(e))})).catch((function(e){return t(function(e){return{type:p.xd,error:e}}(e))})),s}};function T(e){return{type:p.Id,content:e}}function M(){return{type:p.Pd}}function D(e){return{type:p.Kd,content:e}}function N(e){return{type:p.Od,isLoading:Object(d.a)(e,"isLoading",!1),loadingError:Object(d.a)(e,"loadingError",null)}}function R(e){return N({loadingError:e})}function L(){return{type:p.Md}}var A=function(e,t,s){return{type:p.Qd,siteId:e,postId:t,saveMarker:s}}},"./state/editor/image-editor/actions.js":function(e,t,s){"use strict";s.d(t,"f",(function(){return a})),s.d(t,"e",(function(){return i})),s.d(t,"d",(function(){return r})),s.d(t,"c",(function(){return o})),s.d(t,"g",(function(){return c})),s.d(t,"i",(function(){return l})),s.d(t,"j",(function(){return d})),s.d(t,"h",(function(){return u})),s.d(t,"a",(function(){return p})),s.d(t,"b",(function(){return m})),s.d(t,"k",(function(){return h}));var n=s("./state/action-types.js");s("./state/editor/init.js");function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:n.Dg,additionalData:e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:n.Eg,additionalData:e}}function r(){return{type:n.yg}}function o(){return{type:n.wg}}function c(e){return{type:n.zg,ratio:e}}function l(e){return{type:n.Bg,ratio:e}}function d(e,t,s,a){return{type:n.Cg,src:e,fileName:t,mimeType:s,title:a}}function u(e,t,s,a){return{type:n.Ag,topBound:e,leftBound:t,bottomBound:s,rightBound:a}}function p(e,t,s,a){return{type:n.ug,topRatio:e,leftRatio:t,widthRatio:s,heightRatio:a}}function m(e,t,s,a){return{type:n.vg,topRatio:e,leftRatio:t,widthRatio:s,heightRatio:a}}function h(e,t){return{type:n.xg,width:e,height:t}}},"./state/editor/image-editor/selectors.js":function(e,t,s){"use strict";s.d(t,"e",(function(){return n})),s.d(t,"d",(function(){return a})),s.d(t,"f",(function(){return i})),s.d(t,"g",(function(){return r})),s.d(t,"c",(function(){return o})),s.d(t,"b",(function(){return c})),s.d(t,"a",(function(){return l}));s("./state/editor/init.js");function n(e){return e.editor.imageEditor.transform}function a(e){return e.editor.imageEditor.fileInfo}function i(e){return e.editor.imageEditor.hasChanges}function r(e){return!e.editor.imageEditor.imageIsLoading}function o(e){return e.editor.imageEditor.cropBounds}function c(e){return e.editor.imageEditor.crop}function l(e){return e.editor.imageEditor.aspectRatio}},"./state/editor/save-blockers/actions.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return i}));var n=s("./state/action-types.js"),a=(s("./state/editor/init.js"),function(e){return{type:n.Rd,key:e}}),i=function(e){return{type:n.Sd,key:e}}},"./state/guided-tours/actions.js":function(e,t,s){"use strict";s.d(t,"c",(function(){return c})),s.d(t,"a",(function(){return l})),s.d(t,"d",(function(){return d})),s.d(t,"e",(function(){return u})),s.d(t,"b",(function(){return p})),s.d(t,"f",(function(){return m}));var n=s("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=s.n(n),i=s("./state/action-types.js"),r=s("./state/preferences/actions.js"),o=s("./state/preferences/selectors.js");s("./state/guided-tours/init.js");function c(e){var t=e.tour,s=e.stepName,n=e.finished,c={type:i.af,shouldShow:!1,shouldReallyShow:!1,tour:t,stepName:s,finished:n};return function(e,s){e(function(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(r.b)("guided-tours-history",[].concat(a()(Object(o.b)(e(),"guided-tours-history")),[{timestamp:Date.now(),tourName:t,finished:s}]))}(s,t,n)),e(c)}}function l(e){var t=e.tour,s=e.stepName;return{type:i.af,tour:t,stepName:s,isPaused:!1}}function d(e){return l({tour:e,stepName:"init"})}function u(){return Object(r.b)("guided-tours-history",[])}function p(){return{type:i.Ye,isPaused:!0}}function m(){return{type:i.Ze,isPaused:!1}}},"./state/guided-tours/contexts/is-enabled.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("./config/index.js"),a=function(e){return function(){return n.a.isEnabled(e)}}},"./state/guided-tours/contexts/is-selected-site-previewable.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("../node_modules/lodash-es/get.js"),a=s("./state/ui/selectors/get-selected-site.js"),i=function(e){return Object(n.a)(Object(a.a)(e),"is_previewable",!1)}},"./state/guided-tours/contexts/new-user.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return r}));var n=s("./state/guided-tours/contexts/user-registration-time.js"),a=6048e5,i=function(e){return Object(n.a)(a)(e)},r=function(e){return!i(e)}},"./state/guided-tours/contexts/user-registration-time.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("./state/current-user/selectors.js"),a=function(e){var t=Object(n.b)(e),s=t&&Date.parse(t.date);return!!s&&Date.now()-s},i=function(e){return function(t){var s=a(t);return!1!==s&&s<=e}}},"./state/guided-tours/init.js":function(e,t,s){"use strict";var n=s("./state/redux-store.ts"),a=s("../node_modules/lodash-es/omit.js"),i=s("./state/action-types.js"),r=s("./state/utils/with-storage-key.js");var o=Object(r.a)("guidedTours",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.af:case i.Ye:case i.Ze:return Object.assign({},e,Object(a.a)(t,"type"))}return e}));Object(n.a)(["guidedTours"],o)},"./state/guided-tours/selectors/get-tours-history.js":function(e,t,s){"use strict";var n=s("./state/preferences/selectors.js");s("./state/guided-tours/init.js");t.a=function(e){return Object(n.b)(e,"guided-tours-history")}},"./state/guided-tours/selectors/index.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return ie}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),r=s.n(i),o=s("../node_modules/lodash-es/flatMap.js"),c=s("../node_modules/lodash-es/uniq.js"),l=s("../node_modules/lodash-es/startsWith.js"),d=s("../node_modules/lodash-es/map.js"),u=s("../node_modules/lodash-es/pick.js"),p=s("../node_modules/lodash-es/find.js"),m=s("../node_modules/lodash-es/difference.js"),h=s("../node_modules/lodash-es/constant.js"),f=s("../node_modules/lodash-es/includes.js"),b=s("../node_modules/lodash-es/findLast.js"),g=s("../node_modules/lodash-es/get.js"),j=s("../node_modules/debug/src/browser.js"),v=s.n(j),y=s("./state/action-types.js"),_=s("./state/ui/selectors/get-section-name.js"),I=s("./state/ui/selectors/get-section-group.js"),O=s("./state/selectors/get-current-query-arguments.js"),x=s("./state/selectors/get-initial-query-arguments.js"),k=s("./state/ui/action-log/selectors.js"),E=s("./state/preferences/selectors.js"),w=s("./layout/guided-tours/tours/main-tour/meta.js"),S=s("./layout/guided-tours/tours/tutorial-site-preview-tour/meta.js"),C=s("./layout/guided-tours/tours/gdocs-integration-tour/meta.js"),P=s("./layout/guided-tours/tours/simple-payments-tour/meta.js"),T=s("./layout/guided-tours/tours/editor-basics-tour/meta.js"),M=s("./layout/guided-tours/tours/marketing-connections-tour/meta.js"),D=s("./layout/guided-tours/tours/media-basics-tour/meta.js"),N=s("./layout/guided-tours/tours/checklist-site-title-tour/meta.js"),R=s("./layout/guided-tours/tours/jetpack-backups-rewind-tour/meta.js"),L=s("./layout/guided-tours/tours/jetpack-checklist-tour/meta.js"),A=s("./layout/guided-tours/tours/jetpack-lazy-images-tour/meta.js"),U=s("./layout/guided-tours/tours/jetpack-monitoring-tour/meta.js"),V=s("./layout/guided-tours/tours/jetpack-plugin-updates-tour/meta.js"),q=s("./layout/guided-tours/tours/jetpack-search-tour/meta.js"),F=s("./layout/guided-tours/tours/jetpack-sign-in-tour/meta.js"),z=s("./layout/guided-tours/tours/jetpack-site-accelerator-tour/meta.js"),B=s("./layout/guided-tours/tours/jetpack-video-hosting-tour/meta.js"),W=s("./layout/guided-tours/tours/simple-payments-email-tour/meta.js"),G={checklistSiteTitle:N.a,jetpackBackupsRewind:R.a,jetpackChecklist:L.a,jetpackLazyImages:A.a,jetpackMonitoring:U.a,jetpackPluginUpdates:V.a,jetpackSearch:q.a,jetpackSignIn:F.a,jetpackSiteAccelerator:z.a,jetpackVideoHosting:B.a,main:w.a,editorBasicsTour:T.a,marketingConnectionsTour:M.a,mediaBasicsTour:D.a,tutorialSitePreview:S.a,gdocsIntegrationTour:C.a,simplePaymentsTour:P.a,simplePaymentsEmailTour:W.a},H=s("./lib/create-selector/index.js"),Y=(s("./state/guided-tours/init.js"),s("./state/guided-tours/selectors/get-tours-history.js")),K=["signup","upgrades","checkout-thank-you"],Q=v()("calypso:guided-tours"),X=Object(o.a)(G,(function(e,t){return(s=e.path,Array.isArray(s)?s:[s]).map((function(s){return{tour:t,when:e.when,path:s}}));var s})),$=Object(H.a)((function(e){return Object(c.a)(Object(k.a)(e).filter((function(e){return e.type===y.kp})).reduceRight((function(e,t){var s=t.path,n=X.filter((function(e){var t=e.path;return Object(l.a)(s,t)})).map((function(e){return e.tour}));return n?[].concat(r()(e),r()(n)):e}),[]))}),[k.a]),J=Object(H.a)((function(e){return Object(c.a)(Object(d.a)(Object(Y.a)(e),"tourName"))}),[Y.a]),Z=Object(H.a)((function(e){var t=Object(x.a)(e),s=Object(O.a)(e),n=["tour","_timestamp"],a=s&&s.tour?Object(u.a)(s,n):Object(u.a)(t,n),i=a.tour,r=a._timestamp;if(i&&Object(p.a)(X,{tour:i}))return{tour:i,_timestamp:r}}),[x.a,O.a]),ee=function(e){var t=Z(e);if(t&&!function(e,t){var s=t.tour,n=t._timestamp;return Object(Y.a)(e).some((function(e){return e.tourName===s&&e.timestamp>n}))}(e,t))return t.tour},te=Object(H.a)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),s=Object(b.a)(Object(k.a)(e),{type:y.af,shouldShow:!1});return s&&t-s.timestamp<6e4}),[k.a]),se=function(e){return!function(e){return!Object(f.a)(K,Object(_.a)(e))}(e)},ne=Object(H.a)((function(e){if(!se(e))return function(e){var t=Object(b.a)(Object(k.a)(e),{type:y.af});return t&&void 0===t.shouldShow&&t.tour}(e)||!function(e){return te(e)}(e)&&(ee(e)||function(e){if(Object(E.e)(e)){var t=Object(c.a)(r()($(e))),s=Object(c.a)(r()(J(e))),n=Object(m.a)(t,s);return Object(p.a)(n,(function(t){var s=Object(p.a)(X,{tour:t}).when;return(void 0===s?Object(h.a)(!0):s)(e)}))}Q("No fresh user preferences, bailing.")}(e))||void 0}),[k.a,Y.a]),ae=function(e){return Object(g.a)(e,"guidedTours",!1)},ie=Object(H.a)((function(e){var t=ae(e),s=ne(e),n="gutenberg"===Object(I.a)(e),i=!!s&&!n,r=!!t.isPaused;return Q("tours: reached",$(e),"seen",J(e),"found",s),s?a()(a()({},t),{},{tour:s,shouldShow:i,isPaused:r}):a()(a()({},t),{shouldShow:!1})}),[ae,k.a,E.e])},"./state/jetpack/init.js":function(e,t,s){"use strict";var n=s("./state/redux-store.ts"),a=s("./state/utils/reducer-utils.js"),i=s("./state/utils/with-storage-key.js"),r=s("../node_modules/lodash-es/stubTrue.js"),o=s("../node_modules/lodash-es/stubFalse.js"),c=s("./state/action-types.js"),l=s("./state/utils/keyed-reducer.js"),d=s("./state/utils/without-persistence.js"),u=Object(l.a)("siteId",Object(d.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.xh:var s=t.status;return s}return e}))),p=Object(l.a)("siteId",Object(d.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.yh:return Object(r.a)(e,t);case c.zh:case c.Ah:return Object(o.a)(e,t)}return e}))),m=Object(l.a)("siteId",Object(d.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.Fi:var s=t.data;return s}return e}))),h=Object(l.a)("siteId",Object(d.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.Gi:return Object(r.a)(e,t);case c.Hi:case c.Ii:return Object(o.a)(e,t)}return e}))),f=Object(l.a)("siteId",Object(d.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.Ih:return Object(r.a)(e,t);case c.Jh:case c.Kh:return Object(o.a)(e,t)}return e}))),b=Object(a.a)({items:u,requests:p,dataItems:m,dataRequests:h,disconnectRequests:f}),g=s("./state/utils/schema-utils.js"),j=Object(g.a)({type:"object",items:{type:"object",properties:{abspath:{type:"string"},host:{type:"string"},port:{type:"number"},protocol:{type:"string"},pass:{type:"boolean"},user:{type:"string"}}}},Object(l.a)("siteId",(function(e,t){var s=t.type,n=t.credentials;return c.Dh===s?"object"==typeof n?n:{}:e}))),v=Object(l.a)("siteId",(function(e,t){switch(t.type){case c.Eh:return"pending";case c.Gh:return"success";case c.Fh:return"failed"}return e})),y=Object(a.a)({items:j,requestStatus:v}),_=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),I=s.n(_),O=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),x=s.n(O),k=s("../node_modules/lodash-es/merge.js"),E=s("../node_modules/lodash-es/pickBy.js"),w=s("../node_modules/lodash-es/get.js"),S=s("../node_modules/lodash-es/forEach.js"),C=function(e){return function(t,s){var n=s.siteId,a=s.moduleSlug;return Object(k.a)({},t,x()({},n,x()({},a,{active:e})))}},P=function(){return function(e,t){var s=t.siteId,n=t.modules;return Object(k.a)({},e,x()({},s,n))}},T=function(e){return function(t,s){var n=s.siteId,a=s.moduleSlug;return Object(k.a)({},t,x()({},n,x()({},a,e)))}},M=function(e){return function(t,s){var n=s.siteId;return Object(k.a)({},t,x()({},n,{fetchingModules:e}))}},D=function(){return function(e,t){var s=t.siteId,n=t.settings,a=e,i=Object(E.a)(n,(function(t,n){return void 0!==Object(w.a)(e,[s,n])}));return Object(S.a)(i,(function(e,t){a=Object.assign({},a,x()({},s,I()(I()({},a[s]),{},x()({},t,I()(I()({},a[s][t]),{},{active:e})))))})),a}},N=Object(d.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.Rh:return C(!0)(e,t);case c.Uh:return C(!1)(e,t);case c.Lh:return P()(e,t);case c.vi:case c.ui:return D()(e,t)}return e})),R=Object(d.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.Ph:return T({activating:!0})(e,t);case c.Qh:case c.Rh:return T({activating:!1})(e,t);case c.Sh:return T({deactivating:!0})(e,t);case c.Th:case c.Uh:return T({deactivating:!1})(e,t);case c.Mh:return M(!0)(e,t);case c.Nh:case c.Oh:return M(!1)(e,t)}return e})),L=Object(a.a)({items:N,requests:R}),A=s("../node_modules/lodash-es/mapValues.js"),U=s("./state/jetpack/settings/utils.js"),V=Object(l.a)("siteId",Object(g.a)({type:"object",additionalProperties:!0},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.Rh:var s=t.moduleSlug;return I()(I()({},e),{},x()({},s,!0));case c.Uh:var n=t.moduleSlug;return I()(I()({},e),{},x()({},n,!1));case c.Lh:var a=t.modules,i=Object(A.a)(a,(function(e){return e.active})),r=Object.keys(a).reduce((function(e,t){return I()(I()({},e),Object(A.a)(a[t].options,(function(e){return e.current_value})))}),{});return I()(I()(I()({},e),i),Object(U.b)(r));case c.ui:var o=t.settings.post_by_email_address;return o&&o!==e.post_by_email_address?I()(I()({},e),{},{post_by_email_address:o}):e;case c.vi:var l=t.settings;return Object(k.a)({},e,l)}return e})));V.hasCustomPersistence=!0;Object(a.a)({settings:V});var q=Object(a.a)({connection:b,credentials:y,modules:L,settings:V}),F=Object(i.a)("jetpack",q);Object(n.a)(["jetpack"],F)},"./state/jetpack/modules/actions.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return d})),s.d(t,"c",(function(){return u}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("../node_modules/lodash-es/mapValues.js"),r=s("../node_modules/lodash-es/omit.js"),o=s("./state/action-types.js"),c=s("./lib/wp/browser.js"),l=(s("./state/jetpack/init.js"),function(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(n){return n({type:o.Ph,siteId:e,moduleSlug:t,silent:s}),c.a.undocumented().jetpackModuleActivate(e,t).then((function(){n({type:o.Rh,siteId:e,moduleSlug:t,silent:s})})).catch((function(a){n({type:o.Qh,siteId:e,moduleSlug:t,silent:s,error:a.message})}))}}),d=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(n){return n({type:o.Sh,siteId:e,moduleSlug:t,silent:s}),c.a.undocumented().jetpackModuleDeactivate(e,t).then((function(){n({type:o.Uh,siteId:e,moduleSlug:t,silent:s})})).catch((function(a){n({type:o.Th,siteId:e,moduleSlug:t,silent:s,error:a.message})}))}};var u=function(e){return function(t){return t({type:o.Mh,siteId:e}),c.a.undocumented().getJetpackModules(e).then((function(s){var n=s.data,c=Object(i.a)(n,(function(e){return a()({active:e.activated},Object(r.a)(e,"activated"))}));t(function(e,t){return{type:o.Lh,siteId:e,modules:t}}(e,c)),t({type:o.Oh,siteId:e})})).catch((function(s){t({type:o.Nh,siteId:e,error:s.message})}))}}},"./state/jetpack/settings/utils.js":function(e,t,s){"use strict";s.d(t,"b",(function(){return c})),s.d(t,"c",(function(){return l})),s.d(t,"a",(function(){return d}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("../node_modules/lodash-es/get.js"),r=s("../node_modules/lodash-es/forEach.js"),o=s("../node_modules/lodash-es/omit.js"),c=function(e){return Object.keys(e).reduce((function(t,s){switch(s){case"carousel_background_color":t[s]=""===e[s]?"black":e[s];break;case"custom-content-types":case"jetpack_testimonial":case"jetpack_portfolio":case"jetpack_testimonial_posts_per_page":case"jetpack_portfolio_posts_per_page":break;case"jetpack_protect_global_whitelist":var n=Object(i.a)(e[s],["local"],[]);t[s]=n.join("\n");break;case"infinite-scroll":break;case"infinite_scroll":void 0!==e["infinite-scroll"]&&(e["infinite-scroll"]?t[s]=e[s]?"scroll":"button":t[s]="default",t["infinite-scroll"]=e["infinite-scroll"]);break;default:t[s]=e[s]}return t}),{})},l=function(e){return Object.keys(e).reduce((function(t,s){switch(s){case"akismet":case"custom-content-types":case"infinite-scroll":case"jetpack_portfolio":case"jetpack_testimonial":case"jetpack_testimonial_posts_per_page":case"jetpack_portfolio_posts_per_page":case"post_by_email_address":"regenerate"===e[s]&&(t[s]=e[s]);break;case"infinite_scroll":"default"===e[s]?t["infinite-scroll"]=!1:(t["infinite-scroll"]=!0,t[s]="scroll"===e[s]);break;default:t[s]=e[s]}return t}),{})},d=function(e){var t=a()({},e);return Object(r.a)({minileven:["wp_mobile_excerpt","wp_mobile_featured_images","wp_mobile_app_promos"],subscriptions:["stb_enabled","stc_enabled"],likes:["social_notifications_like","social_notifications_reblog","social_notifications_subscribe"],markdown:["wpcom_publish_comments_with_markdown"],protect:["jetpack_protect_global_whitelist"],sso:["jetpack_sso_match_by_email","jetpack_sso_require_two_step"],comments:["highlander_comment_form_prompt","jetpack_comment_form_color_scheme"],carousel:["carousel_background_color","carousel_display_exif"],stats:["admin_bar","hide_smile","count_roles","roles"]},(function(s,n){e[n]||(t=Object(o.a)(t,s)),t=Object(o.a)(t,n)})),t}},"./state/media/actions.js":function(e,t,s){"use strict";s.d(t,"k",(function(){return x})),s.d(t,"l",(function(){return k})),s.d(t,"j",(function(){return E})),s.d(t,"s",(function(){return w})),s.d(t,"m",(function(){return S})),s.d(t,"i",(function(){return C})),s.d(t,"r",(function(){return P})),s.d(t,"e",(function(){return T})),s.d(t,"h",(function(){return M})),s.d(t,"t",(function(){return D})),s.d(t,"f",(function(){return N})),s.d(t,"g",(function(){return R})),s.d(t,"a",(function(){return L})),s.d(t,"b",(function(){return A})),s.d(t,"c",(function(){return U})),s.d(t,"n",(function(){return V})),s.d(t,"o",(function(){return q})),s.d(t,"p",(function(){return F})),s.d(t,"q",(function(){return z})),s.d(t,"d",(function(){return B}));var n,a=s("../node_modules/lodash-es/castArray.js"),i=s("./state/action-types.js"),r=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),o=s.n(r),c=s("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),l=s.n(c),d=s("../node_modules/lodash-es/toPairs.js"),u=s("../node_modules/lodash-es/isEqual.js"),p=s("../node_modules/lodash-es/omit.js"),m=s("../node_modules/debug/src/browser.js"),h=s.n(m),f=s("./state/data-layer/wpcom-http/utils.js"),b=s("./state/data-layer/wpcom-http/actions.js"),g=s("./state/sites/media-storage/actions.js"),j=s("./state/media/utils/flux-adapter.js"),v=s("./state/data-layer/handler-registry.js"),y=s("./state/selectors/get-next-page-query.js"),_=h()("calypso:middleware-media");var I=function(e,t){var s=e.siteId;return function(e){e(x(s,t)),Object(j.n)(s,t)}},O=function(e,t){var s=e.siteId;return function(){Object(j.m)(s,t)}};function x(e,t,s,n){return{type:i.Yj,siteId:e,media:Object(a.a)(t),found:s,query:n}}function k(e,t){return{type:i.Zj,siteId:e,query:t}}function E(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:i.ak,siteId:e,query:t,error:s}}function w(e,t){return{type:i.bk,siteId:e,query:t}}function S(e,t){return{type:i.Sj,siteId:e,mediaId:t}}function C(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:i.Tj,siteId:e,mediaId:t,error:s}}function P(e,t){return{type:i.Uj,siteId:e,mediaId:t}}function T(e,t){return{type:i.Nj,site:e,transientMedia:t}}Object(v.b)("state/data-layer/wpcom/sites/media/index.js",(n={},o()(n,i.Zj,[Object(f.a)({fetch:function(e){_("Request media for site %d using query %o",e.siteId,e.query);var t=e.siteId,s=e.query,n=s&&s.source?"/meta/external-media/".concat(s.source):"/sites/".concat(t,"/media");return[Object(b.a)({method:"GET",path:n,apiVersion:"1.1",query:s},e)]},onSuccess:function(e,t){var s=e.siteId,n=e.query;return function(e,a){Object(u.a)(Object(p.a)(n,"page_handle"),Object(p.a)(Object(y.a)(a(),s),"page_handle"))?(e(x(s,t.media,t.found,n)),e(w(s,n)),e(F(s,t.meta)),Object(j.k)(s,t,n)):e(w(s,n))}},onError:function(e){var t=e.siteId,s=e.query;return function(e){e(E(t,s))}}})]),o()(n,i.Sj,[Object(f.a)({fetch:function(e){var t=e.mediaId,s=e.query,n=e.siteId;return _("Request media item %d for site %d",t,n),[Object(b.a)({apiVersion:"1.2",method:"GET",path:"/sites/".concat(n,"/media/").concat(t),query:s},e)]},onSuccess:function(e,t){var s=e.mediaId,n=e.siteId;return function(e){e(x(n,t)),e(P(n,s)),Object(j.j)(n,t)}},onError:function(e,t){var s=e.mediaId,n=e.siteId;return function(e){e(C(n,s)),Object(j.i)(n,t)}}})]),o()(n,i.Vj,[Object(f.a)({fetch:function(e){var t=e.siteId,s=e.item;return[Object(b.a)({method:"POST",path:"/sites/".concat(t,"/media/").concat(s.ID),apiVersion:"1.1",body:s},e)]},onSuccess:I,onError:O})]),o()(n,i.Pj,[Object(f.a)({fetch:function(e){var t=e.siteId,s=e.data,n=s.ID,a=l()(s,["ID"]);return[Object(b.a)({method:"POST",path:"/sites/".concat(t,"/media/").concat(n,"/edit"),apiVersion:"1.1",formData:Object(d.a)(a)},e)]},onSuccess:I,onError:O})]),o()(n,i.Oj,[Object(f.a)({fetch:function(e){return[Object(b.a)({apiVersion:"1.1",method:"POST",path:"/sites/".concat(e.siteId,"/media/").concat(e.mediaId,"/delete")},e)]},onSuccess:function(e,t){var s=e.siteId;return function(e){e(N(s,t.ID)),e(Object(g.b)(s)),Object(j.h)(s,t)}},onError:function(e,t){var s=e.siteId;return function(){Object(j.g)(s,t)}}})]),n));var M=function(e,t,s){return{type:i.Pj,siteId:e,mediaItem:t,data:s}},D=function(e,t){return{type:i.Vj,siteId:e,item:t}};function N(e,t){return{type:i.Lj,mediaIds:Object(a.a)(t),siteId:e}}var R=function(e,t){return{type:i.Oj,siteId:e,mediaId:t}};function L(e){return{type:i.ek,siteId:e}}function A(e,t){return{type:i.Mj,siteId:e,errorType:t}}function U(e,t){return{type:i.Qj,siteId:e,mediaId:t}}function V(e,t,s){return{type:i.Rj,siteId:e,mediaId:t,errors:s}}function q(e,t){return{type:i.Wj,media:t,siteId:e}}function F(e,t){return{type:i.ck,siteId:e,mediaRequestMeta:t}}function z(e,t){return{type:i.dk,siteId:e,query:t}}function B(e){return{type:i.Kj,siteId:e}}},"./state/media/thunks/get-media-item.js":function(e,t,s){"use strict";var n=s("./state/selectors/get-media-item.js");t.a=function(e,t){return function(s,a){return Object(n.a)(a(),e,t)}}},"./state/media/thunks/index.js":function(e,t,s){"use strict";s.d(t,"b",(function(){return B})),s.d(t,"j",(function(){return K})),s.d(t,"a",(function(){return Q})),s.d(t,"e",(function(){return J})),s.d(t,"i",(function(){return Z})),s.d(t,"d",(function(){return te})),s.d(t,"f",(function(){return ne})),s.d(t,"c",(function(){return ae})),s.d(t,"g",(function(){return ce})),s.d(t,"h",(function(){return le.a}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=s.n(i),o=s("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),c=s.n(o),l=s("../node_modules/lodash-es/noop.js"),d=s("../node_modules/lodash-es/castArray.js"),u=s("../node_modules/lodash-es/zip.js"),p=s("./state/media/utils/flux-adapter.js"),m=s("./state/media/actions.js"),h=s("./state/sites/media-storage/actions.js"),f=s("./node_modules/path-browserify/index.js"),b=s.n(f),g=s("./lib/impure-lodash/index.js"),j=s("./lib/media/utils/get-file-extension.js"),v=s("./lib/media/utils/get-mime-type.js"),y=g.a.uniqueId;function _(e){var t={transient:!0,ID:y("media-")};if("string"==typeof e)Object.assign(t,{file:e,title:b.a.basename(e),extension:Object(j.a)(e),mime_type:Object(v.a)(e)});else if(e.thumbnails)Object.assign(t,{file:e.URL,title:e.name,caption:e.caption||"",extension:e.extension,mime_type:e.mime_type,guid:e.URL,URL:e.URL,external:!0});else{var s=e.fileContents||e,n=e.fileName||e.name,a=window.URL.createObjectURL(s);Object.assign(t,{URL:a,guid:a,file:n,title:e.title||b.a.basename(n),extension:Object(j.a)(e.fileName||s),mime_type:Object(v.a)(e.fileName||s),size:s.size})}return t}var I=s("./lib/media/constants.js"),O=s("../node_modules/lodash-es/includes.js"),x=s("../node_modules/lodash-es/get.js"),k=s("../node_modules/lodash-es/startsWith.js"),E=s("./lib/version-compare/index.js");var w=s("./lib/media/utils/is-site-allowed-file-types-to-be-trusted.js"),S=s("./lib/media/utils/get-allowed-file-types-for-site.js");function C(e,t){var s=[];if(e)return function(e,t){return!(!t||!e)&&(!Object(w.a)(t)||Object(S.a)(t).some((function(t){return t.toLowerCase()===e.extension.toLowerCase()})))}(t,e)||(!function(e,t){return!(!t||!e)&&(!Object(w.a)(t)||I.j.some((function(t){return t.toLowerCase()===e.extension.toLowerCase()})))}(t,e)?s.push(I.i.FILE_TYPE_UNSUPPORTED):s.push(I.i.FILE_TYPE_NOT_IN_PLAN)),!0===function(e,t){var s=e.size;return t&&t.options&&isFinite(s)&&t.options.max_upload_size?t.jetpack&&Object(O.a)(Object(x.a)(t,"options.active_modules"),"videopress")&&Object(E.a)(Object(x.a)(t,"options.jetpack_version"),"4.5",">=")&&Object(k.a)(Object(v.a)(e),"video/")?null:s>t.options.max_upload_size:null}(t,e)&&s.push(I.i.EXCEEDS_MAX_UPLOAD_SIZE),s}var P=function(){return Date.now()+3154e7};function T(e,t){return function(s){var n=P(),i=e.length;return e.map((function(e,r){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return new Date(e-(s-t)).toISOString()}(n,r,i),c=a()({date:o},_(e));e.ID&&(c.ID=e.ID);var l=t.ID;Object(p.a)(c,t);var d=C(t,c);if(!(null==d?void 0:d.length))return s(Object(m.e)(t,c)),c;s(Object(m.n)(l,c.ID,d))}))}}var M=function(e){return e instanceof window.FileList},D=function(e,t,s){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.a;return function(){var o=c()(regeneratorRuntime.mark((function o(l){var f,b,g;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return e=M(e)?Array.from(e):Object(d.a)(e),f=[],b=l(T(e,t)),g=t.ID,o.next=6,Object(u.a)(e,b).reduce(function(){var e=c()(regeneratorRuntime.mark((function e(t,o){var c,d,u,b,j,v,y,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r()(o,2),d=c[0],u=c[1]){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,t;case 5:return e.prev=5,e.next=8,s(d,g);case 8:b=e.sent,j=r()(b.media,1),v=j[0],y=b.found,_=a()(a()({},v),{},{transientId:u.ID}),Object(p.e)(u.ID,g,v),l(Object(m.r)(g,u.ID)),l(Object(m.k)(g,_,y)),l(Object(h.b)(g)),n(_,d),f.push(_),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(5),Object(p.d)(u.ID,g,e.t0),l(Object(m.i)(g,u.ID,e.t0)),i(d);case 26:case"end":return e.stop()}}),e,null,[[5,21]])})));return function(t,s){return e.apply(this,arguments)}}(),Promise.resolve());case 6:return o.abrupt("return",f);case 7:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()},N=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),R=s.n(N),L=s("../node_modules/debug/src/browser.js"),A=s.n(L),U=s("./lib/redux-bridge/index.js"),V=s("./lib/wp/browser.js"),q=s("./state/editor/selectors.js"),F=A()("calypso:media"),z=function(){return function(e,t){var s="string"==typeof e,n=Object(q.f)(Object(U.c)()),a=e.title;return n?e=R()({parent_id:n},s?"url":"file",e):e.fileContents&&(e={file:e}),a&&(e.title=a),F("Uploading media to %d from %o",t,e),s?V.a.site(t).addMediaUrls({},e):V.a.site(t).addMediaFiles({},e)}},B=function(e,t){return function(s){var n=z();return s(D(e,t,n))}},W=s("../node_modules/lodash-es/uniqueId.js"),G=s("./state/site-settings/actions.js"),H=s("./state/notices/actions.js"),Y=function(e,t){return Object(G.c)(e,{site_icon:t})},K=function(e,t,s,n,a,i){return function(){var o=c()(regeneratorRuntime.mark((function o(c){var l,d,u,p,m;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return l=Object(W.a)("site-icon"),d={ID:l,fileContents:e,fileName:t},c(Y(s,l)),o.prev=3,o.next=6,c(B(d,i));case 6:u=o.sent,p=r()(u,1),m=p[0].ID,c(Object(G.b)(s,{site_icon:m})),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(3),c(Object(H.b)(n("An error occurred while uploading the file."))),a&&c(Y(s,a));case 16:case"end":return o.stop()}}),o,null,[[3,12]])})));return function(e){return o.apply(this,arguments)}}()},Q=function(e,t,s){return function(n){var a=function(e){return function(t,s){return V.a.undocumented().site(s).uploadExternalMedia(e,[t.guid])}}(s);return n(D(e,t,a))}},X=s("../node_modules/lodash-es/assign.js"),$=s("./state/selectors/get-media-item.js"),J=function(e,t){return function(s,n){var a=_(t.media||t.media_url);if(a){var i=t.ID,r=Object($.a)(n(),e,i),o=Object(X.a)({},r,a,{ID:i,isDirty:!0});Object(p.l)(e,o),s(Object(m.h)(e,o,t))}}},Z=function(e,t){return function(s,n){var a=t.ID,i=Object($.a)(n(),e,a),r=Object(X.a)({},i,t);Object(p.l)(e,r),s(Object(m.t)(e,r))}},ee=A()("calypso:media"),te=function(e,t){return function(s){ee("Deleting media from %d by ID %d",e,t.ID),Object(d.a)(t).filter((function(e){return"number"==typeof e.ID})).forEach((function(t){Object(p.f)(e,t),s(Object(m.g)(e,t.ID))}))}},se=A()("calypso:media"),ne=function(e,t){return function(s){se("Fetching media for %d using ID %d",e,t),s(Object(m.m)(e,t)),Object(p.b)(e,t)}},ae=function(e,t,s,n,a){return function(){var i=c()(regeneratorRuntime.mark((function i(r){var o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r(D(e,t,z(),(function(e,t){return s({ID:e.ID,transientId:t.ID,URL:e.URL,placeholder:t.preview})}),n));case 2:o=i.sent,a(o.map((function(e){return e.ID})));case 4:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}()},ie=s("./state/selectors/is-fetching-next-page.js"),re=s("./state/selectors/get-next-page-query.js"),oe=A()("calypso:media"),ce=function(e){return function(t,s){if(!Object(ie.a)(s(),e)){Object(p.c)(e);var n=Object(re.a)(s(),e);oe("Fetching media for %d using query %o",e,n),t(Object(m.l)(e,n))}}},le=s("./state/media/thunks/get-media-item.js")},"./state/media/utils/flux-adapter.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"e",(function(){return i})),s.d(t,"d",(function(){return r})),s.d(t,"j",(function(){return o})),s.d(t,"i",(function(){return c})),s.d(t,"l",(function(){return l})),s.d(t,"n",(function(){return d})),s.d(t,"m",(function(){return u})),s.d(t,"f",(function(){return p})),s.d(t,"h",(function(){return m})),s.d(t,"g",(function(){return h})),s.d(t,"b",(function(){return f})),s.d(t,"c",(function(){return b})),s.d(t,"k",(function(){return g}));var n=s("./dispatcher/index.js"),a=function(e,t){return n.a.handleViewAction({type:"CREATE_MEDIA_ITEM",siteId:t.ID,data:e,site:t})},i=function(e,t,s){return n.a.handleServerAction({type:"RECEIVE_MEDIA_ITEM",id:e,siteId:t,data:s})},r=function(e,t,s){return n.a.handleServerAction({type:"RECEIVE_MEDIA_ITEM",id:e,siteId:t,error:s})},o=function(e,t){n.a.handleServerAction({type:"RECEIVE_MEDIA_ITEM",siteId:e,data:t})},c=function(e,t){n.a.handleServerAction({type:"RECEIVE_MEDIA_ITEM",siteId:e,error:t})},l=function(e,t){n.a.handleViewAction({type:"RECEIVE_MEDIA_ITEM",siteId:e,data:t})},d=function(e,t){n.a.handleServerAction({type:"RECEIVE_MEDIA_ITEM",siteId:e,data:t})},u=function(e,t){n.a.handleServerAction({type:"RECEIVE_MEDIA_ITEM",siteId:e,error:t})},p=function(e,t){n.a.handleViewAction({type:"REMOVE_MEDIA_ITEM",siteId:e,data:t})},m=function(e,t){n.a.handleServerAction({type:"REMOVE_MEDIA_ITEM",siteId:e,data:t})},h=function(e,t){n.a.handleViewAction({type:"REMOVE_MEDIA_ITEM",siteId:e,error:t})},f=function(e,t){n.a.handleViewAction({type:"FETCH_MEDIA_ITEM",siteId:e,id:t})},b=function(e){n.a.handleViewAction({type:"FETCH_MEDIA_ITEMS",siteId:e})},g=function(e,t,s){n.a.handleServerAction({type:"RECEIVE_MEDIA_ITEMS",siteId:e,data:t,query:s})}},"./state/post-types/actions.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return u})),s.d(t,"b",(function(){return p}));var n=s("./state/action-types.js"),a=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),i=s.n(a),r=s("../node_modules/lodash-es/noop.js"),o=s("./state/data-layer/wpcom-http/utils.js"),c=s("./state/data-layer/wpcom-http/actions.js"),l=s("./state/data-layer/handler-registry.js"),d=Object(o.a)({fetch:function(e){return Object(c.a)({method:"GET",path:"/sites/".concat(e.siteId,"/post-types")},e)},onSuccess:function(e,t){return u(e.siteId,t.post_types)},onError:r.a});Object(l.b)("state/data-layer/wpcom/sites/post-types/index.js",i()({},n.dn,[d]));s("./state/post-types/init.js");function u(e,t){return{type:n.cn,siteId:e,types:t}}function p(e){return{type:n.dn,siteId:e}}},"./state/post-types/init.js":function(e,t,s){"use strict";var n=s("./state/redux-store.ts"),a=s("../node_modules/lodash-es/keyBy.js"),i=s("./state/utils/schema-utils.js"),r=s("./state/utils/keyed-reducer.js"),o=s("./state/utils/reducer-utils.js"),c=s("./state/utils/with-storage-key.js"),l=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),d=s.n(l),u=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),p=s.n(u),m=s("../node_modules/lodash-es/merge.js"),h=s("./state/action-types.js");var f=Object(i.a)({type:"object",patternProperties:{"^[0-9]+$":{type:"object",patternProperties:{"^.*$":{type:"array",items:{type:"object",required:["name"],properties:{name:{type:"string"},label:{type:"string"},labels:{type:"object"},description:{type:"string"},hierarchical:{type:"boolean"},public:{type:"boolean"},capabilities:{type:"object"}}}}},additionalProperties:!1}},additionalProperties:!1},(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.en:return d()(d()({},e),{},p()({},t.siteId,d()(d()({},e[t.siteId]),{},p()({},t.postType,t.taxonomies))));default:return e}})),b=Object(o.a)({requesting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.fn:case h.hn:case h.gn:return Object(m.a)({},e,p()({},t.siteId,p()({},t.postType,h.fn===t.type)))}return e},items:f}),g=Object(i.a)({type:"object",additionalProperties:!1,patternProperties:{"^\\d+$":{type:"object",additionalProperties:{type:"object",required:["name"],properties:{name:{type:"string"},label:{type:"string"},labels:{type:"object"},description:{type:"string"},map_meta_cap:{type:"boolean"},capabilities:{type:"object"},api_queryable:{type:"boolean"},hierarchical:{type:"boolean"},supports:{type:"object"}}}}}},Object(r.a)("siteId",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.cn:return Object(a.a)(t.types,"name");default:return e}}))),j=Object(o.a)({items:g,taxonomies:b}),v=Object(c.a)("postTypes",j);Object(n.a)(["postTypes"],v)},"./state/post-types/selectors.js":function(e,t,s){"use strict";s.d(t,"c",(function(){return n})),s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return i})),s.d(t,"e",(function(){return r})),s.d(t,"d",(function(){return o}));s("./state/post-types/init.js");function n(e,t){return e.postTypes.items[t]||null}function a(e,t,s){var a=n(e,t);return a&&a[s]||null}function i(e,t,s,n,i){var r=a(e,t,s);if(r){var o=r.labels[n];return!i||"en"!==i&&"en-gb"!==i||(o=o[0].toUpperCase()+o.slice(1).toLowerCase()),o}return null}function r(e,t,s,n){switch(s){case"post":switch(n){case"publicize":return!0}}var i=a(e,t,s);if(i)return!!i.supports[n];switch(s){case"page":switch(n){case"publicize":return!1}}return null}function o(e,t,s){var a=n(e,t);return a?!!a[s]:null}},"./state/posts/actions/edit-post.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("./state/action-types.js");s("./state/posts/init.js");function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2?arguments[2]:void 0;return{type:n.um,post:s,siteId:e,postId:t}}},"./state/posts/actions/save-post-success.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("./state/action-types.js");s("./state/posts/init.js");function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return{type:n.Xm,siteId:e,postId:t,savedPost:s,post:a}}},"./state/posts/actions/trash-post.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("./lib/wp/browser.js"),a=s("./state/action-types.js"),i=s("./state/posts/actions/receive-post.js"),r=s("./state/posts/actions/save-post-success.js");s("./state/posts/init.js");function o(e,t){return function(s){var o={status:"trash"};s({type:a.Vm,siteId:e,postId:t,post:o});var c=n.a.site(e).post(t).delete();return c.then((function(n){s(Object(r.a)(e,t,n,o)),s(Object(i.a)(n))}),(function(n){s({type:a.Wm,siteId:e,postId:t,error:n})})),c}}},"./state/posts/revisions/actions.js":function(e,t,s){"use strict";s.d(t,"d",(function(){return m})),s.d(t,"c",(function(){return h})),s.d(t,"e",(function(){return f})),s.d(t,"a",(function(){return b})),s.d(t,"b",(function(){return g})),s.d(t,"f",(function(){return j})),s.d(t,"g",(function(){return v}));var n=s("./state/action-types.js"),a=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),i=s.n(a),r=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),o=s.n(r),c=s("../node_modules/lodash-es/noop.js"),l=s("./state/data-layer/wpcom-http/utils.js"),d=s("./state/data-layer/wpcom-http/actions.js"),u=s("./state/data-layer/handler-registry.js"),p=Object(l.a)({fetch:function(e){var t=e.siteId,s=e.postId,n=e.postType,a=e.comparisons;return Object(d.a)({apiVersion:"1.2",path:"/sites/".concat(t,"/").concat(n,"/").concat(s,"/diffs"),method:"GET",query:{comparisons:a}},e)},onSuccess:function(e,t){var s=e.siteId,n=e.postId;return h(o()({siteId:s,postId:n},t))},onError:c.a});Object(u.b)("state/data-layer/wpcom/posts/revisions/index.js",i()({},n.Sm,[p]));s("./state/posts/init.js");var m=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"posts",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return{type:n.Sm,comparisons:a,postId:t,postType:s,siteId:e}},h=function(e){var t=e.diffs,s=e.postId,a=e.revisions,i=e.siteId;return{type:n.Rm,diffs:t,postId:s,revisions:a,siteId:i}},f=function(e){return{type:n.Tm,revisionId:e}},b=function(){return{type:n.Nm}},g=function(){return{type:n.Om}},j=function(){return{type:n.Pm}},v=function(){return{type:n.Qm}}},"./state/posts/selectors/get-edited-post-value.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("../node_modules/lodash-es/get.js"),a=s("./state/posts/selectors/get-edited-post.js");s("./state/posts/init.js");function i(e,t,s,i){return Object(n.a)(Object(a.a)(e,t,s),i)}},"./state/posts/stats/record-editor-event.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("./state/analytics/actions/record.js");function a(e,t,s){return Object(n.c)("Editor",e,t,s)}},"./state/posts/stats/record-editor-stat.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("./state/analytics/actions/bump-stat.js");function a(e){return Object(n.a)("editor_actions",e)}},"./state/selectors/get-current-route-parameterized.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("./state/selectors/get-current-route.js"),a=s("./state/sites/selectors/get-site-slug.js");function i(e,t){var s=Object(n.a)(e),i=Object(a.a)(e,t);return null===s||null===i?null:s.replace(i,":site").replace(t,":siteid")}},"./state/selectors/get-media-errors.js":function(e,t,s){"use strict";t.a=function(e,t){var s,n;return null!==(s=null===(n=e.media.errors)||void 0===n?void 0:n[t])&&void 0!==s?s:{}}},"./state/selectors/get-media-library-selected-items.js":function(e,t,s){"use strict";var n=s("./state/selectors/get-media-item.js");t.a=function(e,t){if(!t)return[];var s=e.media.selectedItems[t];return s?s.map((function(s){return Object(n.a)(e,t,s)})).filter((function(e){return e})):[]}},"./state/selectors/get-next-page-handle.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("../node_modules/lodash-es/get.js");function a(e,t){return Object(n.a)(e.media.fetching,[t,"nextPageHandle"])}},"./state/selectors/get-next-page-query.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("../node_modules/lodash-es/isString.js"),r=s("../node_modules/lodash-es/isNumber.js"),o=s("./state/selectors/get-next-page-handle.js");var c=Object.freeze({number:20});function l(e,t){if(!(t in e.media.fetching))return c;var s=function(e,t){var s,n;return null!==(s=null===(n=e.media.fetching[t])||void 0===n?void 0:n.query)&&void 0!==s?s:null}(e,t),n=Object(o.a)(e,t);return[i.a,r.a].some((function(e){return e(n)}))?a()(a()(a()({},c),s),{},{page_handle:n}):a()(a()({},c),s)}},"./state/selectors/get-removable-connections.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=s.n(n),i=s("../node_modules/lodash-es/filter.js"),r=s("./state/current-user/selectors.js"),o=s("./state/sharing/keyring/selectors.js"),c=s("./state/sharing/publicize/selectors.js");function l(e,t){var s=Object(r.h)(e),n=Object(i.a)(Object(o.d)(e,t),(function(e){var t=e.type,n=e.user_ID;return"publicize"!==t&&n===s}));return[].concat(a()(n),a()(Object(c.b)(e,t)))}},"./state/selectors/get-site-editor-url.js":function(e,t,s){"use strict";var n=s("./state/selectors/should-redirect-gutenberg.js"),a=s("./state/sites/selectors/get-site-admin-url.js"),i=s("./state/sites/selectors/get-site-slug.js");t.a=function(e,t){var s=Object(a.a)(e,t);if(Object(n.a)(e,t))return"".concat(s,"admin.php?page=gutenberg-edit-site");var r=Object(i.a)(e,t);return"/site-editor/".concat(r)}},"./state/selectors/is-fetching-jetpack-modules.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("../node_modules/lodash-es/get.js");s("./state/jetpack/init.js");function a(e,t){return Object(n.a)(e.jetpack.modules.requests,[t,"fetchingModules"],null)}},"./state/selectors/is-fetching-next-page.js":function(e,t,s){"use strict";var n=s("../node_modules/lodash-es/get.js"),a=s("./lib/create-selector/index.js");t.a=Object(a.a)((function(e,t){return Object(n.a)(e.media.fetching,[t,"nextPage"],!1)}),[function(e,t){var s;return null===(s=e.media.fetching)||void 0===s?void 0:s[t]}])},"./state/selectors/is-site-google-my-business-eligible.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s("./lib/create-selector/index.js"),a=s("./state/sites/selectors/get-site-plan-slug.js"),i=s("./lib/plans/index.js"),r=s("./lib/plans/constants.js"),o=Object(n.a)((function(e,t){var s=Object(a.a)(e,t);return Object(i.A)(s,r.rb)}),(function(e,t){return[Object(a.a)(e,t)]})),c=Object(n.a)((function(e,t){var s=Object(a.a)(e,t);return Object(i.D)(s,{group:r.ad,type:r.Qd})}),(function(e,t){return[Object(a.a)(e,t)]}));function l(e,t){return o(e,t)||c(e,t)}},"./state/selectors/is-site-using-core-site-editor.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("../node_modules/lodash-es/get.js"),a=s("./state/selectors/get-raw-site.js");function i(e,t){var s=Object(a.a)(e,t);return Object(n.a)(s,"is_core_site_editor_enabled",!1)}},"./state/sharing/keyring/actions.js":function(e,t,s){"use strict";s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return l}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("./lib/wp/browser.js"),r=s("./state/action-types.js");s("./state/sharing/init.js");function o(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t){return t({type:r.Ni}),i.a.undocumented().mekeyringConnections(e).then((function(e){var s=e.connections;t({type:r.Mi,connections:s}),t({type:r.Pi})})).catch((function(e){return t({type:r.Oi,error:e})}))}}function c(e){return{type:r.Qi,connection:e}}function l(e){return function(t){return i.a.undocumented().deletekeyringConnection(e.ID).then((function(){return t(c(e))})).catch((function(s){s&&404===s.statusCode&&t(c(e)),t({type:r.Ri,error:a()(a()({},s),{},{label:e.label})})}))}}},"./state/sharing/keyring/selectors.js":function(e,t,s){"use strict";s.d(t,"c",(function(){return r})),s.d(t,"b",(function(){return o})),s.d(t,"d",(function(){return c})),s.d(t,"a",(function(){return l})),s.d(t,"e",(function(){return d}));var n=s("../node_modules/lodash-es/values.js"),a=s("../node_modules/lodash-es/filter.js"),i=s("./lib/create-selector/index.js");s("./state/sharing/init.js");function r(e){return Object(n.a)(e.sharing.keyring.items)}function o(e,t){return e.sharing.keyring.items[t]||null}var c=Object(i.a)((function(e,t){return Object(a.a)(r(e),{service:t})}),(function(e){return[e.sharing.keyring.items]}));function l(e,t){return Object(a.a)(c(e,t),{status:"broken"})}function d(e){return e.sharing.keyring.isFetching}},"./state/sharing/publicize/actions.js":function(e,t,s){"use strict";s.d(t,"c",(function(){return o})),s.d(t,"g",(function(){return c})),s.d(t,"f",(function(){return l})),s.d(t,"e",(function(){return d})),s.d(t,"a",(function(){return u})),s.d(t,"h",(function(){return p})),s.d(t,"b",(function(){return m})),s.d(t,"d",(function(){return h}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("./lib/wp/browser.js"),r=s("./state/action-types.js");s("./state/sharing/init.js");function o(e,t){return{type:r.jo,siteId:e,postId:t}}function c(e,t,s,n){return function(a){return a({type:r.Tn,siteId:e,postId:t,skippedConnections:s,message:n}),new Promise((function(o){i.a.undocumented().publicizePost(e,t,n,s,(function(s,n){s||!n.results?a({type:r.ko,siteId:e,postId:t,error:s}):a({type:r.lo,siteId:e,postId:t}),o()}))}))}}function l(e){return function(t){return t({type:r.Gn,siteId:e}),i.a.undocumented().siteConnections(e).then((function(s){t(function(e,t){return{type:r.Fn,siteId:e,data:t}}(e,s)),t({type:r.In,siteId:e})})).catch((function(s){return t({type:r.Hn,siteId:e,error:s})}))}}function d(e,t){return function(s){return s({type:r.On,connectionId:t,siteId:e}),i.a.undocumented().site(e).getConnection(t).then((function(n){s({type:r.Nn,connection:n,siteId:e}),s({type:r.Qn,connectionId:t,siteId:e})})).catch((function(n){return s({type:r.Pn,connectionId:t,error:n,siteId:e})}))}}function u(e,t,s){return function(n){return i.a.undocumented().createConnection(t,e,s,{shared:!1}).then((function(e){return n({type:r.Jn,connection:e})})).catch((function(e){return n(h(e))}))}}function p(e,t){return function(s){return i.a.undocumented().updateConnection(e.site_ID,e.ID,t).then((function(e){return s({type:r.Rn,connection:e})})).catch((function(t){return s({type:r.Sn,error:a()(a()({},t),{},{label:e.label})})}))}}function m(e){return function(t){return i.a.undocumented().deleteSiteConnection(e.site_ID,e.ID).then((function(){return t(f(e))})).catch((function(s){s&&404===s.statusCode&&t(f(e)),t({type:r.Mn,error:a()(a()({},s),{},{label:e.label})})}))}}function h(e){return{type:r.Kn,error:e}}function f(e){return{type:r.Ln,connection:e}}},"./state/sharing/services/actions.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("./lib/wp/browser.js"),a=s("./state/action-types.js"),i=s("./state/ui/selectors/get-selected-site-id.js");s("./state/sharing/init.js");function r(){return function(e,t){e({type:a.Ti});var s=Object(i.a)(t());return n.a.undocumented().sitesExternalServices(s).then((function(t){e({type:a.Si,services:t.services}),e({type:a.Vi})})).catch((function(t){return e({type:a.Ui,error:t})}))}}},"./state/sharing/services/selectors.js":function(e,t,s){"use strict";s.d(t,"b",(function(){return d})),s.d(t,"a",(function(){return u})),s.d(t,"c",(function(){return p}));var n=s("../node_modules/lodash-es/filter.js"),a=s("./config/index.js"),i=s("./state/selectors/can-current-user.js"),r=s("./state/sites/selectors/is-jetpack-site.js"),o=s("./state/sites/selectors/is-jetpack-module-active.js"),c=s("./state/selectors/is-site-google-my-business-eligible.js");s("./state/sharing/init.js");function l(e){return e.sharing.services.items}function d(e,t){var s=l(e);return!!s[t]&&s[t]}function u(e,t,s){var d=function(e,t){return Object(n.a)(l(e),{type:t})}(e,s);return t?d.filter((function(s){return!(Object(r.a)(e,t)&&!s.jetpack_support)&&(!(Object(r.a)(e,t)&&s.jetpack_module_required&&!Object(o.a)(e,t,s.jetpack_module_required))&&(!("publicize"===s.type&&!Object(i.b)(e,t,"publish_posts"))&&(!!("google_my_business"!==s.ID||Object(i.b)(e,t,"manage_options")&&Object(c.a)(e,t)&&a.a.isEnabled("google-my-business"))&&("google_site_verification"!==s.ID&&("path"!==s.ID&&("apple"!==s.ID&&(!!("google-drive"!==s.ID||a.a.isEnabled("google-drive")&&Object(i.b)(e,t,"manage_options"))&&"eventbrite"!==s.ID)))))))})):d}function p(e){return e.sharing.services.isFetching}},"./state/site-settings/actions.js":function(e,t,s){"use strict";s.d(t,"c",(function(){return v})),s.d(t,"a",(function(){return y})),s.d(t,"b",(function(){return _}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("./lib/wp/browser.js"),r=s("./state/action-types.js"),o=s("../node_modules/lodash-es/isPlainObject.js"),c=s("../node_modules/lodash-es/values.js");function l(e){return Object.keys(e).reduce((function(t,s){switch(s){case"default_category":t[s]=parseInt(e[s]);break;case"sharing_show":Object(o.a)(e[s])?t[s]=Object(c.a)(e[s]):t[s]=e[s];break;default:t[s]=e[s]}return t}),{})}var d=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),u=s.n(d),p=s("../node_modules/lodash-es/get.js"),m=s("../node_modules/lodash-es/noop.js"),h=s("./state/data-layer/handler-registry.js"),f=s("./state/data-layer/wpcom-http/actions.js"),b=s("./state/data-layer/wpcom-http/utils.js"),g=s("./state/data-layer/utils.js"),j=s("./state/sites/actions.js");Object(h.b)("state/data-layer/wpcom/sites/homepage/index.js",u()({},r.Mq,[Object(b.a)({fetch:function(e){return Object(f.a)({path:"/sites/".concat(e.siteId,"/homepage"),method:"POST",apiVersion:"1.1",body:{is_page_on_front:"page"===Object(p.a)(e.frontPageOptions,"show_on_front"),page_on_front_id:Object(p.a)(e.frontPageOptions,"page_on_front"),page_for_posts_id:Object(p.a)(e.frontPageOptions,"page_for_posts")}},e)},onSuccess:function(e,t){var s=e.siteId,n=t.is_page_on_front,a=t.page_on_front_id,i=t.page_for_posts_id;return function(e){e(Object(g.a)(Object(j.h)(s,{show_on_front:n?"page":"posts",page_on_front:parseInt(a,10),page_for_posts:parseInt(i,10)})))}},onError:m.a})]));s("./state/site-settings/init.js");function v(e,t){return{type:r.Wr,siteId:e,settings:t}}function y(e){return function(t){return t({type:r.Qr,siteId:e}),i.a.undocumented().settings(e).then((function(s){var n=s.name,i=s.description,o=s.settings,c=a()(a()({},l(o)),{},{blogname:n,blogdescription:i});t(function(e,t){return{type:r.Pr,siteId:e,settings:t}}(e,c)),t({type:r.Sr,siteId:e})})).catch((function(s){t({type:r.Rr,siteId:e,error:s})}))}}function _(e,t){return function(s){return s({type:r.Tr,siteId:e}),i.a.undocumented().settings(e,"post",t).then((function(t){return s(v(e,l(t.updated))),s({type:r.Vr,siteId:e}),t})).catch((function(t){return s({type:r.Ur,siteId:e,error:t}),t}))}}},"./state/sites/media-storage/actions.js":function(e,t,s){"use strict";s.d(t,"b",(function(){return l})),s.d(t,"a",(function(){return d}));var n=s("./state/action-types.js"),a=s("../node_modules/@babel/runtime/helpers/defineProperty.js"),i=s.n(a),r=s("./state/data-layer/wpcom-http/utils.js"),o=s("./state/data-layer/wpcom-http/actions.js"),c=s("./state/data-layer/handler-registry.js");function l(e){return{type:n.jr,siteId:e}}function d(e,t){return{type:n.ir,mediaStorage:e,siteId:t}}Object(c.b)("state/data-layer/wpcom/sites/media-storage/index.js",i()({},n.jr,[Object(r.a)({fetch:function(e){return[Object(o.a)({method:"GET",path:"/sites/".concat(e.siteId,"/media-storage"),apiVersion:"1.1"},e)]},onSuccess:function(e,t){var s=e.siteId;return[d(t,s),{type:n.lr,siteId:s}]},onError:function(e,t){var s=e.siteId;return[{type:n.kr,siteId:s,error:t}]}})]))},"./state/sites/media-storage/selectors.js":function(e,t,s){"use strict";function n(e,t){return e.sites.mediaStorage.items[t]}function a(e,t){return!!e.sites.mediaStorage.fetchingItems[t]}s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return a}))},"./state/sites/plans/assembler.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var n=function(e){return e?{autoRenew:Boolean(e.auto_renew),autoRenewDate:e.auto_renew_date,canStartTrial:Boolean(e.can_start_trial),currentPlan:Boolean(e.current_plan),currencyCode:e.currency_code,discountReason:e.discount_reason,expiry:e.expiry,expiryDate:e.expiry,formattedDiscount:e.formatted_discount,formattedOriginalPrice:e.formatted_original_price,formattedPrice:e.formatted_price,freeTrial:Boolean(e.free_trial),hasDomainCredit:Boolean(e.has_domain_credit),id:Number(e.id),interval:Number(e.interval),isDomainUpgrade:Boolean(e.is_domain_upgrade),productName:e.product_name,productSlug:e.product_slug,rawDiscount:e.raw_discount,rawPrice:e.raw_price,subscribedDate:e.subscribed_date,userIsOwner:Boolean(e.user_is_owner)}:{}}},"./state/sites/plans/selectors/get-current-plan.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var n=s("../node_modules/lodash-es/find.js"),a=s("../node_modules/debug/src/browser.js"),i=s.n(a),r=s("./state/sites/selectors/get-site.js"),o=s("./state/sites/plans/assembler.js"),c=s("./state/sites/plans/selectors/get-plans-by-site.js"),l=i()("calypso:state:sites:plans:selectors");function d(e,t){var s=Object(c.b)(e,t);if(s.data){var a=Object(n.a)(s.data,"currentPlan");if(a)return l("current plan: %o",a),a;var i=Object(r.a)(e,t),d=Object(o.a)(i.plan);return l("current plan: %o",d),d}return null}},"./state/sites/plans/selectors/get-plans-by-site.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return i}));var n=s("./state/sites/plans/reducer.js");function a(e,t){return t?i(e,t.ID):n.a}function i(e,t){return t&&e.sites.plans[t]||n.a}},"./state/sites/plans/selectors/get-site-plan-slug.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("../node_modules/lodash-es/get.js"),a=s("./state/sites/plans/selectors/get-current-plan.js");function i(e,t){return Object(n.a)(Object(a.a)(e,t),"productSlug",null)}},"./state/sites/plans/selectors/has-feature.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("./lib/plans/index.js"),a=s("./state/sites/plans/selectors/get-site-plan-slug.js");function i(e,t,s){return Object(n.A)(Object(a.a)(e,t),s)}},"./state/sites/selectors/get-customizer-url.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return u}));var n=s("../node_modules/@babel/runtime/helpers/objectSpread2.js"),a=s.n(n),i=s("../node_modules/lodash-es/compact.js"),r=s("./my-sites/customize/panels.js"),o=s("./lib/url/add-query-args.ts"),c=s("./state/sites/selectors/get-site-admin-url.js"),l=s("./state/sites/selectors/get-site-slug.js"),d=s("./state/sites/selectors/is-jetpack-site.js");function u(e,t,s,n){if(!Object(d.a)(e,t)){var u=Object(l.a)(e,t),p=[""].concat(Object(i.a)(["customize",s,u])).join("/");return Object(o.a)({return:n},p)}var m=Object(c.a)(e,t,"customize.php");return m?(n||"undefined"==typeof window||(n=window.location.href),Object(o.a)(a()({return:n},Object(r.a)(s)),m)):null}},"./state/sites/selectors/get-site-plan-slug.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("../node_modules/lodash-es/get.js"),a=s("./state/sites/selectors/get-site-plan.ts");function i(e,t){return Object(n.a)(Object(a.a)(e,t),"product_slug")}},"./state/sites/selectors/get-site-url.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("./state/selectors/get-raw-site.js"),a=s("./state/sites/selectors/get-site-option.js"),i=s("./state/sites/selectors/get-site-slug.js"),r=s("./state/sites/selectors/is-site-conflicting.js");function o(e,t){if(Object(a.a)(e,t,"is_redirect")||Object(r.a)(e,t))return Object(i.a)(e,t);var s=Object(n.a)(e,t);return s?s.URL:null}},"./state/ui/action-log/selectors.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"d",(function(){return c})),s.d(t,"c",(function(){return l})),s.d(t,"b",(function(){return d}));var n=s("../node_modules/lodash-es/findLast.js"),a=s("../node_modules/lodash-es/last.js"),i=s("./lib/create-selector/index.js"),r=s("./state/action-types.js");function o(e){return e.ui.actionLog}var c=Object(i.a)((function(e){return o(e).filter((function(e){return e.type===r.kp}))}),(function(e){return[e.ui.actionLog]})),l=Object(i.a)((function(e){return Object(n.a)(o(e),(function(e){return e.type===r.kp}))}),(function(e){return[e.ui.actionLog]})),d=Object(i.a)((function(e){return Object(a.a)(e.ui.actionLog)||!1}),(function(e){return[e.ui.actionLog]}))},"./state/ui/media-modal/actions.js":function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"a",(function(){return i}));var n=s("./state/action-types.js");function a(e){return{type:n.Xj,view:e}}function i(){return a(null)}},"./state/ui/media-modal/constants.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var n={LIST:"LIST",DETAIL:"DETAIL",GALLERY:"GALLERY",IMAGE_EDITOR:"IMAGE_EDITOR",VIDEO_EDITOR:"VIDEO_EDITOR"}},"./state/ui/media-modal/selectors.js":function(e,t,s){"use strict";function n(e){return e.ui.mediaModal.view}s.d(t,"a",(function(){return n}))},"./state/utils/with-enhancers.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var n=function(e,t){return function(){for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return function(s,a){var i=e.apply(void 0,n);if(Array.isArray(t)||(t=[t]),"function"==typeof i){return i((function(e){return s(t.reduce((function(e,t){return t(e,a)}),e))}),a)}return s(t.reduce((function(e,t){return t(e,a)}),i))}}}}}]);